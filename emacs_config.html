<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-10-21 Fri 20:00 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Personal emacs configuration</title>
<meta name="author" content="Jousimies" />
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="../css/style.css"/>
</head>
<body>
<div id="preamble" class="status">
<a href="/index.html" class="button">Home</a>
<a href="/notes/index.html" class="button">Notes</a>
<a href="/engineering/index.html" class="button">Engineering</a>
<a href="/movies/index.html" class="button">Movies</a>
<a href="/about.html" class="button">About</a>
<hr>
</div>
<div id="content" class="content">
<h1 class="title">Personal emacs configuration</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orgf081ee5">1. The Early Init File</a></li>
<li><a href="#org98debc9">2. LEXICAL BINDING</a></li>
<li><a href="#org1cbec93">3. PACKAGE MANAGE, BORG</a></li>
<li><a href="#org250fcb0">4. BASIC EMACS</a></li>
<li><a href="#orgabd1e85">5. EMACS USER INTERFACE, DELICIOUS</a></li>
<li><a href="#org8b1eb0c">6. POWERFUL EMACS EQUIPPED WITH BUILTIN PACKAGES</a></li>
<li><a href="#orgd5ac883">7. AWESOME EMACS EQUIPPED WITH THIRD-PARTY PACKAGES</a></li>
<li><a href="#org83515eb">8. EMACS WORKS WITH MULTIPLE LANGUAGE, PIECE OF CAKE</a></li>
<li><a href="#org5799137">9. ORGANIZE LIFE WITH PLAIN TEXT, HIGH EFFECTIVE SYSTEM</a></li>
<li><a href="#org8f5a329">10. USEFUL EMACS EQUIPPED WITH SCRIPTS</a></li>
<li><a href="#org969bde6">11. EMACS CAN DO MORE, APPLICATIONS</a></li>
<li><a href="#org3a05a1c">12. EMACS UPDATE AND UPGRADE HISTORY</a></li>
</ul>
</div>
</div>

<div id="outline-container-orgf081ee5" class="outline-2">
<h2 id="orgf081ee5"><span class="section-number-2">1.</span> The Early Init File</h2>
<div class="outline-text-2" id="text-1">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #6f7787;">;;; </span><span style="color: #6f7787;">early-init.el --- Early Init File -*- lexical-binding: t; no-byte-compile: t -*-</span>
<span style="color: #6f7787;">;; </span><span style="color: #6f7787;">Defer garbage collection further back in the startup process</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> gc-cons-threshold most-positive-fixnum
      gc-cons-percentage 0.6<span style="color: #81A1C1;">)</span>
<span style="color: #6f7787;">;; </span><span style="color: #6f7787;">In Emacs 27+, package initialization occurs before `</span><span style="color: #81A1C1;">user-init-file</span><span style="color: #6f7787;">' is</span>
<span style="color: #6f7787;">;; </span><span style="color: #6f7787;">loaded, but after `</span><span style="color: #81A1C1;">early-init-file</span><span style="color: #6f7787;">'. Doom handles package initialization, so</span>
<span style="color: #6f7787;">;; </span><span style="color: #6f7787;">we must prevent Emacs from doing it early!</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> package-enable-at-startup nil<span style="color: #81A1C1;">)</span>
<span style="color: #6f7787;">;; </span><span style="color: #6f7787;">Do not allow loading from the package cache (same reason).</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> package-quickstart nil<span style="color: #81A1C1;">)</span>
<span style="color: #6f7787;">;; </span><span style="color: #6f7787;">Prevent the glimpse of un-styled Emacs by disabling these UI elements early.</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> inhibit-startup-message t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> inhibit-splash-screen t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">push</span> '<span style="color: #B48EAD;">(</span>menu-bar-lines . 0<span style="color: #B48EAD;">)</span> default-frame-alist<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">push</span> '<span style="color: #B48EAD;">(</span>tool-bar-lines . 0<span style="color: #B48EAD;">)</span> default-frame-alist<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">push</span> '<span style="color: #B48EAD;">(</span>vertical-scroll-bars<span style="color: #B48EAD;">)</span> default-frame-alist<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">push</span> '<span style="color: #B48EAD;">(</span>fullscreen . maximized<span style="color: #B48EAD;">)</span> default-frame-alist<span style="color: #81A1C1;">)</span>
<span style="color: #6f7787;">;; </span><span style="color: #6f7787;">Resizing the Emacs frame can be a terribly expensive part of changing the</span>
<span style="color: #6f7787;">;; </span><span style="color: #6f7787;">font. By inhibiting this, we easily halve startup times with fonts that are</span>
<span style="color: #6f7787;">;; </span><span style="color: #6f7787;">larger than the system default.</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> frame-inhibit-implied-resize t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> inhibit-compacting-font-caches t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> use-file-dialog nil<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> use-dialog-box nil<span style="color: #81A1C1;">)</span>
<span style="color: #6f7787;">;; </span><span style="color: #6f7787;">Make the initial buffer load faster by setting its mode to fundamental-mode</span>
<span style="color: #6f7787;">;; </span><span style="color: #6f7787;">(setq initial-major-mode 'fundamental-mode)</span>
<span style="color: #6f7787;">;; </span><span style="color: #6f7787;">Prevent unwanted runtime builds in gccemacs (native-comp); packages are</span>
<span style="color: #6f7787;">;; </span><span style="color: #6f7787;">compiled ahead-of-time when they are installed and site files are compiled</span>
<span style="color: #6f7787;">;; </span><span style="color: #6f7787;">when gccemacs is installed.</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> comp-deferred-compilation nil<span style="color: #81A1C1;">)</span>
<span style="color: #6f7787;">;; </span><span style="color: #6f7787;">Disable mode-line, It's uglily after theme changed</span>
<span style="color: #6f7787;">;; </span><span style="color: #6f7787;">(setq-default mode-line-format nil)</span>
<span style="color: #6f7787;">;;; </span><span style="color: #6f7787;">early-init.el ends here</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org98debc9" class="outline-2">
<h2 id="org98debc9"><span class="section-number-2">2.</span> LEXICAL BINDING</h2>
<div class="outline-text-2" id="text-2">
<p>
关于 lexical-binding 的作用见 <a href="https://nullprogram.com/blog/2016/12/22/">Make Emacs run (slightly) faster with lexical binding</a> . 或者 <a href="http://www.yinwang.org/blog-cn/2013/03/26/lisp-dead-alive">Lisp 已死，Lisp 万岁！</a>
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #6f7787;">;; </span><span style="color: #6f7787;">init.el --- Personal Emacs Configuration -*- lexical-binding: t; -*-</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org1cbec93" class="outline-2">
<h2 id="org1cbec93"><span class="section-number-2">3.</span> PACKAGE MANAGE, BORG</h2>
<div class="outline-text-2" id="text-3">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">eval-and-compile</span>
  <span style="color: #B48EAD;">(</span>add-to-list 'load-path <span style="color: #A3BE8C;">(</span>expand-file-name <span style="color: #A3BE8C;">"packages/borg"</span> user-emacs-directory<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">require</span> '<span style="color: #81A1C1;">borg</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>borg-initialize<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">when</span> <span style="color: #B48EAD;">(</span>memq window-system '<span style="color: #A3BE8C;">(</span>mac ns x<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>exec-path-from-shell-initialize<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org250fcb0" class="outline-2">
<h2 id="org250fcb0"><span class="section-number-2">4.</span> BASIC EMACS</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-org1f02ea6" class="outline-3">
<h3 id="org1f02ea6"><span class="section-number-3">4.1.</span> Startup</h3>
<div class="outline-text-3" id="text-4-1">
</div>
<div id="outline-container-orgde74dee" class="outline-4">
<h4 id="orgde74dee"><span class="section-number-4">4.1.1.</span> speedup</h4>
<div class="outline-text-4" id="text-4-1-1">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #6f7787;">;; </span><span style="color: #6f7787;">https://github.com/seagle0128/.emacs.d/blob/master/init.el</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> auto-mode-case-fold nil<span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">unless</span> <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">or</span> <span style="color: #A3BE8C;">(</span>daemonp<span style="color: #A3BE8C;">)</span> noninteractive init-file-debug<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">let</span> <span style="color: #A3BE8C;">(</span><span style="color: #5D80AE;">(</span>old-file-name-handler-alist file-name-handler-alist<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">setq</span> file-name-handler-alist nil<span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span>add-hook 'emacs-startup-hook
              <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">lambda</span> <span style="color: #8FBCBB;">()</span>
                <span style="color: #78808f;">"Recover file name handlers."</span>
                <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">setq</span> file-name-handler-alist
                      <span style="color: #81A1C1;">(</span>delete-dups <span style="color: #B48EAD;">(</span>append file-name-handler-alist
                                           old-file-name-handler-alist<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #6f7787;">;; </span><span style="color: #6f7787;">Defer garbage collection further back in the startup process</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> gc-cons-threshold most-positive-fixnum<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'emacs-startup-hook
          <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">lambda</span> <span style="color: #A3BE8C;">()</span>
            <span style="color: #78808f;">"Recover GC values after startup."</span>
            <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">setq</span> gc-cons-threshold 800000<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #6f7787;">;; </span><span style="color: #6f7787;">Suppress flashing at startup</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq-default</span> inhibit-redisplay t
              inhibit-message t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'window-setup-hook
          <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">lambda</span> <span style="color: #A3BE8C;">()</span>
            <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">setq-default</span> inhibit-redisplay nil
                          inhibit-message nil<span style="color: #A3BE8C;">)</span>
            <span style="color: #A3BE8C;">(</span>redisplay<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb17c564" class="outline-4">
<h4 id="orgb17c564"><span class="section-number-4">4.1.2.</span> utility hooks and functions</h4>
<div class="outline-text-4" id="text-4-1-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">require</span> '<span style="color: #81A1C1;">on</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgb155c68" class="outline-3">
<h3 id="orgb155c68"><span class="section-number-3">4.2.</span> Variables</h3>
<div class="outline-text-3" id="text-4-2">
<p>
自定义一些变量，方便配置文件位置或针对特定系统进行相关设定。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defvar</span> <span style="color: #D8DEE9;">my-cloud</span> <span style="color: #A3BE8C;">"~/Nextcloud"</span>
  <span style="color: #78808f;">"This folder is My cloud."</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defvar</span> <span style="color: #D8DEE9;">my-galaxy</span> <span style="color: #B48EAD;">(</span>expand-file-name <span style="color: #A3BE8C;">"L.Personal.Galaxy"</span> my-cloud<span style="color: #B48EAD;">)</span>
  <span style="color: #78808f;">"This folder stores all the plain text files of my life."</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org25de044" class="outline-3">
<h3 id="org25de044"><span class="section-number-3">4.3.</span> Keep emacs directory clean</h3>
<div class="outline-text-3" id="text-4-3">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">require</span> '<span style="color: #81A1C1;">no-littering</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org53b0703" class="outline-3">
<h3 id="org53b0703"><span class="section-number-3">4.4.</span> GIT</h3>
<div class="outline-text-3" id="text-4-4">
<p>
Use magit as version control.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'magit
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">setq</span> magit-display-buffer-function 'magit-display-buffer-fullframe-status-topleft-v1<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>magit-add-section-hook 'magit-status-sections-hook
              'magit-insert-modules
              'magit-insert-unpulled-from-upstream<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> <span style="color: #A3BE8C;">"magit-submodule"</span>
  <span style="color: #B48EAD;">(</span>remove-hook 'magit-module-sections-hook 'magit-insert-modules-overview<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>remove-hook 'magit-module-sections-hook 'magit-insert-modules-unpulled-from-pushremote<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>remove-hook 'magit-module-sections-hook 'magit-insert-modules-unpushed-to-upstream<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>remove-hook 'magit-module-sections-hook 'magit-insert-modules-unpushed-to-pushremote<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org7ad8f97" class="outline-3">
<h3 id="org7ad8f97"><span class="section-number-3">4.5.</span> Auto tangle</h3>
<div class="outline-text-3" id="text-4-5">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'org-mode-hook 'org-auto-tangle-mode<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf1a7514" class="outline-3">
<h3 id="orgf1a7514"><span class="section-number-3">4.6.</span> Evil</h3>
<div class="outline-text-3" id="text-4-6">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'after-init-hook 'evil-mode<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> evil-want-keybinding nil<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> evil-want-C-u-scroll t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> evil-undo-system 'undo-fu<span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"&lt;escape&gt;"</span><span style="color: #B48EAD;">)</span> 'keyboard-escape-quit<span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'evil
  <span style="color: #B48EAD;">(</span>evil-global-set-key 'motion <span style="color: #A3BE8C;">"j"</span> 'evil-next-visual-line<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>evil-global-set-key 'motion <span style="color: #A3BE8C;">"k"</span> 'evil-previous-visual-line<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>define-key evil-insert-state-map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"C-e"</span><span style="color: #A3BE8C;">)</span> 'move-end-of-line<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<p>
Disable arrow keys in normal and visual modes.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #6f7787;">;; </span><span style="color: #6f7787;">https://github.com/daviwil/dotfiles/blob/0e034ebb688633082a3b0c201b0bc834a9821091/Emacs.org#lets-be-evil</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">dw/dont-arrow-me-bro</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>message <span style="color: #A3BE8C;">"Arrow keys are bad, you know?"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'evil
  <span style="color: #B48EAD;">(</span>define-key evil-normal-state-map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"&lt;left&gt;"</span><span style="color: #A3BE8C;">)</span> 'dw/dont-arrow-me-bro<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>define-key evil-normal-state-map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"&lt;right&gt;"</span><span style="color: #A3BE8C;">)</span> 'dw/dont-arrow-me-bro<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>define-key evil-normal-state-map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"&lt;down&gt;"</span><span style="color: #A3BE8C;">)</span> 'dw/dont-arrow-me-bro<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>define-key evil-normal-state-map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"&lt;up&gt;"</span><span style="color: #A3BE8C;">)</span> 'dw/dont-arrow-me-bro<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>evil-global-set-key 'motion <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"&lt;left&gt;"</span><span style="color: #A3BE8C;">)</span> 'dw/dont-arrow-me-bro<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>evil-global-set-key 'motion <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"&lt;right&gt;"</span><span style="color: #A3BE8C;">)</span> 'dw/dont-arrow-me-bro<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>evil-global-set-key 'motion <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"&lt;down&gt;"</span><span style="color: #A3BE8C;">)</span> 'dw/dont-arrow-me-bro<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>evil-global-set-key 'motion <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"&lt;up&gt;"</span><span style="color: #A3BE8C;">)</span> 'dw/dont-arrow-me-bro<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
<div id="outline-container-org60362ae" class="outline-4">
<h4 id="org60362ae"><span class="section-number-4">4.6.1.</span> Evil collection</h4>
<div class="outline-text-4" id="text-4-6-1">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">when</span> <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">require</span> '<span style="color: #81A1C1;">evil-collection</span> nil t<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>evil-collection-init<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org7b939b8" class="outline-4">
<h4 id="org7b939b8"><span class="section-number-4">4.6.2.</span> Which key</h4>
<div class="outline-text-4" id="text-4-6-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> which-key-idle-delay 0.3<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'on-first-input-hook 'which-key-mode<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org9f7753e" class="outline-4">
<h4 id="org9f7753e"><span class="section-number-4">4.6.3.</span> General</h4>
<div class="outline-text-4" id="text-4-6-3">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>general-evil-setup t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">general-create-definer</span> my/space-leader-keys
            <span style="color: #81A1C1;">:keymaps</span> '<span style="color: #B48EAD;">(</span>normal insert visual emacs<span style="color: #B48EAD;">)</span>
            <span style="color: #81A1C1;">:prefix</span> <span style="color: #A3BE8C;">"SPC"</span>
            <span style="color: #81A1C1;">:global-prefix</span> <span style="color: #A3BE8C;">"C-SPC"</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">general-create-definer</span> my/local-leader-def
            <span style="color: #81A1C1;">:prefix</span> <span style="color: #A3BE8C;">"SPC m"</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
  <span style="color: #A3BE8C;">"SPC"</span> '<span style="color: #B48EAD;">(</span>execute-extended-command <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"M-x"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org4605000" class="outline-3">
<h3 id="org4605000"><span class="section-number-3">4.7.</span> Keys</h3>
<div class="outline-text-3" id="text-4-7">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">my/emacs-config</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #78808f;">"My literate emacs configuration."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>find-file <span style="color: #A3BE8C;">(</span>expand-file-name <span style="color: #A3BE8C;">"config/emacs_config.org"</span> my-galaxy<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">my/emacs-directory</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #78808f;">"My emacs directory."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>dired user-emacs-directory<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
  <span style="color: #A3BE8C;">"fi"</span> '<span style="color: #B48EAD;">(</span>my/emacs-config <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Emacs configuration"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"fI"</span> '<span style="color: #B48EAD;">(</span>my/emacs-directory <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Emacs directory"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c f i"</span><span style="color: #B48EAD;">)</span> #'my/emacs-config<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c f I"</span><span style="color: #B48EAD;">)</span> #'my/emacs-directory<span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
    <span style="color: #6f7787;">;; </span><span style="color: #6f7787;">File</span>
    <span style="color: #A3BE8C;">"f"</span> '<span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">:ignore</span> t <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"File"</span><span style="color: #B48EAD;">)</span>
    <span style="color: #A3BE8C;">"ff"</span> '<span style="color: #B48EAD;">(</span>find-file <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Find file"</span><span style="color: #B48EAD;">)</span>

    <span style="color: #6f7787;">;; </span><span style="color: #6f7787;">Buffer</span>
    <span style="color: #A3BE8C;">"b"</span> '<span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">:ignore</span> t <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Buffer"</span><span style="color: #B48EAD;">)</span>
    <span style="color: #A3BE8C;">"bb"</span> '<span style="color: #B48EAD;">(</span>switch-to-buffer <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Switch buffer"</span><span style="color: #B48EAD;">)</span>
    <span style="color: #A3BE8C;">";"</span> '<span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">:ignore</span> t <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Code"</span><span style="color: #B48EAD;">)</span>
    <span style="color: #A3BE8C;">";a"</span> '<span style="color: #B48EAD;">(</span>borg-assimilate <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Borg assimilate"</span><span style="color: #B48EAD;">)</span>
    <span style="color: #A3BE8C;">";b"</span> '<span style="color: #B48EAD;">(</span>borg-build <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Borg build"</span><span style="color: #B48EAD;">)</span>
    <span style="color: #A3BE8C;">";r"</span> '<span style="color: #B48EAD;">(</span>borg-remove <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Borg remove"</span><span style="color: #B48EAD;">)</span>
    <span style="color: #A3BE8C;">";e"</span> '<span style="color: #B48EAD;">(</span>epkg-describe-package <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Epkg describe package"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org7823515" class="outline-3">
<h3 id="org7823515"><span class="section-number-3">4.8.</span> Auto save</h3>
<div class="outline-text-3" id="text-4-8">
<p>
在 Emacs 中永远不需要手动保存文档，使用这个包会自动保存。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">require</span> '<span style="color: #81A1C1;">auto-save</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> auto-save-silent t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> auto-save-delete-trailing-whitespace t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'on-first-input-hook 'auto-save-enable<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org7c0d89c" class="outline-3">
<h3 id="org7c0d89c"><span class="section-number-3">4.9.</span> server</h3>
<div class="outline-text-3" id="text-4-9">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'after-init-hook 'server-mode<span style="color: #81A1C1;">)</span>
<span style="color: #6f7787;">;;;</span><span style="color: #6f7787;">###</span><span style="color: #EBCB8B;">autoload</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">restart-server</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #78808f;">"Restart the Emacs server."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>server-force-delete<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">while</span> <span style="color: #A3BE8C;">(</span>server-running-p<span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span>sleep-for 1<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>server-start<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">my/restart-emacs</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>toggle-frame-fullscreen<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>restart-emacs<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
  <span style="color: #A3BE8C;">"q"</span> '<span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">:ignore</span> t <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Quit/Restart"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"qf"</span> '<span style="color: #B48EAD;">(</span>delete-frame <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Delete frame"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"qr"</span> '<span style="color: #B48EAD;">(</span>restart-server <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Restart server"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"qR"</span> '<span style="color: #B48EAD;">(</span>restart-emacs <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Restart Emacs"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"qq"</span> '<span style="color: #B48EAD;">(</span>kill-emacs <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Quit emacs"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"qK"</span> '<span style="color: #B48EAD;">(</span>save-buffers-kill-emacs <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Kill emacs (and Daemon)"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org8310280" class="outline-3">
<h3 id="org8310280"><span class="section-number-3">4.10.</span> Window and workspace</h3>
<div class="outline-text-3" id="text-4-10">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>winner-mode 1<span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
  <span style="color: #A3BE8C;">"w"</span> '<span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">:ignore</span> t <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"workspaces/windows"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"wu"</span> '<span style="color: #B48EAD;">(</span>winner-undo <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Winner undo"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"wU"</span> '<span style="color: #B48EAD;">(</span>winner-redo <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Winner redo"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgabd1e85" class="outline-2">
<h2 id="orgabd1e85"><span class="section-number-2">5.</span> EMACS USER INTERFACE, DELICIOUS</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-org3724457" class="outline-3">
<h3 id="org3724457"><span class="section-number-3">5.1.</span> Fonts</h3>
<div class="outline-text-3" id="text-5-1">
<p>
设置 frame 字体，然后争对中文字体设置即可。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>set-frame-font <span style="color: #A3BE8C;">"Iosevka Fixed 16"</span> nil t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">if</span> <span style="color: #B48EAD;">(</span>display-graphic-p<span style="color: #B48EAD;">)</span>
    <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">dolist</span> <span style="color: #A3BE8C;">(</span>charset '<span style="color: #5D80AE;">(</span>kana han cjk-misc bopomofo<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
      <span style="color: #A3BE8C;">(</span>set-fontset-font <span style="color: #5D80AE;">(</span>frame-parameter nil 'font<span style="color: #5D80AE;">)</span>
                        charset <span style="color: #5D80AE;">(</span>font-spec <span style="color: #81A1C1;">:family</span> <span style="color: #A3BE8C;">"Source Han Serif SC"</span> <span style="color: #81A1C1;">:height</span> 160<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf12e621" class="outline-3">
<h3 id="orgf12e621"><span class="section-number-3">5.2.</span> Icons</h3>
<div class="outline-text-3" id="text-5-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">when</span> <span style="color: #B48EAD;">(</span>display-graphic-p<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">require</span> '<span style="color: #81A1C1;">all-the-icons</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>set-fontset-font <span style="color: #A3BE8C;">"fontset-default"</span> 'unicode <span style="color: #B48EAD;">(</span>font-spec <span style="color: #81A1C1;">:family</span> <span style="color: #A3BE8C;">"all-the-icons"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>  <span style="color: #6f7787;">;;</span><span style="color: #6f7787;">&#36825;&#37324;&#19981;&#33021;&#29992; append&#65292;&#21542;&#21017;&#19981;&#24037;&#20316;&#12290;</span>
<span style="color: #81A1C1;">(</span>set-fontset-font <span style="color: #A3BE8C;">"fontset-default"</span> 'unicode <span style="color: #B48EAD;">(</span>font-spec <span style="color: #81A1C1;">:family</span> <span style="color: #A3BE8C;">"file-icons"</span><span style="color: #B48EAD;">)</span> nil 'append<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>set-fontset-font <span style="color: #A3BE8C;">"fontset-default"</span> 'unicode <span style="color: #B48EAD;">(</span>font-spec <span style="color: #81A1C1;">:family</span> <span style="color: #A3BE8C;">"Material Icons"</span><span style="color: #B48EAD;">)</span> nil 'append<span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'all-the-icons
  <span style="color: #B48EAD;">(</span>all-the-icons-completion-mode 1<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>add-hook 'marginalia-mode-hook #'all-the-icons-completion-marginalia-setup<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>add-hook 'dired-mode-hook 'all-the-icons-dired-mode<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org4eb2864" class="outline-3">
<h3 id="org4eb2864"><span class="section-number-3">5.3.</span> Fringe bitmap</h3>
<div class="outline-text-3" id="text-5-3">
<p>
Word wrap at window edge, hide the right and left curly arrow. So ugly.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>define-fringe-bitmap 'right-curly-arrow  <span style="color: #B48EAD;">[]</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>define-fringe-bitmap 'left-curly-arrow  <span style="color: #B48EAD;">[]</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org97c423e" class="outline-3">
<h3 id="org97c423e"><span class="section-number-3">5.4.</span> Screen size</h3>
<div class="outline-text-3" id="text-5-4">
<pre class="example" id="orgb36a561">
(add-to-list 'default-frame-alist '(fullscreen . maximized))
</pre>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>toggle-frame-fullscreen<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org1d245dd" class="outline-3">
<h3 id="org1d245dd"><span class="section-number-3">5.5.</span> Themes</h3>
<div class="outline-text-3" id="text-5-5">
<p>
切换到 MacOS 上使用 Emacs ，<a href="https://github.com/d12frosted/homebrew-emacs-plus">Emacs-plus</a> 可根据系统主题自动切换 Emacs 主题，比使用 <code>circadian</code> 进行主题的切换要好，系统上更统一。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> calendar-latitude 32.05
  calendar-longitude 118.77<span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">if</span> <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">or</span> sys-winp sys-linux<span style="color: #B48EAD;">)</span>
    <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">setq</span> circadian-themes '<span style="color: #A3BE8C;">(</span><span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">:sunrise</span> . modus-operandi<span style="color: #5D80AE;">)</span>
                 <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">:sunset</span>  . modus-vivendi<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>circadian-setup<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">my/apply-theme</span> <span style="color: #B48EAD;">(</span>appearance<span style="color: #B48EAD;">)</span>
  <span style="color: #78808f;">"Load theme, taking current system APPEARANCE into consideration."</span>
  <span style="color: #B48EAD;">(</span>mapc #'disable-theme custom-enabled-themes<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">pcase</span> appearance
    <span style="color: #A3BE8C;">(</span>'light <span style="color: #5D80AE;">(</span>load-theme 'doom-nord-light t<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span>'dark <span style="color: #5D80AE;">(</span>load-theme 'doom-nord t<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'ns-system-appearance-change-functions #'my/apply-theme<span style="color: #81A1C1;">)</span>
</pre>
</div>

<p>
Modus theme 主题原来使用 M-x 时候选项下有一个下划线，可以很清楚的看见当前项，现在不知道为什么设置 <code>modus-theme-completions</code> 不起作用了。
把主题切换到 <code>nano-light</code> 和 <code>doom-nord</code> 下使用，看起来也可以。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> modus-themes-italic-constructs t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> modus-themes-bold-constructs nil<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> modus-themes-region '<span style="color: #B48EAD;">(</span>bg-only no-extend<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> modus-themes-lang-checkers '<span style="color: #B48EAD;">(</span>background text-also straight-underline<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> modus-themes-links '<span style="color: #B48EAD;">(</span>italic background faint neutral-underline<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> modus-themes-hl-line '<span style="color: #B48EAD;">(</span>intense<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> modus-themes-paren-match '<span style="color: #B48EAD;">(</span>accented intense<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> modus-themes-prompts '<span style="color: #B48EAD;">(</span>intense background <span style="color: #000000; background-color: #bebebe;">gray</span> bold<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> modus-themes-completions '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">(</span>matches . <span style="color: #5D80AE;">(</span>extrabold intense<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
                                 <span style="color: #A3BE8C;">(</span>selection . <span style="color: #5D80AE;">(</span>underline<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
                                 <span style="color: #A3BE8C;">(</span>popup . <span style="color: #5D80AE;">(</span>intense<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #6f7787;">;;</span><span style="color: #6f7787;">(setq modus-themes-org-blocks '</span><span style="color: #000000; background-color: #bebebe;">gray</span><span style="color: #6f7787;">-background)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> modus-themes-org-agenda '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">(</span>header-block . <span style="color: #5D80AE;">(</span>variable-pitch 1.2<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
                                <span style="color: #A3BE8C;">(</span>habit . traffic-light<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> modus-themes-operandi-color-overrides '<span style="color: #B48EAD;">(</span>
                                              <span style="color: #6f7787;">;;</span><span style="color: #6f7787;">(bg-main . "</span><span style="color: #000000; background-color: #FFFFFF;">#FFFFFF</span><span style="color: #6f7787;">")</span>
                                              <span style="color: #6f7787;">;;</span><span style="color: #6f7787;">(bg-dim . "</span><span style="color: #000000; background-color: #FFFFFF;">#FFFFFF</span><span style="color: #6f7787;">")</span>
                                              <span style="color: #A3BE8C;">(</span>bg-active . <span style="color: #A3BE8C;">"</span><span style="color: #000000; background-color: #FFFFFF;">#FFFFFF</span><span style="color: #A3BE8C;">"</span><span style="color: #A3BE8C;">)</span>
                                              <span style="color: #A3BE8C;">(</span>bg-inactive . <span style="color: #A3BE8C;">"</span><span style="color: #000000; background-color: #FFFFFF;">#FFFFFF</span><span style="color: #A3BE8C;">"</span><span style="color: #A3BE8C;">)</span>
                                              <span style="color: #6f7787;">;;</span><span style="color: #6f7787;">(bg-tab-bar . "</span><span style="color: #000000; background-color: #FFFFFF;">#FFFFFF</span><span style="color: #6f7787;">")</span>
                                              <span style="color: #6f7787;">;;</span><span style="color: #6f7787;">(bg-tab-active . "</span><span style="color: #000000; background-color: #FFFFFF;">#FFFFFF</span><span style="color: #6f7787;">")</span>
                                              <span style="color: #6f7787;">;;</span><span style="color: #6f7787;">(bg-tab-inactive . "</span><span style="color: #000000; background-color: #FFFFFF;">#FFFFFF</span><span style="color: #6f7787;">")</span>
                                              <span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> modus-themes-vivendi-color-overrides '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">(</span>bg-main . <span style="color: #A3BE8C;">"</span><span style="color: #ffffff; background-color: #1F1F1E;">#1F1F1E</span><span style="color: #A3BE8C;">"</span><span style="color: #A3BE8C;">)</span>
                                             <span style="color: #A3BE8C;">(</span>bg-dim . <span style="color: #A3BE8C;">"</span><span style="color: #ffffff; background-color: #1F1F1E;">#1F1F1E</span><span style="color: #A3BE8C;">"</span><span style="color: #A3BE8C;">)</span>
                                             <span style="color: #A3BE8C;">(</span>bg-hl-line . <span style="color: #A3BE8C;">"</span><span style="color: #ffffff; background-color: #4d4d4d;">gray30</span><span style="color: #A3BE8C;">"</span><span style="color: #A3BE8C;">)</span>
                                             <span style="color: #A3BE8C;">(</span>bg-active . <span style="color: #A3BE8C;">"</span><span style="color: #ffffff; background-color: #1F1F1E;">#1F1F1E</span><span style="color: #A3BE8C;">"</span><span style="color: #A3BE8C;">)</span>
                                             <span style="color: #A3BE8C;">(</span>bg-inactive . <span style="color: #A3BE8C;">"</span><span style="color: #ffffff; background-color: #1F1F1E;">#1F1F1E</span><span style="color: #A3BE8C;">"</span><span style="color: #A3BE8C;">)</span>
                                             <span style="color: #A3BE8C;">(</span>bg-tab-bar . <span style="color: #A3BE8C;">"</span><span style="color: #ffffff; background-color: #1F1F1E;">#1F1F1E</span><span style="color: #A3BE8C;">"</span><span style="color: #A3BE8C;">)</span>
                                             <span style="color: #A3BE8C;">(</span>bg-tab-active . <span style="color: #A3BE8C;">"</span><span style="color: #ffffff; background-color: #1F1F1E;">#1F1F1E</span><span style="color: #A3BE8C;">"</span><span style="color: #A3BE8C;">)</span>
                                             <span style="color: #A3BE8C;">(</span>bg-tab-inactive . <span style="color: #A3BE8C;">"</span><span style="color: #ffffff; background-color: #1F1F1E;">#1F1F1E</span><span style="color: #A3BE8C;">"</span><span style="color: #A3BE8C;">)</span>
                                             <span style="color: #A3BE8C;">(</span><span style="color: #ffffff; background-color: #0000ff;">blue</span> . <span style="color: #A3BE8C;">"</span><span style="color: #000000; background-color: #FFFFFF;">#FFFFFF</span><span style="color: #A3BE8C;">"</span><span style="color: #A3BE8C;">)</span>
                                             <span style="color: #A3BE8C;">(</span><span style="color: #ffffff; background-color: #ff00ff;">magenta</span>-nuanced-bg . <span style="color: #A3BE8C;">"</span><span style="color: #ffffff; background-color: #343435;">#343435</span><span style="color: #A3BE8C;">"</span><span style="color: #A3BE8C;">)</span>
                                             <span style="color: #A3BE8C;">(</span>bg-region-accent-subtle . <span style="color: #A3BE8C;">"</span><span style="color: #ffffff; background-color: #304466;">#304466</span><span style="color: #A3BE8C;">"</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> modus-themes-headings
      '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">(</span>1 . <span style="color: #5D80AE;">(</span>variable-pitch light 1.6<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
        <span style="color: #A3BE8C;">(</span>2 . <span style="color: #5D80AE;">(</span>overline semibold 1.4<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
        <span style="color: #A3BE8C;">(</span>3 . <span style="color: #5D80AE;">(</span>monochrome overline 1.2 background<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
        <span style="color: #A3BE8C;">(</span>4 . <span style="color: #5D80AE;">(</span>overline 1.1<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
        <span style="color: #A3BE8C;">(</span>t . <span style="color: #5D80AE;">(</span>rainbow 1.05<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org4705713" class="outline-3">
<h3 id="org4705713"><span class="section-number-3">5.6.</span> Highlight line</h3>
<div class="outline-text-3" id="text-5-6">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'on-first-buffer-hook 'global-hl-line-mode<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org8f43363" class="outline-3">
<h3 id="org8f43363"><span class="section-number-3">5.7.</span> Word wrap</h3>
<div class="outline-text-3" id="text-5-7">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'org-mode-hook 'menu-bar--wrap-long-lines-window-edge<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org2767a3a" class="outline-3">
<h3 id="org2767a3a"><span class="section-number-3">5.8.</span> Line number</h3>
<div class="outline-text-3" id="text-5-8">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'text-mode-hook 'menu-bar--display-line-numbers-mode-absolute<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'prog-mode-hook 'menu-bar--display-line-numbers-mode-absolute<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org18b0b69" class="outline-3">
<h3 id="org18b0b69"><span class="section-number-3">5.9.</span> Cursor color</h3>
<div class="outline-text-3" id="text-5-9">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> im-cursor-color <span style="color: #A3BE8C;">"</span><span style="color: #ffffff; background-color: #ff0000;">red</span><span style="color: #A3BE8C;">"</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'text-mode-hook 'cursor-chg-mode<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org7ff57dd" class="outline-3">
<h3 id="org7ff57dd"><span class="section-number-3">5.10.</span> Time</h3>
<div class="outline-text-3" id="text-5-10">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> display-time-24hr-format t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> display-time-format <span style="color: #A3BE8C;">"%m/%d %H:%M %a"</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> display-time-load-average-threshold nil<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'after-init-hook 'display-time-mode 20<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org2e29005" class="outline-3">
<h3 id="org2e29005"><span class="section-number-3">5.11.</span> Modeline</h3>
<div class="outline-text-3" id="text-5-11">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'after-init-hook 'doom-modeline-mode<span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> doom-modeline-icon t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> doom-modeline-height 20<span style="color: #81A1C1;">)</span>
</pre>
</div>
<p>
Need install <a href="https://github.com/hlissner/emacs-hide-mode-line">Hide mode line package</a>.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'org-roam-mode-hook #'hide-mode-line-mode<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org215f114" class="outline-3">
<h3 id="org215f114"><span class="section-number-3">5.12.</span> Battery</h3>
<div class="outline-text-3" id="text-5-12">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> battery-load-critical 15<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> battery-mode-line-format <span style="color: #A3BE8C;">" %b%p% "</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'after-init-hook 'display-battery-mode 10<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgfc90a99" class="outline-3">
<h3 id="orgfc90a99"><span class="section-number-3">5.13.</span> Beacon</h3>
<div class="outline-text-3" id="text-5-13">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'after-init-hook 'beacon-mode<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'beacon
  <span style="color: #B48EAD;">(</span>diminish 'beacon-mode<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org63ae68c" class="outline-3">
<h3 id="org63ae68c"><span class="section-number-3">5.14.</span> Parent</h3>
<div class="outline-text-3" id="text-5-14">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> show-paren-style 'mixed<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> show-paren-context-when-offscreen 'overlay<span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span>add-hook 'text-mode-hook 'show-paren-mode<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb68b7af" class="outline-3">
<h3 id="orgb68b7af"><span class="section-number-3">5.15.</span> Rainbow</h3>
<div class="outline-text-3" id="text-5-15">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'prog-mode-hook 'rainbow-mode<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'rainbow-mode
  <span style="color: #B48EAD;">(</span>diminish 'rainbow-mode<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'prog-mode-hook 'rainbow-delimiters-mode<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgcf62f13" class="outline-3">
<h3 id="orgcf62f13"><span class="section-number-3">5.16.</span> Electric</h3>
<div class="outline-text-3" id="text-5-16">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'text-mode-hook 'electric-pair-mode<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orga1d61b4" class="outline-3">
<h3 id="orga1d61b4"><span class="section-number-3">5.17.</span> Prettify symbols</h3>
<div class="outline-text-3" id="text-5-17">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> prettify-symbols-alist '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"lambda"</span> . ?&#955;<span style="color: #A3BE8C;">)</span>
                               <span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"function"</span> . ?&#119891;<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'prog-mode-hook 'prettify-symbols-mode<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orge7200a5" class="outline-3">
<h3 id="orge7200a5"><span class="section-number-3">5.18.</span> Emoji</h3>
<div class="outline-text-3" id="text-5-18">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
  <span style="color: #A3BE8C;">"8ei"</span> '<span style="color: #B48EAD;">(</span>emoji-insert <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Emoji insert"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"8es"</span> '<span style="color: #B48EAD;">(</span>emoji-search <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Emoji search"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"8el"</span> '<span style="color: #B48EAD;">(</span>emoji-list <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Emoji list"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"8er"</span> '<span style="color: #B48EAD;">(</span>emoji-recent <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Emoji recent"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd9657d4" class="outline-3">
<h3 id="orgd9657d4"><span class="section-number-3">5.19.</span> Dashboard</h3>
<div class="outline-text-3" id="text-5-19">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">require</span> '<span style="color: #81A1C1;">dashboard</span> nil t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> dashboard-startup-banner <span style="color: #B48EAD;">(</span>expand-file-name <span style="color: #A3BE8C;">"banner.txt"</span> user-emacs-directory<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> dashboard-center-content t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> dashboard-set-init-info t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> dashboard-set-file-icons t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> dashboard-items '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">(</span>recents  . 5<span style="color: #A3BE8C;">)</span>
                        <span style="color: #A3BE8C;">(</span>bookmarks . 5<span style="color: #A3BE8C;">)</span>
                        <span style="color: #A3BE8C;">(</span>agenda . 5<span style="color: #A3BE8C;">)</span>
                        <span style="color: #A3BE8C;">(</span>registers . 5<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> dashboard-set-navigator t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'after-init-hook 'dashboard-setup-startup-hook<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org8b1eb0c" class="outline-2">
<h2 id="org8b1eb0c"><span class="section-number-2">6.</span> POWERFUL EMACS EQUIPPED WITH BUILTIN PACKAGES</h2>
<div class="outline-text-2" id="text-6">
</div>
<div id="outline-container-org1732ee1" class="outline-3">
<h3 id="org1732ee1"><span class="section-number-3">6.1.</span> Better default</h3>
<div class="outline-text-3" id="text-6-1">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> ring-bell-function 'ignore<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> use-short-answers t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> read-process-output-max #x10000<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> message-kill-buffer-on-exit t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> message-kill-buffer-query nil<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq-default</span> indent-tabs-mode nil<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq-default</span> tab-width 4<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org92b2e39" class="outline-3">
<h3 id="org92b2e39"><span class="section-number-3">6.2.</span> system coding</h3>
<div class="outline-text-3" id="text-6-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">when</span> <span style="color: #B48EAD;">(</span>fboundp 'set-charset-priority<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>set-charset-priority 'unicode<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span>prefer-coding-system 'utf-8<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>set-default-coding-systems 'utf-8<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>set-terminal-coding-system 'utf-8<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>set-keyboard-coding-system 'utf-8<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgdc908b1" class="outline-3">
<h3 id="orgdc908b1"><span class="section-number-3">6.3.</span> delete selection</h3>
<div class="outline-text-3" id="text-6-3">
<p>
插入文本会将所选文本删除，这在其他的很多软件中都有，Emacs 中默认没有，需要手动开启。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'on-first-input-hook 'delete-selection-mode<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org402aa50" class="outline-3">
<h3 id="org402aa50"><span class="section-number-3">6.4.</span> recentf</h3>
<div class="outline-text-3" id="text-6-4">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'after-init-hook 'recentf-mode<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'kill-emacs-hook #'recentf-cleanup<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> recentf-max-saved-items 1000<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> recentf-exclude nil<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-to-list 'recentf-exclude no-littering-var-directory<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-to-list 'recentf-exclude no-littering-etc-directory<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org6cf07ac" class="outline-3">
<h3 id="org6cf07ac"><span class="section-number-3">6.5.</span> autorevert</h3>
<div class="outline-text-3" id="text-6-5">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> auto-revert-verbose t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'on-first-file-hook 'global-auto-revert-mode<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orga75c640" class="outline-3">
<h3 id="orga75c640"><span class="section-number-3">6.6.</span> save hist</h3>
<div class="outline-text-3" id="text-6-6">
<p>
Toggle saving of minibuffer history.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> history-length 1000<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> savehist-save-minibuffer-history 1<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> savehist-additional-variables '<span style="color: #B48EAD;">(</span>kill-ring
                search-ring
                regexp-search-ring<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> history-delete-duplicates t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'on-first-input-hook 'savehist-mode<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd7904e5" class="outline-3">
<h3 id="orgd7904e5"><span class="section-number-3">6.7.</span> save place</h3>
<div class="outline-text-3" id="text-6-7">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'on-first-buffer-hook 'save-place-mode<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orge303564" class="outline-3">
<h3 id="orge303564"><span class="section-number-3">6.8.</span> midnight</h3>
<div class="outline-text-3" id="text-6-8">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'on-first-buffer-hook 'midnight-mode<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org01c2101" class="outline-3">
<h3 id="org01c2101"><span class="section-number-3">6.9.</span> minibuffer</h3>
<div class="outline-text-3" id="text-6-9">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> minibuffer-prompt-properties
      '<span style="color: #B48EAD;">(</span>read-only t cursor-intangible t face minibuffer-prompt<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org6495e8b" class="outline-3">
<h3 id="org6495e8b"><span class="section-number-3">6.10.</span> cursor</h3>
<div class="outline-text-3" id="text-6-10">
<p>
因为我不使用 modeline 当有多个 buffer 的时候会不知道当前处于哪个 buffer 中，所以关闭其他窗口中的光标，这样哪个 buffer 中有光标，哪个 buffer 就处于活动状态。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>blink-cursor-mode -1<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq-default</span> cursor-type 'bar<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq-default</span> cursor-in-non-selected-windows nil<span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'minibuffer-setup-hook #'cursor-intangible-mode<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgea9efe5" class="outline-3">
<h3 id="orgea9efe5"><span class="section-number-3">6.11.</span> mouse-avoidance</h3>
<div class="outline-text-3" id="text-6-11">
<p>
Builtin function. Hide mouse when type.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>mouse-avoidance-mode 'banish<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org38f6f95" class="outline-3">
<h3 id="org38f6f95"><span class="section-number-3">6.12.</span> so-long</h3>
<div class="outline-text-3" id="text-6-12">
<p>
Emacs 的长行检测。在 Emacs 中当编辑长行时，会很卡，开启此模式可以提高性能。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'text-mode-hook 'global-so-long-mode<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org8f5743b" class="outline-3">
<h3 id="org8f5743b"><span class="section-number-3">6.13.</span> large file</h3>
<div class="outline-text-3" id="text-6-13">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> large-file-warning-threshold nil<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org6551079" class="outline-3">
<h3 id="org6551079"><span class="section-number-3">6.14.</span> Hippie</h3>
<div class="outline-text-3" id="text-6-14">
<p>
妙啊，Hippie-expand 的功能是这么的好用，我原来输入路径需要使用 cape-file，现在使用 hippie-expand 就好了。它还有其他的功能，介绍性的说明可以<a href="https://www.masteringemacs.org/article/text-expansion-hippie-expand">看这</a>。
</p>

<p>
设置 <code>hippie-expand-try-functions-list</code> ，把 <code>try-expand-list</code> 和 <code>try-expand-line</code> 去掉，他们会在末尾增加括号，有点多余。我己经使用 elec-pair 自动成对插入括号。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> hippie-expand-try-functions-list '<span style="color: #B48EAD;">(</span>try-complete-file-name-partially
                                         try-complete-file-name
                                         try-expand-all-abbrevs
                                         try-expand-dabbrev
                                         try-expand-dabbrev-all-buffers
                                         try-expand-dabbrev-from-kill
                                         try-complete-lisp-symbol-partially
                                         try-complete-lisp-symbol<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">[</span>remap dabbrev-expand<span style="color: #B48EAD;">]</span> 'hippie-expand<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgd5ac883" class="outline-2">
<h2 id="orgd5ac883"><span class="section-number-2">7.</span> AWESOME EMACS EQUIPPED WITH THIRD-PARTY PACKAGES</h2>
<div class="outline-text-2" id="text-7">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> read-extended-command-predicate
  #'command-completion-default-include-p<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> tab-always-indent 'complete<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">crm-indicator</span> <span style="color: #B48EAD;">(</span>args<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>cons <span style="color: #A3BE8C;">(</span>concat <span style="color: #A3BE8C;">"[CRM] "</span> <span style="color: #5D80AE;">(</span>car args<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span> <span style="color: #A3BE8C;">(</span>cdr args<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>advice-add #'completing-read-multiple <span style="color: #81A1C1;">:filter-args</span> #'crm-indicator<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
<div id="outline-container-org32c0461" class="outline-3">
<h3 id="org32c0461"><span class="section-number-3">7.1.</span> corfu</h3>
<div class="outline-text-3" id="text-7-1">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> corfu-auto t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> corfu-cycle t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> corfu-quit-at-boundary t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> corfu-auto-prefix 2<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> corfu-preselect-first t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> corfu-quit-no-match t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> completion-cycle-threshold 3<span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">corfu-enable-always-in-minibuffer</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #78808f;">"Enable Corfu in the minibuffer if Vertico/Mct are not active."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">unless</span> <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">or</span> <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">bound-and-true-p</span> mct--active<span style="color: #5D80AE;">)</span>
              <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">bound-and-true-p</span> vertico--input<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span>corfu-mode 1<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'minibuffer-setup-hook #'corfu-enable-always-in-minibuffer 1<span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span>add-hook 'org-mode-hook 'corfu-mode<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org4a3a418" class="outline-3">
<h3 id="org4a3a418"><span class="section-number-3">7.2.</span> vertico</h3>
<div class="outline-text-3" id="text-7-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> vertico-cycle t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'vertico
  <span style="color: #B48EAD;">(</span>define-key vertico-map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"C-j"</span><span style="color: #A3BE8C;">)</span> 'vertico-directory-up<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'on-first-input-hook 'vertico-mode<span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> completion-in-region-function
      <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">lambda</span> <span style="color: #A3BE8C;">(</span><span style="color: #8FBCBB;">&amp;rest</span> args<span style="color: #A3BE8C;">)</span>
        <span style="color: #A3BE8C;">(</span>apply <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">if</span> vertico-mode
                   #'consult-completion-in-region
                 #'completion--in-region<span style="color: #5D80AE;">)</span>
               args<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> read-file-name-completion-ignore-case t
      read-buffer-completion-ignore-case t
      completion-ignore-case t<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org6bfae20" class="outline-3">
<h3 id="org6bfae20"><span class="section-number-3">7.3.</span> orderless</h3>
<div class="outline-text-3" id="text-7-3">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> completion-styles '<span style="color: #B48EAD;">(</span>orderless partial-completion<span style="color: #B48EAD;">)</span>
      completion-category-defaults nil
      completion-category-overrides '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">(</span>file <span style="color: #5D80AE;">(</span>styles . <span style="color: #8FBCBB;">(</span>partial-completion<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orge4a2f89" class="outline-3">
<h3 id="orge4a2f89"><span class="section-number-3">7.4.</span> marginalia</h3>
<div class="outline-text-3" id="text-7-4">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'minibuffer-setup-hook 'marginalia-mode<span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'marginalia
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">cl-pushnew</span> 'epkg-marginalia-annotate-package
        <span style="color: #A3BE8C;">(</span>alist-get 'package marginalia-annotator-registry<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org670d782" class="outline-3">
<h3 id="org670d782"><span class="section-number-3">7.5.</span> consult</h3>
<div class="outline-text-3" id="text-7-5">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'completion-list-mode-hook 'consult-preview-at-point-mode<span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">[</span>remap apropos<span style="color: #B48EAD;">]</span> 'consult-apropos<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">[</span>remap bookmark-jump<span style="color: #B48EAD;">]</span> 'consult-bookmark<span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">[</span>remap goto-line<span style="color: #B48EAD;">]</span> 'consult-goto-line<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">[</span>remap imenu<span style="color: #B48EAD;">]</span> 'consult-imenu<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">[</span>remap locate<span style="color: #B48EAD;">]</span> 'consult-locate<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">[</span>remap load-theme<span style="color: #B48EAD;">]</span> 'consult-theme<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">[</span>remap man<span style="color: #B48EAD;">]</span> 'consult-man<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">[</span>remap recentf-open-files<span style="color: #B48EAD;">]</span> 'consult-recent-file<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">[</span>remap switch-to-buffer<span style="color: #B48EAD;">]</span> 'consult-buffer<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">[</span>remap switch-to-buffer-other-window<span style="color: #B48EAD;">]</span> 'consult-buffer-other-window<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">[</span>remap switch-to-buffer-other-frame<span style="color: #B48EAD;">]</span> 'consult-buffer-other-frame<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">[</span>remap yank-pop<span style="color: #B48EAD;">]</span> 'consult-yank-pop<span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"M-y"</span><span style="color: #B48EAD;">)</span> 'consult-yank-pop<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c f r"</span><span style="color: #B48EAD;">)</span> 'consult-recent-file<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c o o"</span><span style="color: #B48EAD;">)</span> 'consult-outline<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
  <span style="color: #A3BE8C;">"fr"</span> '<span style="color: #B48EAD;">(</span>consult-recent-file <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Recentf"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgbb6e7fc" class="outline-3">
<h3 id="orgbb6e7fc"><span class="section-number-3">7.6.</span> consult-dir</h3>
<div class="outline-text-3" id="text-7-6">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-x C-d"</span><span style="color: #B48EAD;">)</span> 'consult-dir<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'vertico
  <span style="color: #B48EAD;">(</span>define-key vertico-map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"C-x C-d"</span><span style="color: #A3BE8C;">)</span> 'consult-dir<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>define-key vertico-map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"C-x C-j"</span><span style="color: #A3BE8C;">)</span> 'consult-dir-jump-file<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org3ccc910" class="outline-3">
<h3 id="org3ccc910"><span class="section-number-3">7.7.</span> embark</h3>
<div class="outline-text-3" id="text-7-7">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> prefix-help-command #'embark-prefix-help-command<span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">[</span>remap describe-bindings<span style="color: #B48EAD;">]</span> #'embark-bindings<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-."</span><span style="color: #B48EAD;">)</span> 'embark-act<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"M-."</span><span style="color: #B48EAD;">)</span> 'embark-dwim<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org0153035" class="outline-3">
<h3 id="org0153035"><span class="section-number-3">7.8.</span> rime</h3>
<div class="outline-text-3" id="text-7-8">
<p>
我使用 emacs-rime 和三码郑码，不需要进行词库的维护。~rime-show-candidate~ 使用 <code>posframe</code> 对于性能还是有消耗的，所以日常使用 <code>minibuffer</code> 就可以了。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> rime-user-data-dir <span style="color: #A3BE8C;">"~/Library/Rime/"</span><span style="color: #81A1C1;">)</span>
<span style="color: #6f7787;">;; </span><span style="color: #6f7787;">(setq rime-emacs-module-header-root "/opt/homebrew/Cellar/emacs-plus@29/29.0.50/include")</span>
<span style="color: #6f7787;">;; </span><span style="color: #6f7787;">(setq rime-librime-root (expand-file-name "librime/dist" user-emacs-directory))</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> default-input-method <span style="color: #A3BE8C;">"rime"</span><span style="color: #81A1C1;">)</span>
<span style="color: #6f7787;">;; </span><span style="color: #6f7787;">(setq rime-title `(,(propertize (all-the-icons-faicon "pencil-square-o" :v-adjust -0.1)</span>
<span style="color: #6f7787;">;;                                </span><span style="color: #6f7787;">'face `(:family ,(all-the-icons-faicon-family)))))</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> rime-show-candidate 'minibuffer<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> rime-posframe-properties '<span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">:internal-border-width</span> 0<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> rime-disable-predicates '<span style="color: #B48EAD;">(</span>rime-predicate-prog-in-code-p
                                rime-predicate-org-in-src-block-p
                                rime-predicate-org-latex-mode-p
                                rime-predicate-current-uppercase-letter-p<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> rime-inline-predicates '<span style="color: #B48EAD;">(</span>rime-predicate-space-after-cc-p
                               rime-predicate-after-alphabet-char-p<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'rime
  <span style="color: #B48EAD;">(</span>define-key rime-mode-map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"M-j"</span><span style="color: #A3BE8C;">)</span> 'rime-force-enable<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'evil
  <span style="color: #B48EAD;">(</span>add-hook 'evil-insert-state-entry-hook <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">lambda</span> <span style="color: #5D80AE;">()</span>
                                            <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">if</span> <span style="color: #8FBCBB;">(</span>eq major-mode 'org-mode<span style="color: #8FBCBB;">)</span>
                                                <span style="color: #8FBCBB;">(</span>activate-input-method <span style="color: #A3BE8C;">"rime"</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>add-hook 'evil-insert-state-exit-hook #'evil-deactivate-input-method<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org5695d98" class="outline-3">
<h3 id="org5695d98"><span class="section-number-3">7.9.</span> rime-regexp</h3>
<div class="outline-text-3" id="text-7-9">
<p>
使用拼音进行中文的检索。原来使用的是拼音首字母进行检索，但是检出来的结果太多，所以还是使用全拼音进行检索。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'on-first-input-hook 'rime-regexp-mode<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org79bc06d" class="outline-3">
<h3 id="org79bc06d"><span class="section-number-3">7.10.</span> expand-region</h3>
<div class="outline-text-3" id="text-7-10">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-="</span><span style="color: #B48EAD;">)</span> 'er/expand-region<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd7c66b7" class="outline-3">
<h3 id="orgd7c66b7"><span class="section-number-3">7.11.</span> avy</h3>
<div class="outline-text-3" id="text-7-11">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'on-first-input-hook 'ace-pinyin-global-mode<span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
  <span style="color: #A3BE8C;">"g"</span> '<span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">:ignore</span> t <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Goto"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"gc"</span> '<span style="color: #B48EAD;">(</span>avy-goto-char <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Goto to char"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"gw"</span> '<span style="color: #B48EAD;">(</span>avy-goto-word-0 <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Goto to word"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"gl"</span> '<span style="color: #B48EAD;">(</span>avy-goto-line <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Goto to line"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orge775024" class="outline-3">
<h3 id="orge775024"><span class="section-number-3">7.12.</span> embrace</h3>
<div class="outline-text-3" id="text-7-12">
<p>
这个包很方便的对文本进行括号的增删改。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'embrace
  <span style="color: #B48EAD;">(</span>set-face-attribute 'embrace-help-pair-face nil <span style="color: #81A1C1;">:inherit</span> font-lock-function-name-face <span style="color: #81A1C1;">:inverse-video</span> nil<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'org-mode-hook 'embrace-org-mode-hook<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'LaTeX-mode-hook 'embrace-LaTeX-mode-hook<span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-,"</span><span style="color: #B48EAD;">)</span> 'embrace-commander<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf0f07f9" class="outline-3">
<h3 id="orgf0f07f9"><span class="section-number-3">7.13.</span> hungry delete</h3>
<div class="outline-text-3" id="text-7-13">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'on-first-input-hook 'global-hungry-delete-mode<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org19b3ca3" class="outline-3">
<h3 id="org19b3ca3"><span class="section-number-3">7.14.</span> Browse at remote</h3>
<div class="outline-text-3" id="text-7-14">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c f o r"</span><span style="color: #B48EAD;">)</span> 'browse-at-remote<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
  <span style="color: #A3BE8C;">"or"</span> '<span style="color: #B48EAD;">(</span>browse-at-remote <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Browse remote"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orge2f96ab" class="outline-3">
<h3 id="orge2f96ab"><span class="section-number-3">7.15.</span> Search engine</h3>
<div class="outline-text-3" id="text-7-15">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'engine-mode
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">defengine</span> google <span style="color: #A3BE8C;">"https://google.com/search?q=%s"</span>
             <span style="color: #81A1C1;">:keybinding</span> <span style="color: #A3BE8C;">"g"</span>
             <span style="color: #81A1C1;">:docstring</span> <span style="color: #A3BE8C;">"Search Google."</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">defengine</span> wikipedia <span style="color: #A3BE8C;">"https://en.wikipedia.org/wiki/Special:Search?search=%s"</span>
             <span style="color: #81A1C1;">:keybinding</span> <span style="color: #A3BE8C;">"w"</span>
             <span style="color: #81A1C1;">:docstring</span> <span style="color: #A3BE8C;">"Search Wikipedia."</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">defengine</span> github <span style="color: #A3BE8C;">"https://github.com/search?ref=simplesearch&amp;q=%s"</span>
             <span style="color: #81A1C1;">:keybinding</span> <span style="color: #A3BE8C;">"h"</span>
             <span style="color: #81A1C1;">:docstring</span> <span style="color: #A3BE8C;">"Search GitHub."</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">defengine</span> baidu <span style="color: #A3BE8C;">"https://www.baidu.com/s?ie=utf-8&amp;wd="</span>
             <span style="color: #81A1C1;">:keybinding</span> <span style="color: #A3BE8C;">"b"</span>
             <span style="color: #81A1C1;">:docstring</span> <span style="color: #A3BE8C;">"Search Baidu."</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">defengine</span> youtube <span style="color: #A3BE8C;">"http://www.youtube.com/results?aq=f&amp;oq=&amp;search_query=%s"</span>
             <span style="color: #81A1C1;">:keybinding</span> <span style="color: #A3BE8C;">"y"</span>
             <span style="color: #81A1C1;">:docstring</span> <span style="color: #A3BE8C;">"Search YouTube."</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">defengine</span> moviedouban <span style="color: #A3BE8C;">"https://search.douban.com/movie/subject_search?search_text=%s"</span>
             <span style="color: #81A1C1;">:keybinding</span> <span style="color: #A3BE8C;">"m"</span>
             <span style="color: #81A1C1;">:docstring</span> <span style="color: #A3BE8C;">"Search Moive DouBan."</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">defengine</span> zhihu <span style="color: #A3BE8C;">"https://www.zhihu.com/search?type=content&amp;q=%s"</span>
             <span style="color: #81A1C1;">:keybinding</span> <span style="color: #A3BE8C;">"z"</span>
             <span style="color: #81A1C1;">:docstring</span> <span style="color: #A3BE8C;">"Search Zhihu."</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'on-first-input-hook 'engine-mode<span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
  <span style="color: #A3BE8C;">"s"</span> '<span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">:ignore</span> t <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Search"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"sb"</span> '<span style="color: #B48EAD;">(</span>engine/search-baidu <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Baidu"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"ss"</span> '<span style="color: #B48EAD;">(</span>engine/search-google <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Google"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"sG"</span> '<span style="color: #B48EAD;">(</span>engine/search-github <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Github"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"sy"</span> '<span style="color: #B48EAD;">(</span>engine/search-youtube <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Youtube"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"sw"</span> '<span style="color: #B48EAD;">(</span>engine/search-wikipedia <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Wikipedia"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"sm"</span> '<span style="color: #B48EAD;">(</span>engine/search-moviedouban <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Movie DouBan"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"sz"</span> '<span style="color: #B48EAD;">(</span>engine/search-zhihu <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Zhihu"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orge600a81" class="outline-3">
<h3 id="orge600a81"><span class="section-number-3">7.16.</span> Tempel</h3>
<div class="outline-text-3" id="text-7-16">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> tempel-path <span style="color: #A3BE8C;">"~/.emacs.d/template/tempel"</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"M-+"</span><span style="color: #B48EAD;">)</span> 'tempel-complete<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"M-*"</span><span style="color: #B48EAD;">)</span> 'tempel-insert<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'tempel
  <span style="color: #B48EAD;">(</span>define-key tempel-map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"M-["</span><span style="color: #A3BE8C;">)</span> 'tempel-previous<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>define-key tempel-map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"M-]"</span><span style="color: #A3BE8C;">)</span> 'tempel-next<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org863db39" class="outline-3">
<h3 id="org863db39"><span class="section-number-3">7.17.</span> Perp</h3>
<div class="outline-text-3" id="text-7-17">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-x C-b"</span><span style="color: #B48EAD;">)</span> 'persp-list-buffers<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>customize-set-variable 'persp-mode-prefix-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c M-p"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span>persp-mode<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org8b83a3f" class="outline-3">
<h3 id="org8b83a3f"><span class="section-number-3">7.18.</span> Minimap</h3>
<div class="outline-text-3" id="text-7-18">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
  <span style="color: #A3BE8C;">"tm"</span> '<span style="color: #B48EAD;">(</span>minimap-mode <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Minimap"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgceff766" class="outline-3">
<h3 id="orgceff766"><span class="section-number-3">7.19.</span> helpful</h3>
<div class="outline-text-3" id="text-7-19">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> help-window-select t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">[</span>remap describe-function<span style="color: #B48EAD;">]</span> 'helpful-callable<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">[</span>remap describe-variable<span style="color: #B48EAD;">]</span> 'helpful-variable<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">[</span>remap describe-key<span style="color: #B48EAD;">]</span> 'helpful-key<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org676e058" class="outline-3">
<h3 id="org676e058"><span class="section-number-3">7.20.</span> gcmh</h3>
<div class="outline-text-3" id="text-7-20">
<p>
Emacs 中拉圾回收的策略是当Emacs自上一次垃圾收集后分配的内存超过 <code>gc-cons-threshold</code> 阀值时就会触发新一轮的垃圾收集行为。~gcmh~ 包对 Emacs 的拉圾回收进行了设置，当正常使用时，拉圾回收的阈值设置的较高，当 Emacs 空闲时阈值设的较低。
</p>

<p>
<a href="http://blog.lujun9972.win/blog/2019/05/16/%E4%BC%98%E5%8C%96emacs%E7%9A%84%E5%9E%83%E5%9C%BE%E6%90%9C%E9%9B%86%E8%A1%8C%E4%B8%BA/index.html">优化Emacs的垃圾搜集行为</a> 一文中提出了通过记录每次垃圾收集的时间来进行判断和调整 <code>gc-cons-threshold</code> 的值。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> gcmh-idle-delay 'auto<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> gcmh-auto-idle-delay-factor 10<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> gcmh-high-cons-threshold #x1000000<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>gcmh-mode 1<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org83515eb" class="outline-2">
<h2 id="org83515eb"><span class="section-number-2">8.</span> EMACS WORKS WITH MULTIPLE LANGUAGE, PIECE OF CAKE</h2>
<div class="outline-text-2" id="text-8">
</div>
<div id="outline-container-org0216113" class="outline-3">
<h3 id="org0216113"><span class="section-number-3">8.1.</span> Language Spelling</h3>
<div class="outline-text-3" id="text-8-1">
</div>
<div id="outline-container-org31aa903" class="outline-4">
<h4 id="org31aa903"><span class="section-number-4">8.1.1.</span> ispell</h4>
<div class="outline-text-4" id="text-8-1-1">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">require</span> '<span style="color: #81A1C1;">ispell</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> ispell-program-name <span style="color: #A3BE8C;">"/opt/homebrew/bin/aspell"</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> ispell-extra-args '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"--sug-mode=ultra"</span> <span style="color: #A3BE8C;">"--lang=en_US"</span> <span style="color: #A3BE8C;">"--run-together"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> ispell-aspell-dict-dir
      <span style="color: #B48EAD;">(</span>ispell-get-aspell-config-value <span style="color: #A3BE8C;">"dict-dir"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> ispell-aspell-data-dir
      <span style="color: #B48EAD;">(</span>ispell-get-aspell-config-value <span style="color: #A3BE8C;">"data-dir"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> ispell-personal-dictionary <span style="color: #B48EAD;">(</span>expand-file-name <span style="color: #A3BE8C;">"config/ispell/.aspell.en.pws"</span> my-galaxy<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orge6a4a03" class="outline-4">
<h4 id="orge6a4a03"><span class="section-number-4">8.1.2.</span> wucuo</h4>
<div class="outline-text-4" id="text-8-1-2">
<blockquote>
<p>
Fastest solution to spell check camel case code or plain text.
</p>
</blockquote>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'on-first-buffer-hook 'wucuo-mode<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'prog-mode-hook #'wucuo-start<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'text-mode-hook #'wucuo-start<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org518598d" class="outline-4">
<h4 id="org518598d"><span class="section-number-4">8.1.3.</span> flyspell</h4>
<div class="outline-text-4" id="text-8-1-3">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'flyspell
  <span style="color: #B48EAD;">(</span>define-key flyspell-mode-map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"C-;"</span><span style="color: #A3BE8C;">)</span> nil<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>define-key flyspell-mode-map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"C-,"</span><span style="color: #A3BE8C;">)</span> nil<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>define-key flyspell-mode-map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"C-."</span><span style="color: #A3BE8C;">)</span> nil<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org469efdc" class="outline-4">
<h4 id="org469efdc"><span class="section-number-4">8.1.4.</span> flyspell-correct</h4>
<div class="outline-text-4" id="text-8-1-4">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-;"</span><span style="color: #B48EAD;">)</span> ' flyspell-correct-wrapper<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org6d441d1" class="outline-4">
<h4 id="org6d441d1"><span class="section-number-4">8.1.5.</span> grammar</h4>
<div class="outline-text-4" id="text-8-1-5">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> langtool-http-server-host <span style="color: #A3BE8C;">"localhost"</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> langtool-http-server-port 8081<span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c g c"</span><span style="color: #B48EAD;">)</span> #'langtool-check<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c g C"</span><span style="color: #B48EAD;">)</span> #'langtool-correct-buffer<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c g d"</span><span style="color: #B48EAD;">)</span> #'langtool-check-done<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgc7cb14e" class="outline-3">
<h3 id="orgc7cb14e"><span class="section-number-3">8.2.</span> Language Translate</h3>
<div class="outline-text-3" id="text-8-2">
</div>
<div id="outline-container-org3f7c7df" class="outline-4">
<h4 id="org3f7c7df"><span class="section-number-4">8.2.1.</span> dictionary</h4>
<div class="outline-text-4" id="text-8-2-1">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> dictionary-server <span style="color: #A3BE8C;">"dict.org"</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c l d"</span><span style="color: #B48EAD;">)</span> #'dictionary-search<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
  <span style="color: #A3BE8C;">"l"</span> '<span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">:ignore</span> t <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Language"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"ld"</span> '<span style="color: #B48EAD;">(</span>dictionary-search <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Dictionary"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org402c07d" class="outline-4">
<h4 id="org402c07d"><span class="section-number-4">8.2.2.</span> mw-thesaurus</h4>
<div class="outline-text-4" id="text-8-2-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c l t"</span><span style="color: #B48EAD;">)</span> 'mw-thesaurus-lookup-dwim<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
  <span style="color: #A3BE8C;">"lt"</span> '<span style="color: #B48EAD;">(</span>mw-thesaurus-lookup-dwim <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Thesaurus"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org376bffd" class="outline-4">
<h4 id="org376bffd"><span class="section-number-4">8.2.3.</span> go-translate</h4>
<div class="outline-text-4" id="text-8-2-3">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'go-translate
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">setq</span> gts-translate-list '<span style="color: #A3BE8C;">(</span><span style="color: #5D80AE;">(</span><span style="color: #A3BE8C;">"en"</span> <span style="color: #A3BE8C;">"zh"</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">setq</span> gts-default-translator <span style="color: #A3BE8C;">(</span>gts-translator
                <span style="color: #81A1C1;">:picker</span> <span style="color: #5D80AE;">(</span>gts-noprompt-picker<span style="color: #5D80AE;">)</span>
                <span style="color: #81A1C1;">:engines</span> <span style="color: #5D80AE;">(</span>list
                      <span style="color: #8FBCBB;">(</span>gts-google-engine <span style="color: #81A1C1;">:parser</span> <span style="color: #81A1C1;">(</span>gts-google-summary-parser<span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
                <span style="color: #81A1C1;">:render</span> <span style="color: #5D80AE;">(</span>gts-buffer-render<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c l l"</span><span style="color: #B48EAD;">)</span> 'gts-do-translate<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
  <span style="color: #A3BE8C;">"ll"</span> '<span style="color: #B48EAD;">(</span>gts-do-translate <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Translate"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org5615db8" class="outline-4">
<h4 id="org5615db8"><span class="section-number-4">8.2.4.</span> lingva</h4>
<div class="outline-text-4" id="text-8-2-4">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> lingva-target <span style="color: #A3BE8C;">"zh"</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c l L"</span><span style="color: #B48EAD;">)</span> 'lingva-translate<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org635a0b1" class="outline-3">
<h3 id="org635a0b1"><span class="section-number-3">8.3.</span> Writegood</h3>
<div class="outline-text-3" id="text-8-3">
<p>
具体看此 <a href="https://en.wikipedia.org/wiki/Flesch%E2%80%93Kincaid_readability_tests">Flesch–Kincaid</a>，关于英语可读性的测试。分数越高，可读性越强；分数越低，就越困难。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'org-mode-hook 'writegood-mode<span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c l w g"</span><span style="color: #B48EAD;">)</span> 'writegood-grade-level<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c l w e"</span><span style="color: #B48EAD;">)</span> 'writegood-reading-ease<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgfcb5e6b" class="outline-3">
<h3 id="orgfcb5e6b"><span class="section-number-3">8.4.</span> Flymake</h3>
<div class="outline-text-3" id="text-8-4">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'prog-mode-hook 'flymake-mode<span style="color: #81A1C1;">)</span>
<span style="color: #6f7787;">;; </span><span style="color: #6f7787;">(add-hook 'flymake-mode-hook 'flymake-popon-mode)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
  <span style="color: #A3BE8C;">"t"</span> '<span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">:ignore</span> t <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Toggle"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"tf"</span> '<span style="color: #B48EAD;">(</span>flymake-mode <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Flymake"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"tt"</span> '<span style="color: #B48EAD;">(</span>org-pomodoro <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Pomodoro"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org44323b7" class="outline-3">
<h3 id="org44323b7"><span class="section-number-3">8.5.</span> Language Service Protocol, LSP</h3>
<div class="outline-text-3" id="text-8-5">
<p>
Emacs 目前有三个 LSP 实现，分别是 <code>lsp-mode</code> <code>eglot</code> 和 <code>lsp-bridge</code> 。三个都有尝试过， <code>lsp-bridge</code> 是这三个里面最不会卡 Emacs 的。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'prog-mode-hook 'lsp-bridge-mode<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'org-mode-hook #'<span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">lambda</span> <span style="color: #A3BE8C;">()</span> <span style="color: #A3BE8C;">(</span>lsp-bridge-mode -1<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c l h"</span><span style="color: #B48EAD;">)</span> 'lsp-bridge-toggle-english-helper<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgff75475" class="outline-3">
<h3 id="orgff75475"><span class="section-number-3">8.6.</span> Multiple Programming Language</h3>
<div class="outline-text-3" id="text-8-6">
</div>
<div id="outline-container-orge3b1e00" class="outline-4">
<h4 id="orge3b1e00"><span class="section-number-4">8.6.1.</span> Markdown</h4>
<div class="outline-text-4" id="text-8-6-1">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-to-list 'auto-mode-alist
             '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"README\\.md\\'"</span> . gfm-mode<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf93e81d" class="outline-4">
<h4 id="orgf93e81d"><span class="section-number-4">8.6.2.</span> CSV</h4>
<div class="outline-text-4" id="text-8-6-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-to-list 'auto-mode-alist
             '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"\\.csv\\'"</span> . csv-mode<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgcfa9d4c" class="outline-4">
<h4 id="orgcfa9d4c"><span class="section-number-4">8.6.3.</span> Yaml</h4>
<div class="outline-text-4" id="text-8-6-3">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-to-list 'auto-mode-alist
             '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"\\.yaml\\'"</span> . yaml-mode<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-org5799137" class="outline-2">
<h2 id="org5799137"><span class="section-number-2">9.</span> ORGANIZE LIFE WITH PLAIN TEXT, HIGH EFFECTIVE SYSTEM</h2>
<div class="outline-text-2" id="text-9">
</div>
<div id="outline-container-org1e0b99f" class="outline-3">
<h3 id="org1e0b99f"><span class="section-number-3">9.1.</span> Better Default</h3>
<div class="outline-text-3" id="text-9-1">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-modules '<span style="color: #B48EAD;">()</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-imenu-depth 4<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-return-follows-link t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-image-actual-width nil<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-display-remote-inline-images 'download<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-log-into-drawer t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-fast-tag-selection-single-key 'expert<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-adapt-indentation nil<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-fontify-quote-and-verse-blocks t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-support-shift-select t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-treat-S-cursor-todo-selection-as-state-change nil<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-hide-leading-stars nil<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-startup-with-inline-images t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-image-actual-width '<span style="color: #B48EAD;">(</span>500<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org5e529ad" class="outline-3">
<h3 id="org5e529ad"><span class="section-number-3">9.2.</span> Tasks state</h3>
<div class="outline-text-3" id="text-9-2">
<p>
If you do not provide the separator bar, the last state is used as the DONE state.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-todo-repeat-to-state t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-todo-keywords
  '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">(</span>sequence <span style="color: #A3BE8C;">"TODO(t)"</span> <span style="color: #A3BE8C;">"NEXT(n)"</span> <span style="color: #A3BE8C;">"INPROGRESS(i)"</span> <span style="color: #A3BE8C;">"|"</span> <span style="color: #A3BE8C;">"WAIT(w@)"</span> <span style="color: #A3BE8C;">"SOMEDAY(s@)"</span> <span style="color: #A3BE8C;">"CNCL(c@/!)"</span> <span style="color: #A3BE8C;">"DONE(d)"</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-todo-state-tags-triggers
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">quote</span> <span style="color: #A3BE8C;">(</span><span style="color: #5D80AE;">(</span><span style="color: #A3BE8C;">"CNCL"</span> <span style="color: #8FBCBB;">(</span><span style="color: #A3BE8C;">"CNCL"</span> . t<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
          <span style="color: #5D80AE;">(</span><span style="color: #A3BE8C;">"WAIT"</span> <span style="color: #8FBCBB;">(</span><span style="color: #A3BE8C;">"WAIT"</span> . t<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
          <span style="color: #5D80AE;">(</span><span style="color: #A3BE8C;">"SOMEDAY"</span> <span style="color: #8FBCBB;">(</span><span style="color: #A3BE8C;">"WAIT"</span><span style="color: #8FBCBB;">)</span> <span style="color: #8FBCBB;">(</span><span style="color: #A3BE8C;">"SOMEDAY"</span> . t<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
          <span style="color: #5D80AE;">(</span>done <span style="color: #8FBCBB;">(</span><span style="color: #A3BE8C;">"WAIT"</span><span style="color: #8FBCBB;">)</span> <span style="color: #8FBCBB;">(</span><span style="color: #A3BE8C;">"SOMEDAY"</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
          <span style="color: #5D80AE;">(</span><span style="color: #A3BE8C;">"TODO"</span> <span style="color: #8FBCBB;">(</span><span style="color: #A3BE8C;">"WAIT"</span><span style="color: #8FBCBB;">)</span> <span style="color: #8FBCBB;">(</span><span style="color: #A3BE8C;">"CNCL"</span><span style="color: #8FBCBB;">)</span> <span style="color: #8FBCBB;">(</span><span style="color: #A3BE8C;">"SOMEDAY"</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
          <span style="color: #5D80AE;">(</span><span style="color: #A3BE8C;">"NEXT"</span> <span style="color: #8FBCBB;">(</span><span style="color: #A3BE8C;">"WAIT"</span><span style="color: #8FBCBB;">)</span> <span style="color: #8FBCBB;">(</span><span style="color: #A3BE8C;">"CNCL"</span><span style="color: #8FBCBB;">)</span> <span style="color: #8FBCBB;">(</span><span style="color: #A3BE8C;">"SOMEDAY"</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
          <span style="color: #5D80AE;">(</span><span style="color: #A3BE8C;">"DONE"</span> <span style="color: #8FBCBB;">(</span><span style="color: #A3BE8C;">"WAIT"</span><span style="color: #8FBCBB;">)</span> <span style="color: #8FBCBB;">(</span><span style="color: #A3BE8C;">"CNCL"</span><span style="color: #8FBCBB;">)</span> <span style="color: #8FBCBB;">(</span><span style="color: #A3BE8C;">"SOMEDAY"</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org8750641" class="outline-3">
<h3 id="org8750641"><span class="section-number-3">9.3.</span> Babel</h3>
<div class="outline-text-3" id="text-9-3">
<p>
根据需要加载 org-babel-load-languages, 加快 Emacs 的启动速度，<a href="https://emacs-china.org/t/org-babel/18699">相关讨论见 Emacs-china 论坛</a>。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-babel-python-command <span style="color: #A3BE8C;">"python3"</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #6f7787;">;; </span><span style="color: #6f7787;">(org-babel-do-load-languages</span>
<span style="color: #6f7787;">;;  </span><span style="color: #6f7787;">'org-babel-load-languages</span>
<span style="color: #6f7787;">;;  </span><span style="color: #6f7787;">'((emacs-lisp . t)))</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">my/org-babel-execute-src-block</span> <span style="color: #B48EAD;">(</span><span style="color: #8FBCBB;">&amp;optional</span> _arg info _params<span style="color: #B48EAD;">)</span>
  <span style="color: #78808f;">"Load language if needed"</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">let*</span> <span style="color: #A3BE8C;">(</span><span style="color: #5D80AE;">(</span>lang <span style="color: #8FBCBB;">(</span>nth 0 info<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
         <span style="color: #5D80AE;">(</span>sym <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">if</span> <span style="color: #81A1C1;">(</span>member <span style="color: #B48EAD;">(</span>downcase lang<span style="color: #B48EAD;">)</span> '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"c"</span> <span style="color: #A3BE8C;">"cpp"</span> <span style="color: #A3BE8C;">"c++"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span> 'C <span style="color: #81A1C1;">(</span>intern lang<span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
         <span style="color: #5D80AE;">(</span>backup-languages org-babel-load-languages<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
    <span style="color: #6f7787;">;; </span><span style="color: #6f7787;">- (LANG . nil) &#26126;&#30830;&#31105;&#27490;&#30340;&#35821;&#35328;&#65292;&#19981;&#21152;&#36733;&#12290;</span>
    <span style="color: #6f7787;">;; </span><span style="color: #6f7787;">- (LANG . t) &#24050;&#21152;&#36733;&#36807;&#30340;&#35821;&#35328;&#65292;&#19981;&#37325;&#22797;&#36733;&#12290;</span>
    <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">unless</span> <span style="color: #5D80AE;">(</span>assoc sym backup-languages<span style="color: #5D80AE;">)</span>
      <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">condition-case</span> err
          <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">progn</span>
            <span style="color: #81A1C1;">(</span>org-babel-do-load-languages 'org-babel-load-languages <span style="color: #B48EAD;">(</span>list <span style="color: #A3BE8C;">(</span>cons sym t<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
            <span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq-default</span> org-babel-load-languages <span style="color: #B48EAD;">(</span>append <span style="color: #A3BE8C;">(</span>list <span style="color: #5D80AE;">(</span>cons sym t<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span> backup-languages<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
        <span style="color: #8FBCBB;">(</span>file-missing
         <span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq-default</span> org-babel-load-languages backup-languages<span style="color: #81A1C1;">)</span>
         err<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>advice-add 'org-babel-execute-src-block <span style="color: #81A1C1;">:before</span> 'my/org-babel-execute-src-block<span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-confirm-babel-evaluate nil<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org7708565" class="outline-3">
<h3 id="org7708565"><span class="section-number-3">9.4.</span> Capture</h3>
<div class="outline-text-3" id="text-9-4">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-capture-templates
      `<span style="color: #B48EAD;">(</span>
        <span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"a"</span> <span style="color: #A3BE8C;">"Anki Deck"</span><span style="color: #A3BE8C;">)</span>
        <span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"ae"</span> <span style="color: #A3BE8C;">"Deck: English"</span> entry <span style="color: #5D80AE;">(</span>file <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">lambda</span> <span style="color: #81A1C1;">()</span> <span style="color: #81A1C1;">(</span>concat my-galaxy <span style="color: #A3BE8C;">"/anki/anki_english.org"</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
         <span style="color: #A3BE8C;">"* %?\n"</span> <span style="color: #81A1C1;">:jump-to-captured</span> t<span style="color: #A3BE8C;">)</span>
        <span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"ac"</span> <span style="color: #A3BE8C;">"Deck: Civil Engineering"</span> entry <span style="color: #5D80AE;">(</span>file <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">lambda</span> <span style="color: #81A1C1;">()</span> <span style="color: #81A1C1;">(</span>concat my-galaxy <span style="color: #A3BE8C;">"/anki/anki_engineering.org"</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
         <span style="color: #A3BE8C;">"* %?\n"</span> <span style="color: #81A1C1;">:jump-to-captured</span> t<span style="color: #A3BE8C;">)</span>
        <span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"i"</span> ,<span style="color: #5D80AE;">(</span>format <span style="color: #A3BE8C;">"%s\tInbox: Daily note and tasks"</span> <span style="color: #8FBCBB;">(</span>all-the-icons-material <span style="color: #A3BE8C;">"inbox"</span> <span style="color: #81A1C1;">:face</span> 'all-the-icons-<span style="color: #000000; background-color: #00ff00;">green</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span> plain <span style="color: #5D80AE;">(</span>file+olp+datetree <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">lambda</span> <span style="color: #81A1C1;">()</span> <span style="color: #81A1C1;">(</span>concat my-galaxy <span style="color: #A3BE8C;">"/inbox/inbox.org"</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
         <span style="color: #A3BE8C;">"**** %?\n%U\n"</span> <span style="color: #81A1C1;">:time-prompt</span> t <span style="color: #81A1C1;">:tree-type</span> week<span style="color: #A3BE8C;">)</span>
        <span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"l"</span> <span style="color: #A3BE8C;">"Lists"</span><span style="color: #A3BE8C;">)</span>
        <span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"lm"</span> <span style="color: #A3BE8C;">"Movie"</span> entry <span style="color: #5D80AE;">(</span>file+headline <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">lambda</span> <span style="color: #81A1C1;">()</span> <span style="color: #81A1C1;">(</span>concat my-galaxy <span style="color: #A3BE8C;">"/roam/main/movie.org"</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span> <span style="color: #A3BE8C;">"Movie list"</span><span style="color: #5D80AE;">)</span>
         <span style="color: #A3BE8C;">"** %?</span>
<span style="color: #A3BE8C;">:PROPERTIES:</span>
<span style="color: #A3BE8C;">:GENRE: %^{Film genre|Action|Adventure|Comedy|Drama|Fantasy|Horror|Musicals|Mystery|Romance|Science fiction|Sports|Thriller}</span>
<span style="color: #A3BE8C;">:COUNTRY:</span>
<span style="color: #A3BE8C;">:SCORE:</span>
<span style="color: #A3BE8C;">:PLOT: %^{PLOT}</span>
<span style="color: #A3BE8C;">:END:"</span><span style="color: #A3BE8C;">)</span>
        <span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"s"</span> ,<span style="color: #5D80AE;">(</span>format <span style="color: #A3BE8C;">"%s\tCode Snippet"</span> <span style="color: #8FBCBB;">(</span>all-the-icons-material <span style="color: #A3BE8C;">"code"</span> <span style="color: #81A1C1;">:face</span> 'all-the-icons-<span style="color: #000000; background-color: #00ffff;">cyan</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span> entry <span style="color: #5D80AE;">(</span>file <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">lambda</span> <span style="color: #81A1C1;">()</span> <span style="color: #81A1C1;">(</span>concat my-galaxy <span style="color: #A3BE8C;">"/scripts/snippets.org"</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
         <span style="color: #A3BE8C;">"* %?\t%^g\n#+BEGIN_SRC %^{language}\n\n#+END_SRC"</span><span style="color: #A3BE8C;">)</span>
        <span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"c"</span> ,<span style="color: #5D80AE;">(</span>format <span style="color: #A3BE8C;">"%s\tContacts"</span> <span style="color: #8FBCBB;">(</span>all-the-icons-material <span style="color: #A3BE8C;">"contacts"</span> <span style="color: #81A1C1;">:face</span> 'all-the-icons-<span style="color: #ffffff; background-color: #b03060;">maroon</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span> entry <span style="color: #5D80AE;">(</span>file <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">lambda</span> <span style="color: #81A1C1;">()</span> <span style="color: #81A1C1;">(</span>concat my-galaxy <span style="color: #A3BE8C;">"/people/contacts.org"</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
         <span style="color: #A3BE8C;">"* %(org-contacts-template-name)</span>
<span style="color: #A3BE8C;">:PROPERTIES:</span>
<span style="color: #A3BE8C;">:EMAIL: %(org-contacts-template-email)</span>
<span style="color: #A3BE8C;">:PHONE:</span>
<span style="color: #A3BE8C;">:ALIAS:</span>
<span style="color: #A3BE8C;">:NICKNAME:</span>
<span style="color: #A3BE8C;">:IGNORE:</span>
<span style="color: #A3BE8C;">:ICON:</span>
<span style="color: #A3BE8C;">:NOTE:</span>
<span style="color: #A3BE8C;">:ADDRESS:</span>
<span style="color: #A3BE8C;">:BIRTHDAY:</span>
<span style="color: #A3BE8C;">:END:"</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c n n"</span><span style="color: #B48EAD;">)</span> 'org-capture<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"&lt;f9&gt;"</span><span style="color: #B48EAD;">)</span> 'org-capture<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
  <span style="color: #A3BE8C;">"nn"</span> '<span style="color: #B48EAD;">(</span>org-capture <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Org capture"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org59d53cd" class="outline-3">
<h3 id="org59d53cd"><span class="section-number-3">9.5.</span> Attachment</h3>
<div class="outline-text-3" id="text-9-5">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-attach-id-to-path-function-list
  '<span style="color: #B48EAD;">(</span>org-attach-id-ts-folder-format
    org-attach-id-uuid-folder-format<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-attach-dir-relative t<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgfa38500" class="outline-3">
<h3 id="orgfa38500"><span class="section-number-3">9.6.</span> Refile</h3>
<div class="outline-text-3" id="text-9-6">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-refile-targets '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">(</span>nil <span style="color: #81A1C1;">:maxlevel</span> . 9<span style="color: #A3BE8C;">)</span>
                           <span style="color: #A3BE8C;">(</span>org-agenda-files <span style="color: #81A1C1;">:maxlevel</span> . 9<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-refile-use-outline-path t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-outline-path-complete-in-steps nil<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-refile-allow-creating-parent-nodes 'confirm<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-refile-use-outline-path 'file<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-refile-active-region-within-subtree t<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org0fa3628" class="outline-3">
<h3 id="org0fa3628"><span class="section-number-3">9.7.</span> Frame</h3>
<div class="outline-text-3" id="text-9-7">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-link-frame-setup '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">(</span>vm . vm-visit-folder-other-frame<span style="color: #A3BE8C;">)</span>
                             <span style="color: #A3BE8C;">(</span>vm-imap . vm-visit-imap-folder-other-frame<span style="color: #A3BE8C;">)</span>
                             <span style="color: #A3BE8C;">(</span>gnus . org-gnus-no-new-news<span style="color: #A3BE8C;">)</span>
                             <span style="color: #A3BE8C;">(</span>file . find-file<span style="color: #A3BE8C;">)</span>
                             <span style="color: #A3BE8C;">(</span>wl . wl-other-frame<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd9b2000" class="outline-3">
<h3 id="orgd9b2000"><span class="section-number-3">9.8.</span> Archive</h3>
<div class="outline-text-3" id="text-9-8">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-archive-location <span style="color: #B48EAD;">(</span>expand-file-name <span style="color: #A3BE8C;">"todos/gtd_archive.org::datetree/"</span> my-galaxy<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">my/gtd-archive</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>find-file <span style="color: #A3BE8C;">(</span>expand-file-name <span style="color: #A3BE8C;">"todos/gtd_archive.org"</span> my-galaxy<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c f o G"</span><span style="color: #B48EAD;">)</span> #'my/gtd-archive<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org7c9703c" class="outline-3">
<h3 id="org7c9703c"><span class="section-number-3">9.9.</span> Habit</h3>
<div class="outline-text-3" id="text-9-9">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-to-list 'org-modules 'org-habit t<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orga237512" class="outline-3">
<h3 id="orga237512"><span class="section-number-3">9.10.</span> SRC</h3>
<div class="outline-text-3" id="text-9-10">
<p>
默认是在右侧打开编辑 buffer，屏幕小，所以我选择当前窗口打开编辑 buffer 。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'org
  <span style="color: #B48EAD;">(</span>diminish 'org-src-mode<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">setq</span> org-src-window-setup 'current-window<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">setq</span> org-src-ask-before-returning-to-edit-buffer nil<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org6c1e7e8" class="outline-3">
<h3 id="org6c1e7e8"><span class="section-number-3">9.11.</span> ID</h3>
<div class="outline-text-3" id="text-9-11">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-id-method 'ts<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-id-link-to-org-use-id 'create-if-interactive<span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c p i"</span><span style="color: #B48EAD;">)</span> 'org-id-get-create<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org634c7f6" class="outline-3">
<h3 id="org634c7f6"><span class="section-number-3">9.12.</span> Clock</h3>
<div class="outline-text-3" id="text-9-12">
<p>
参照了<a href="http://doc.norang.ca/org-mode.html#Clocking">Org Mode - Organize Your Life In Plain Text!</a> 中的设置，punch-in 和 punch-out 是很好的一个概念，具体的使用方法看此链接中的说明，写的很清楚。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'on-first-buffer-hook 'org-clock-persistence-insinuate<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-clock-history-length 23<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-clock-in-resume t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-clock-into-drawer <span style="color: #A3BE8C;">"LOGCLOCK"</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-clock-out-remove-zero-time-clocks t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-clock-out-when-done t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-clock-persist t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-clock-persist-query-resume nil<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-clock-report-include-clocking-task t<span style="color: #81A1C1;">)</span>
<span style="color: #6f7787;">;; </span><span style="color: #6f7787;">(setq org-clock-out-switch-to-state "DONE")</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-clock-in-switch-to-state 'bh/clock-in-to-next<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> bh/keep-clock-running nil<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb08b8fc" class="outline-3">
<h3 id="orgb08b8fc"><span class="section-number-3">9.13.</span> Indent</h3>
<div class="outline-text-3" id="text-9-13">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'org-mode-hook 'org-indent-mode<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'org-indent
  <span style="color: #B48EAD;">(</span>diminish 'org-indent-mode<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org0143f8f" class="outline-3">
<h3 id="org0143f8f"><span class="section-number-3">9.14.</span> Publish</h3>
<div class="outline-text-3" id="text-9-14">
<ul class="org-ul">
<li><a href="https://taingram.org/blog/org-mode-blog.html">Building a Emacs Org-Mode Blog</a></li>
<li><a href="https://sgtpeacock.com/dot-files/Emacs.html#orgdf03d07">Emacs Configuration</a></li>
</ul>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-publish-project-alist
      `<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"pages"</span>
         <span style="color: #81A1C1;">:base-directory</span> <span style="color: #A3BE8C;">"~/Nextcloud/L.Personal.Galaxy/roam/blogs"</span>
         <span style="color: #81A1C1;">:base-extension</span> <span style="color: #A3BE8C;">"org"</span>
         <span style="color: #81A1C1;">:recursive</span> nil
         <span style="color: #81A1C1;">:publishing-directory</span> <span style="color: #A3BE8C;">"~/shuyi.github.io/"</span>
         <span style="color: #81A1C1;">:publishing-function</span> org-html-publish-to-html
         <span style="color: #A3BE8C;">)</span>
        <span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"blogs"</span>
         <span style="color: #81A1C1;">:base-directory</span> <span style="color: #A3BE8C;">"~/Nextcloud/L.Personal.Galaxy/roam/blogs/blog"</span>
         <span style="color: #81A1C1;">:base-extension</span> <span style="color: #A3BE8C;">"org"</span>
         <span style="color: #81A1C1;">:publishing-directory</span> <span style="color: #A3BE8C;">"~/shuyi.github.io/"</span>
         <span style="color: #81A1C1;">:publishing-function</span> org-html-publish-to-html
         <span style="color: #81A1C1;">:auto-sitemap</span> t
         <span style="color: #81A1C1;">:sitemap-title</span> <span style="color: #A3BE8C;">"Blog Posts"</span>
         <span style="color: #81A1C1;">:sitemap-filename</span> <span style="color: #A3BE8C;">"index.org"</span>
         <span style="color: #81A1C1;">:sitemap-sort-files</span> anti-chronologically
         <span style="color: #A3BE8C;">)</span>

        <span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"static"</span>
         <span style="color: #81A1C1;">:base-directory</span> <span style="color: #A3BE8C;">"~/Nextcloud/L.Personal.Galaxy/roam/blogs"</span>
         <span style="color: #81A1C1;">:base-extension</span> <span style="color: #A3BE8C;">"css</span><span style="color: #81A1C1; font-weight: bold;">\\</span><span style="color: #81A1C1; font-weight: bold;">|</span><span style="color: #A3BE8C;">txt</span><span style="color: #81A1C1; font-weight: bold;">\\</span><span style="color: #81A1C1; font-weight: bold;">|</span><span style="color: #A3BE8C;">jpg</span><span style="color: #81A1C1; font-weight: bold;">\\</span><span style="color: #81A1C1; font-weight: bold;">|</span><span style="color: #A3BE8C;">gif</span><span style="color: #81A1C1; font-weight: bold;">\\</span><span style="color: #81A1C1; font-weight: bold;">|</span><span style="color: #A3BE8C;">png"</span>
         <span style="color: #81A1C1;">:recursive</span> t

                                        <span style="color: #6f7787;">; </span><span style="color: #6f7787;">HTML5</span>
         <span style="color: #81A1C1;">:html-doctype</span> <span style="color: #A3BE8C;">"html5"</span>
         <span style="color: #81A1C1;">:html-html5-fancy</span> t

                                        <span style="color: #6f7787;">; </span><span style="color: #6f7787;">Disable some Org's HTML defaults</span>
         <span style="color: #81A1C1;">:html-head-include-scripts</span> nil
         <span style="color: #81A1C1;">:html-head-include-default-style</span> nil
         <span style="color: #81A1C1;">:publishing-directory</span>  <span style="color: #A3BE8C;">"~/shuyi.github.io/"</span>
         <span style="color: #81A1C1;">:html-head</span> <span style="color: #A3BE8C;">"&lt;link rel=\"stylesheet\" href=\"css/style.css\" type=\"text/css\" /&gt;"</span>
         <span style="color: #81A1C1;">:publishing-function</span> org-publish-attachment<span style="color: #A3BE8C;">)</span>

        <span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"personal-website"</span> <span style="color: #81A1C1;">:components</span> <span style="color: #5D80AE;">(</span><span style="color: #A3BE8C;">"pages"</span> <span style="color: #A3BE8C;">"blogs"</span> <span style="color: #A3BE8C;">"static"</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org210fd0e" class="outline-3">
<h3 id="org210fd0e"><span class="section-number-3">9.15.</span> KEYS</h3>
<div class="outline-text-3" id="text-9-15">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-use-speed-commands t<span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">evil-declare-key</span> 'normal org-mode-map
  <span style="color: #A3BE8C;">"gh"</span> 'consult-outline<span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
  <span style="color: #A3BE8C;">"nt"</span> '<span style="color: #B48EAD;">(</span>org-todo-list <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Todo list"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"nv"</span> '<span style="color: #B48EAD;">(</span>org-search-view <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"View search"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"nc"</span> '<span style="color: #B48EAD;">(</span>org-clock-goto <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Clock goto"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/local-leader-def</span>
  <span style="color: #81A1C1;">:states</span> 'normal
  <span style="color: #81A1C1;">:keymaps</span> 'org-mode-map
  <span style="color: #A3BE8C;">"'"</span> '<span style="color: #B48EAD;">(</span>org-edit-special <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Edit special"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"+"</span> '<span style="color: #B48EAD;">(</span>org-ctrl-c-minus <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Minus"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">","</span> '<span style="color: #B48EAD;">(</span>org-switchb <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Switch buffer"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"@"</span> '<span style="color: #B48EAD;">(</span>org-cite-insert <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Cite"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"A"</span> '<span style="color: #B48EAD;">(</span>org-archive-subtree <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Archive subtree"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"e"</span> '<span style="color: #B48EAD;">(</span>org-export-dispatch <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Dispatch"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"f"</span> '<span style="color: #B48EAD;">(</span>org-footnote-action <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Footnote"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"I"</span> '<span style="color: #B48EAD;">(</span>org-id-get-create <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"ID"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"k"</span> '<span style="color: #B48EAD;">(</span>org-babel-remove-result <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Remove babel result"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"o"</span> '<span style="color: #B48EAD;">(</span>org-set-property <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Property"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"q"</span> '<span style="color: #B48EAD;">(</span>org-set-tags-command <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Tags"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"a"</span> '<span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">:ignore</span> t <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Attachments"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"aa"</span> '<span style="color: #B48EAD;">(</span>org-attach <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Attach"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"ad"</span> '<span style="color: #B48EAD;">(</span>org-attach-delete-one <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Attach delete one"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"aa"</span> '<span style="color: #B48EAD;">(</span>org-attach-delete-all <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Attach delete all"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"an"</span> '<span style="color: #B48EAD;">(</span>org-attach-new <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Attach new"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"ao"</span> '<span style="color: #B48EAD;">(</span>org-attach-open <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Attach open"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"aR"</span> '<span style="color: #B48EAD;">(</span>org-attach-reveal-in-emacs <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Reveal in emacs"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"au"</span> '<span style="color: #B48EAD;">(</span>org-attach-url <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Attach URL"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"as"</span> '<span style="color: #B48EAD;">(</span>org-download-screenshot <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Screenshot"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"ac"</span> '<span style="color: #B48EAD;">(</span>org-download-clipboard <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Clipboard"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"ar"</span> '<span style="color: #B48EAD;">(</span>org-download-rename-last-file <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Rename last file"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"aR"</span> '<span style="color: #B48EAD;">(</span>org-download-rename-at-point <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Rename at point"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"aP"</span> '<span style="color: #B48EAD;">(</span>org-download-yank <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Yank"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"b"</span> '<span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">:ignore</span> t <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Tables"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"b-"</span> '<span style="color: #B48EAD;">(</span>org-table-insert-hline <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Hline"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"ba"</span> '<span style="color: #B48EAD;">(</span>org-table-align <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"align"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"bb"</span> '<span style="color: #B48EAD;">(</span>org-table-blank-field <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Blank field"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"bc"</span> '<span style="color: #B48EAD;">(</span>org-table-create-or-convert-from-region <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Create or convert"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"be"</span> '<span style="color: #B48EAD;">(</span>org-table-edit-field <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Edit field"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"bf"</span> '<span style="color: #B48EAD;">(</span>org-table-edit-formulas <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Formulas"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"bh"</span> '<span style="color: #B48EAD;">(</span>org-table-field-info <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Info"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"bs"</span> '<span style="color: #B48EAD;">(</span>org-table-sort-lines <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"sort lines"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"br"</span> '<span style="color: #B48EAD;">(</span>org-table-recalculate <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Recalculate"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"bR"</span> '<span style="color: #B48EAD;">(</span>org-table-recalculate-buffer-tables <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Recalculate buffer"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"i"</span> '<span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">:ignore</span> t <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"insert"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"ic"</span> '<span style="color: #B48EAD;">(</span>org-table-insert-column <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Column"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"ih"</span> '<span style="color: #B48EAD;">(</span>org-table-insert-hline <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Hline"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"ir"</span> '<span style="color: #B48EAD;">(</span>org-table-insert-row <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Row"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"iH"</span> '<span style="color: #B48EAD;">(</span>org-table-hline-and-move <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Hline and move"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"c"</span> '<span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">:ignore</span> t <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Clock"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"cc"</span> '<span style="color: #B48EAD;">(</span>org-clock-cancel <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Cancel"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"ce"</span> '<span style="color: #B48EAD;">(</span>org-clock-modify-effort-estimate <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Modify effort"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"cE"</span> '<span style="color: #B48EAD;">(</span>org-set-effort <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Set effort"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"cg"</span> '<span style="color: #B48EAD;">(</span>org-clock-goto <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Goto clock"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"cl"</span> '<span style="color: #B48EAD;">(</span>+org/toggle-last-clock <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Toggle last clock"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"ci"</span> '<span style="color: #B48EAD;">(</span>org-clock-in <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Clock in"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"cI"</span> '<span style="color: #B48EAD;">(</span>org-clock-in-last <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Clock last in"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"co"</span> '<span style="color: #B48EAD;">(</span>org-clock-out <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Clock out"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"cr"</span> '<span style="color: #B48EAD;">(</span>org-resolve-clocks <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Resolve"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"cR"</span> '<span style="color: #B48EAD;">(</span>org-clock-report <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Report"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"ct"</span> '<span style="color: #B48EAD;">(</span>org-evaluate-time-range <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Time range"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"c="</span> '<span style="color: #B48EAD;">(</span>org-clock-timestamps-up <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Timestamps up"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"c-"</span> '<span style="color: #B48EAD;">(</span>org-clock-timestamps-down <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Timestamps down"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"d"</span> '<span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">:ignore</span> t <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Date/Deadline"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"dd"</span> '<span style="color: #B48EAD;">(</span>org-deadline <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Deadline"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"ds"</span> '<span style="color: #B48EAD;">(</span>org-schedule <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Schedule"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"dt"</span> '<span style="color: #B48EAD;">(</span>org-time-stamp <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Time stamp"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"dT"</span> '<span style="color: #B48EAD;">(</span>org-time-stamp-inactive <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Time stamp inactive"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"g"</span> '<span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">:ignore</span> t <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Goto"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"gg"</span> '<span style="color: #B48EAD;">(</span>consult-org-agenda <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Agenda"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"gc"</span> '<span style="color: #B48EAD;">(</span>org-clock-goto <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Clock"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"gi"</span> '<span style="color: #B48EAD;">(</span>org-id-goto <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"ID"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"gr"</span> '<span style="color: #B48EAD;">(</span>org-refile-goto-last-stored <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Refile last"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"gx"</span> '<span style="color: #B48EAD;">(</span>org-capture-goto-last-stored <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Capture last"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

</pre>
</div>
</div>
</div>
<div id="outline-container-org5022eb2" class="outline-3">
<h3 id="org5022eb2"><span class="section-number-3">9.16.</span> Powerful org</h3>
<div class="outline-text-3" id="text-9-16">
</div>
<div id="outline-container-org4aa214d" class="outline-4">
<h4 id="org4aa214d"><span class="section-number-4">9.16.1.</span> TOC</h4>
<div class="outline-text-4" id="text-9-16-1">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'org-mode-hook 'toc-org-mode<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org2e851be" class="outline-4">
<h4 id="org2e851be"><span class="section-number-4">9.16.2.</span> Superstar</h4>
<div class="outline-text-4" id="text-9-16-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'org-mode-hook 'org-superstar-mode<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org121ac0d" class="outline-4">
<h4 id="org121ac0d"><span class="section-number-4">9.16.3.</span> Download</h4>
<div class="outline-text-4" id="text-9-16-3">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-download-image-dir <span style="color: #B48EAD;">(</span>expand-file-name <span style="color: #A3BE8C;">"pictures"</span> my-galaxy<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-download-screenshot-method 'screencapture<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-download-abbreviate-filename-function 'expand-file-name<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-download-timestamp <span style="color: #A3BE8C;">"%Y%m%d%H%M%S"</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-download-display-inline-images nil<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-download-heading-lvl nil<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-download-annotate-function <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">lambda</span> <span style="color: #A3BE8C;">(</span>_link<span style="color: #A3BE8C;">)</span> <span style="color: #78808f;">""</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-download-image-attr-list '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"#+NAME: fig: "</span> <span style="color: #A3BE8C;">"#+CAPTION: "</span> <span style="color: #A3BE8C;">"#+ATTR_ORG: :width 500px"</span> <span style="color: #A3BE8C;">"#+ATTR_LATEX: :width 10cm :placement [!htpb]"</span> <span style="color: #A3BE8C;">"#+ATTR_HTML: :width 600px"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-download-screenshot-basename <span style="color: #A3BE8C;">".png"</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'org-mode-hook 'org-download-enable<span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">let</span> <span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">(</span>map global-map<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>define-key map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"C-c o d c"</span><span style="color: #A3BE8C;">)</span> 'org-download-clipboard<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>define-key map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"C-c o d i"</span><span style="color: #A3BE8C;">)</span> 'org-download-image<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>define-key map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"C-c o d r"</span><span style="color: #A3BE8C;">)</span> 'org-download-rename-last-file<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>define-key map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"C-c o d s"</span><span style="color: #A3BE8C;">)</span> 'org-download-screenshot<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org998944d" class="outline-4">
<h4 id="org998944d"><span class="section-number-4">9.16.4.</span> Pomodoro</h4>
<div class="outline-text-4" id="text-9-16-4">
<p>
使用系统通知显示 org-pomodoro 的提示。
设置 <code>org-pomodoro-start-sound-p</code> 等进行声音的播放。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #6f7787;">;; </span><span style="color: #6f7787;">https://gist.github.com/jstewart/7664823</span>
<span style="color: #6f7787;">;; </span><span style="color: #6f7787;">Needs terminal-notifier (brew install terminal-notifier)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">notify-osx</span> <span style="color: #B48EAD;">(</span>title message<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>call-process <span style="color: #A3BE8C;">"terminal-notifier"</span>
nil 0 nil
<span style="color: #A3BE8C;">"-group"</span> <span style="color: #A3BE8C;">"Emacs"</span>
<span style="color: #A3BE8C;">"-title"</span> title
<span style="color: #A3BE8C;">"-sender"</span> <span style="color: #A3BE8C;">"org.gnu.Emacs"</span>
<span style="color: #A3BE8C;">"-message"</span> message<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #6f7787;">;; </span><span style="color: #6f7787;">org-pomodoro mode hooks</span>
<span style="color: #81A1C1;">(</span>add-hook 'org-pomodoro-finished-hook
          <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">lambda</span> <span style="color: #A3BE8C;">()</span>
          <span style="color: #A3BE8C;">(</span>notify-osx <span style="color: #A3BE8C;">"Pomodoro completed!"</span> <span style="color: #A3BE8C;">"Time for a break."</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'org-pomodoro-break-finished-hook
          <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">lambda</span> <span style="color: #A3BE8C;">()</span>
          <span style="color: #A3BE8C;">(</span>notify-osx <span style="color: #A3BE8C;">"Pomodoro Short Break Finished"</span> <span style="color: #A3BE8C;">"Ready for Another?"</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'org-pomodoro-long-break-finished-hook
          <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">lambda</span> <span style="color: #A3BE8C;">()</span>
            <span style="color: #A3BE8C;">(</span>notify-osx <span style="color: #A3BE8C;">"Pomodoro Long Break Finished"</span> <span style="color: #A3BE8C;">"Ready for Another?"</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'org-pomodoro-killed-hook
          <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">lambda</span> <span style="color: #A3BE8C;">()</span>
          <span style="color: #A3BE8C;">(</span>notify-osx <span style="color: #A3BE8C;">"Pomodoro Killed"</span> <span style="color: #A3BE8C;">"One does not simply kill a pomodoro!"</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf2a7430" class="outline-4">
<h4 id="orgf2a7430"><span class="section-number-4">9.16.5.</span> Drill</h4>
<div class="outline-text-4" id="text-9-16-5">
<p>
这个<a href="https://www.youtube.com/watch?v=uraPXeLfWcM">视频</a>展示的 org-capute 自动从字典获取中英文的意义挺不错的。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-drill-add-random-noise-to-intervals-p t<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgc7589dd" class="outline-4">
<h4 id="orgc7589dd"><span class="section-number-4">9.16.6.</span> Appear</h4>
<div class="outline-text-4" id="text-9-16-6">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-appear-trigger 'manual<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-appear-autolinks t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'org-mode-hook 'org-appear-mode<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'evil
  <span style="color: #B48EAD;">(</span>add-hook 'org-mode-hook <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">lambda</span> <span style="color: #5D80AE;">()</span>
                             <span style="color: #5D80AE;">(</span>add-hook 'evil-insert-state-entry-hook
                                       #'org-appear-manual-start
                                       nil
                                       t<span style="color: #5D80AE;">)</span>
                             <span style="color: #5D80AE;">(</span>add-hook 'evil-insert-state-exit-hook
                                       #'org-appear-manual-stop
                                       nil
                                       t<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org752b35b" class="outline-4">
<h4 id="org752b35b"><span class="section-number-4">9.16.7.</span> Present</h4>
<div class="outline-text-4" id="text-9-16-7">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'org-present-mode-hook <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">lambda</span> <span style="color: #A3BE8C;">()</span>
                                   <span style="color: #A3BE8C;">(</span>org-present-big<span style="color: #A3BE8C;">)</span>
                                   <span style="color: #A3BE8C;">(</span>org-display-inline-images<span style="color: #A3BE8C;">)</span>
                                   <span style="color: #A3BE8C;">(</span>org-present-hide-cursor<span style="color: #A3BE8C;">)</span>
                                   <span style="color: #A3BE8C;">(</span>org-present-read-only<span style="color: #A3BE8C;">)</span>
                                   <span style="color: #A3BE8C;">(</span>global-tab-line-mode 0<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'org-present-mode-quit-hook <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">lambda</span> <span style="color: #A3BE8C;">()</span>
                                        <span style="color: #A3BE8C;">(</span>org-present-small<span style="color: #A3BE8C;">)</span>
                                        <span style="color: #A3BE8C;">(</span>org-remove-inline-images<span style="color: #A3BE8C;">)</span>
                                        <span style="color: #A3BE8C;">(</span>org-present-show-cursor<span style="color: #A3BE8C;">)</span>
                                        <span style="color: #A3BE8C;">(</span>org-present-read-write<span style="color: #A3BE8C;">)</span>
                                        <span style="color: #A3BE8C;">(</span>global-tab-line-mode 1<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org5c212ac" class="outline-4">
<h4 id="org5c212ac"><span class="section-number-4">9.16.8.</span> Math preview</h4>
<div class="outline-text-4" id="text-9-16-8">
<p>
The full list of macros and environments with their packages is available <a href="http://docs.mathjax.org/en/latest/input/tex/macros/index.html#environments">here</a>. 把相应的环境加入到 <code>math-preveiw-tex-default-packages</code> 即可。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> math-preview-scale 1.1<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> math-preview-raise 0.3<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> math-preview-margin '<span style="color: #B48EAD;">(</span>1 . 0<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/local-leader-def</span>
  <span style="color: #81A1C1;">:states</span> 'normal
  <span style="color: #81A1C1;">:keymaps</span> 'org-mode-map
  <span style="color: #A3BE8C;">"p"</span> '<span style="color: #B48EAD;">(</span>math-preview-all <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Math preview"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"P"</span> '<span style="color: #B48EAD;">(</span>math-preview-clear-all <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Math preview all"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org6c50be2" class="outline-4">
<h4 id="org6c50be2"><span class="section-number-4">9.16.9.</span> ZEN</h4>
<div class="outline-text-4" id="text-9-16-9">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
  <span style="color: #A3BE8C;">"tz"</span> '<span style="color: #B48EAD;">(</span>writeroom-mode <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Zen mode"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-org8f5a329" class="outline-2">
<h2 id="org8f5a329"><span class="section-number-2">10.</span> USEFUL EMACS EQUIPPED WITH SCRIPTS</h2>
<div class="outline-text-2" id="text-10">
</div>
<div id="outline-container-orgcc528c3" class="outline-3">
<h3 id="orgcc528c3"><span class="section-number-3">10.1.</span> Open with Safari</h3>
<div class="outline-text-3" id="text-10-1">
<p>
<del>有些时候需要使用外部应用打开相应的文件，比如打印文件的时候。目前还没有发现直接使用 Emacs 打印文件的方法。</del> 看 <a href="#org28a988d">11.1.6</a> 。
这里是使用 safari 打开相应的文件，如需要使用其他的应用，可以参照<a href="http://xahlee.info/emacs/emacs/emacs_dired_open_file_in_ext_apps.html">博客</a>。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">xah-html-open-in-safari</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #78808f;">"Open the current file or `</span><span style="color: #81A1C1;">dired</span><span style="color: #78808f;">' marked files in Mac's Safari browser.</span>
<span style="color: #78808f;">If the file is not saved, save it first.</span>
<span style="color: #78808f;">URL `</span><span style="color: #81A1C1;">http://xahlee.info/emacs/emacs/emacs_dired_open_file_in_ext_apps.html</span><span style="color: #78808f;">'</span>
<span style="color: #78808f;">Version 2018-02-26"</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">let*</span> <span style="color: #A3BE8C;">(</span>
     <span style="color: #5D80AE;">(</span>$file-list
      <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">if</span> <span style="color: #81A1C1;">(</span>string-equal major-mode <span style="color: #A3BE8C;">"dired-mode"</span><span style="color: #81A1C1;">)</span>
      <span style="color: #81A1C1;">(</span>dired-get-marked-files<span style="color: #81A1C1;">)</span>
        <span style="color: #81A1C1;">(</span>list <span style="color: #B48EAD;">(</span>buffer-file-name<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
     <span style="color: #5D80AE;">(</span>$do-it-p <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">if</span> <span style="color: #81A1C1;">(</span>&lt;= <span style="color: #B48EAD;">(</span>length $file-list<span style="color: #B48EAD;">)</span> 5<span style="color: #81A1C1;">)</span>
           t
             <span style="color: #81A1C1;">(</span>y-or-n-p <span style="color: #A3BE8C;">"Open more than 5 files? "</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">when</span> $do-it-p
  <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">cond</span>
   <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">(</span>string-equal system-type <span style="color: #A3BE8C;">"darwin"</span><span style="color: #81A1C1;">)</span>
    <span style="color: #81A1C1;">(</span>mapc
     <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">lambda</span> <span style="color: #A3BE8C;">(</span>$fpath<span style="color: #A3BE8C;">)</span>
       <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">when</span> <span style="color: #5D80AE;">(</span>buffer-modified-p <span style="color: #5D80AE;">)</span>
         <span style="color: #5D80AE;">(</span>save-buffer<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
       <span style="color: #A3BE8C;">(</span>shell-command
        <span style="color: #5D80AE;">(</span>format <span style="color: #A3BE8C;">"open -a Safari.app \"%s\""</span> $fpath<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
     $file-list<span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c f s"</span><span style="color: #B48EAD;">)</span> 'xah-html-open-in-safari<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
  <span style="color: #A3BE8C;">"o"</span> '<span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">:ignore</span> t <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Open"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"os"</span> '<span style="color: #B48EAD;">(</span>xah-html-open-in-safari <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Safari"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org16d1574" class="outline-3">
<h3 id="org16d1574"><span class="section-number-3">10.2.</span> Grab link</h3>
<div class="outline-text-3" id="text-10-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">my/link-safari</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>grab-mac-link-dwim 'safari<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c L"</span><span style="color: #B48EAD;">)</span> <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">lambda</span> <span style="color: #A3BE8C;">()</span> <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #A3BE8C;">)</span> <span style="color: #A3BE8C;">(</span>grab-mac-link-dwim 'safari<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
  <span style="color: #A3BE8C;">"nl"</span> '<span style="color: #B48EAD;">(</span>my/link-safari <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Grab safari link"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orge74c35c" class="outline-3">
<h3 id="orge74c35c"><span class="section-number-3">10.3.</span> Open in desktop</h3>
<div class="outline-text-3" id="text-10-3">
<p>
在文件管理器中打开对应的文件。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">xah-show-in-desktop</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #78808f;">"Show current file in desktop.   (Mac Finder, File Explorer, Linux file manager)</span>
<span style="color: #78808f;">This command can be called when in a file buffer or in `</span><span style="color: #81A1C1;">dired</span><span style="color: #78808f;">'.</span>
<span style="color: #78808f;">URL `</span><span style="color: #81A1C1;">http://xahlee.info/emacs/emacs/emacs_dired_open_file_in_ext_apps.html</span><span style="color: #78808f;">'</span>
<span style="color: #78808f;">Version 2020-11-20 2021-01-18"</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">let</span> <span style="color: #A3BE8C;">(</span><span style="color: #5D80AE;">(</span>$path <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">if</span> <span style="color: #81A1C1;">(</span>buffer-file-name<span style="color: #81A1C1;">)</span> <span style="color: #81A1C1;">(</span>buffer-file-name<span style="color: #81A1C1;">)</span> default-directory<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">cond</span>
     <span style="color: #5D80AE;">(</span><span style="color: #8FBCBB;">(</span>string-equal system-type <span style="color: #A3BE8C;">"windows-nt"</span><span style="color: #8FBCBB;">)</span>
  <span style="color: #8FBCBB;">(</span>shell-command <span style="color: #81A1C1;">(</span>format <span style="color: #A3BE8C;">"PowerShell -Command Start-Process Explorer -FilePath %s"</span> <span style="color: #B48EAD;">(</span>shell-quote-argument default-directory<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
  <span style="color: #6f7787;">;; </span><span style="color: #6f7787;">todo. need to make window highlight the file</span>
  <span style="color: #5D80AE;">)</span>
     <span style="color: #5D80AE;">(</span><span style="color: #8FBCBB;">(</span>string-equal system-type <span style="color: #A3BE8C;">"darwin"</span><span style="color: #8FBCBB;">)</span>
  <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">if</span> <span style="color: #81A1C1;">(</span>eq major-mode 'dired-mode<span style="color: #81A1C1;">)</span>
      <span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">let</span> <span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">(</span>$files <span style="color: #5D80AE;">(</span>dired-get-marked-files <span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
        <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">if</span> <span style="color: #A3BE8C;">(</span>eq <span style="color: #5D80AE;">(</span>length $files<span style="color: #5D80AE;">)</span> 0<span style="color: #A3BE8C;">)</span>
        <span style="color: #A3BE8C;">(</span>shell-command <span style="color: #5D80AE;">(</span>concat <span style="color: #A3BE8C;">"open "</span> <span style="color: #81A1C1;">(</span>shell-quote-argument <span style="color: #B48EAD;">(</span>expand-file-name default-directory <span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
      <span style="color: #A3BE8C;">(</span>shell-command <span style="color: #5D80AE;">(</span>concat <span style="color: #A3BE8C;">"open -R "</span> <span style="color: #81A1C1;">(</span>shell-quote-argument <span style="color: #B48EAD;">(</span>car <span style="color: #A3BE8C;">(</span>dired-get-marked-files <span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
    <span style="color: #81A1C1;">(</span>shell-command
     <span style="color: #B48EAD;">(</span>concat <span style="color: #A3BE8C;">"open -R "</span> <span style="color: #A3BE8C;">(</span>shell-quote-argument $path<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
     <span style="color: #5D80AE;">(</span><span style="color: #8FBCBB;">(</span>string-equal system-type <span style="color: #A3BE8C;">"gnu/linux"</span><span style="color: #8FBCBB;">)</span>
  <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">let</span> <span style="color: #81A1C1;">(</span>
        <span style="color: #B48EAD;">(</span>process-connection-type nil<span style="color: #B48EAD;">)</span>
        <span style="color: #B48EAD;">(</span>openFileProgram <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">if</span> <span style="color: #5D80AE;">(</span>file-exists-p <span style="color: #A3BE8C;">"/usr/bin/gvfs-open"</span><span style="color: #5D80AE;">)</span>
                 <span style="color: #A3BE8C;">"/usr/bin/gvfs-open"</span>
               <span style="color: #A3BE8C;">"/usr/bin/xdg-open"</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
    <span style="color: #81A1C1;">(</span>start-process <span style="color: #A3BE8C;">""</span> nil openFileProgram <span style="color: #B48EAD;">(</span>shell-quote-argument $path<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
  <span style="color: #6f7787;">;; </span><span style="color: #6f7787;">(shell-command "xdg-open .") ;; 2013-02-10 this sometimes froze emacs till the folder is closed. eg with nautilus</span>
  <span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'dired
  <span style="color: #B48EAD;">(</span>define-key dired-mode-map <span style="color: #A3BE8C;">","</span> #'xah-show-in-desktop<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c f d"</span><span style="color: #B48EAD;">)</span> 'xah-show-in-desktop<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
  <span style="color: #A3BE8C;">"of"</span> '<span style="color: #B48EAD;">(</span>xah-show-in-desktop <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Finder"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org748f3ba" class="outline-3">
<h3 id="org748f3ba"><span class="section-number-3">10.4.</span> Writing perfect sentences</h3>
<div class="outline-text-3" id="text-10-4">
<p>
下面的来自 <a href="https://chrismaiorana.com/perfect-sentence">Can Emacs Help You Write The Perfect Sentence</a> 。可以在另一个 buffer 中对句子进行修改，有点用处。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">sentin/break</span> <span style="color: #B48EAD;">()</span>
<span style="color: #78808f;">"Break a sentence out and work it in a new buffer."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>backward-sentence<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>kill-sentence<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>switch-to-buffer-other-window <span style="color: #A3BE8C;">"*sent-breakt*"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>erase-buffer<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>yank<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">sentin/choose</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #78808f;">"Choose a sentence and go back to the other window."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>backward-sentence<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>kill-sentence<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>other-window 1<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>kill-buffer <span style="color: #A3BE8C;">"*sent-breakt*"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>yank<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>delete-other-windows<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">[</span>?\M-s ?j<span style="color: #B48EAD;">]</span> 'sentin/break<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">[</span>?\M-s ?k<span style="color: #B48EAD;">]</span> 'sentin/choose<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgef4fa6c" class="outline-3">
<h3 id="orgef4fa6c"><span class="section-number-3">10.5.</span> switch-to-buffer</h3>
<div class="outline-text-3" id="text-10-5">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">switch-to-message</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #78808f;">"Quick switch to `</span><span style="color: #81A1C1;">*Message*</span><span style="color: #78808f;">' buffer."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>switch-to-buffer <span style="color: #A3BE8C;">"*Messages*"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">switch-to-scratch</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #78808f;">"Quick switch to `</span><span style="color: #81A1C1;">*Scratch*</span><span style="color: #78808f;">' buffer."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>switch-to-buffer <span style="color: #A3BE8C;">"*scratch*"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c w m"</span><span style="color: #B48EAD;">)</span> #'switch-to-message<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c w s"</span><span style="color: #B48EAD;">)</span> #'switch-to-scratch<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
  <span style="color: #A3BE8C;">"bs"</span> '<span style="color: #B48EAD;">(</span>switch-to-scratch <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Scratch"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"bm"</span> '<span style="color: #B48EAD;">(</span>switch-to-message <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Message"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb6b4c5b" class="outline-3">
<h3 id="orgb6b4c5b"><span class="section-number-3">10.6.</span> Scroll other window</h3>
<div class="outline-text-3" id="text-10-6">
<p>
这个在并排使用两个 buffer 的时候很好用，通过 <code>M-n</code> 和 <code>M-p</code> 移动另一个 buffer 中的内容。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">my/scroll-other-windown-down</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #78808f;">"Scroll other window down."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>scroll-other-window-down 2<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">my/scroll-other-windown</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #78808f;">"Scroll other window up."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>scroll-other-window 2<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"M-n"</span><span style="color: #B48EAD;">)</span> 'my/scroll-other-windown<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"M-p"</span><span style="color: #B48EAD;">)</span> 'my/scroll-other-windown-down<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org73773d9" class="outline-3">
<h3 id="org73773d9"><span class="section-number-3">10.7.</span> Inbox file</h3>
<div class="outline-text-3" id="text-10-7">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">my/inbox-file</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>find-file <span style="color: #A3BE8C;">(</span>expand-file-name <span style="color: #A3BE8C;">"inbox/inbox.org"</span> my-galaxy<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c o i"</span><span style="color: #B48EAD;">)</span> #'my/inbox-file<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
  <span style="color: #A3BE8C;">"oi"</span> '<span style="color: #B48EAD;">(</span>my/inbox-file <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Inbox file"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgc737d78" class="outline-3">
<h3 id="orgc737d78"><span class="section-number-3">10.8.</span> Copy id to clipboard</h3>
<div class="outline-text-3" id="text-10-8">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">my/copy-idlink-to-journal</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #78808f;">"Copy idlink to clipboard."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">when</span> <span style="color: #A3BE8C;">(</span>eq major-mode 'org-agenda-mode<span style="color: #A3BE8C;">)</span> <span style="color: #6f7787;">;</span><span style="color: #6f7787;">switch to orgmode</span>
    <span style="color: #A3BE8C;">(</span>org-agenda-show<span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span>org-agenda-goto<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">when</span> <span style="color: #A3BE8C;">(</span>eq major-mode 'org-mode<span style="color: #A3BE8C;">)</span> <span style="color: #6f7787;">; </span><span style="color: #6f7787;">do this only in org-mode buffers</span>
    <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">let*</span> <span style="color: #5D80AE;">(</span><span style="color: #8FBCBB;">(</span>mytmphead <span style="color: #81A1C1;">(</span>nth 4 <span style="color: #B48EAD;">(</span>org-heading-components<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
           <span style="color: #8FBCBB;">(</span>mytmpid <span style="color: #81A1C1;">(</span>funcall 'org-id-get-create<span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
           <span style="color: #8FBCBB;">(</span>mytmplink <span style="color: #81A1C1;">(</span>format <span style="color: #A3BE8C;">"- [ ] [[id:%s][%s]]"</span> mytmpid mytmphead<span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
      <span style="color: #5D80AE;">(</span>kill-new mytmplink<span style="color: #5D80AE;">)</span>
      <span style="color: #5D80AE;">(</span>message <span style="color: #A3BE8C;">"Copied %s to killring (clipboard)"</span> mytmplink<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>find-file <span style="color: #A3BE8C;">(</span>expand-file-name <span style="color: #5D80AE;">(</span>format-time-string <span style="color: #A3BE8C;">"journals/%Y-%m-%d.org"</span><span style="color: #5D80AE;">)</span> my-galaxy<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>goto-char <span style="color: #A3BE8C;">(</span>org-find-exact-headline-in-buffer <span style="color: #A3BE8C;">"GTD"</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>org-end-of-line<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>org-return<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>org-yank<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"&lt;f8&gt;"</span><span style="color: #B48EAD;">)</span> 'my/copy-idlink-to-journal<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb743d84" class="outline-3">
<h3 id="orgb743d84"><span class="section-number-3">10.9.</span> Punch in and punch out</h3>
<div class="outline-text-3" id="text-10-9">
<p>
Some useful function borrowed from <a href="http://doc.norang.ca/org-mode.html#Clocking">Org Mode - Organize Your Life In Plain Text!</a>
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">bh/is-task-p</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #78808f;">"Any task with a todo keyword and no subtask"</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">save-restriction</span>
    <span style="color: #A3BE8C;">(</span>widen<span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">let</span> <span style="color: #5D80AE;">(</span><span style="color: #8FBCBB;">(</span>has-subtask<span style="color: #8FBCBB;">)</span>
      <span style="color: #8FBCBB;">(</span>subtree-end <span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">save-excursion</span> <span style="color: #B48EAD;">(</span>org-end-of-subtree t<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
      <span style="color: #8FBCBB;">(</span>is-a-task <span style="color: #81A1C1;">(</span>member <span style="color: #B48EAD;">(</span>nth 2 <span style="color: #A3BE8C;">(</span>org-heading-components<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span> org-todo-keywords-1<span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
  <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">save-excursion</span>
    <span style="color: #8FBCBB;">(</span>forward-line 1<span style="color: #8FBCBB;">)</span>
    <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">while</span> <span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">and</span> <span style="color: #B48EAD;">(</span>not has-subtask<span style="color: #B48EAD;">)</span>
            <span style="color: #B48EAD;">(</span>&lt; <span style="color: #A3BE8C;">(</span>point<span style="color: #A3BE8C;">)</span> subtree-end<span style="color: #B48EAD;">)</span>
            <span style="color: #B48EAD;">(</span>re-search-forward <span style="color: #A3BE8C;">"^</span><span style="color: #EBCB8B;">\</span><span style="color: #A3BE8C;">*+ "</span> subtree-end t<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
      <span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">when</span> <span style="color: #B48EAD;">(</span>member <span style="color: #A3BE8C;">(</span>org-get-todo-state<span style="color: #A3BE8C;">)</span> org-todo-keywords-1<span style="color: #B48EAD;">)</span>
        <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">setq</span> has-subtask t<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
  <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">and</span> is-a-task <span style="color: #8FBCBB;">(</span>not has-subtask<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">bh/is-project-p</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #78808f;">"Any task with a todo keyword subtask"</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">save-restriction</span>
    <span style="color: #A3BE8C;">(</span>widen<span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">let</span> <span style="color: #5D80AE;">(</span><span style="color: #8FBCBB;">(</span>has-subtask<span style="color: #8FBCBB;">)</span>
      <span style="color: #8FBCBB;">(</span>subtree-end <span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">save-excursion</span> <span style="color: #B48EAD;">(</span>org-end-of-subtree t<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
      <span style="color: #8FBCBB;">(</span>is-a-task <span style="color: #81A1C1;">(</span>member <span style="color: #B48EAD;">(</span>nth 2 <span style="color: #A3BE8C;">(</span>org-heading-components<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span> org-todo-keywords-1<span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
  <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">save-excursion</span>
    <span style="color: #8FBCBB;">(</span>forward-line 1<span style="color: #8FBCBB;">)</span>
    <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">while</span> <span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">and</span> <span style="color: #B48EAD;">(</span>not has-subtask<span style="color: #B48EAD;">)</span>
            <span style="color: #B48EAD;">(</span>&lt; <span style="color: #A3BE8C;">(</span>point<span style="color: #A3BE8C;">)</span> subtree-end<span style="color: #B48EAD;">)</span>
            <span style="color: #B48EAD;">(</span>re-search-forward <span style="color: #A3BE8C;">"^</span><span style="color: #EBCB8B;">\</span><span style="color: #A3BE8C;">*+ "</span> subtree-end t<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
      <span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">when</span> <span style="color: #B48EAD;">(</span>member <span style="color: #A3BE8C;">(</span>org-get-todo-state<span style="color: #A3BE8C;">)</span> org-todo-keywords-1<span style="color: #B48EAD;">)</span>
        <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">setq</span> has-subtask t<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
  <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">and</span> is-a-task has-subtask<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">bh/find-project-task</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #78808f;">"Move point to the parent (project) task if any"</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">save-restriction</span>
    <span style="color: #A3BE8C;">(</span>widen<span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">let</span> <span style="color: #5D80AE;">(</span><span style="color: #8FBCBB;">(</span>parent-task <span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">save-excursion</span> <span style="color: #B48EAD;">(</span>org-back-to-heading 'invisible-ok<span style="color: #B48EAD;">)</span> <span style="color: #B48EAD;">(</span>point<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
  <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">while</span> <span style="color: #8FBCBB;">(</span>org-up-heading-safe<span style="color: #8FBCBB;">)</span>
    <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">when</span> <span style="color: #81A1C1;">(</span>member <span style="color: #B48EAD;">(</span>nth 2 <span style="color: #A3BE8C;">(</span>org-heading-components<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span> org-todo-keywords-1<span style="color: #81A1C1;">)</span>
      <span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> parent-task <span style="color: #B48EAD;">(</span>point<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
  <span style="color: #5D80AE;">(</span>goto-char parent-task<span style="color: #5D80AE;">)</span>
  parent-task<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">bh/is-project-subtree-p</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #78808f;">"Any task with a todo keyword that is in a project subtree.</span>
<span style="color: #78808f;">  Callers of this function already widen the buffer view."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">let</span> <span style="color: #A3BE8C;">(</span><span style="color: #5D80AE;">(</span>task <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">save-excursion</span> <span style="color: #81A1C1;">(</span>org-back-to-heading 'invisible-ok<span style="color: #81A1C1;">)</span>
              <span style="color: #81A1C1;">(</span>point<span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">save-excursion</span>
  <span style="color: #5D80AE;">(</span>bh/find-project-task<span style="color: #5D80AE;">)</span>
  <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">if</span> <span style="color: #8FBCBB;">(</span>equal <span style="color: #81A1C1;">(</span>point<span style="color: #81A1C1;">)</span> task<span style="color: #8FBCBB;">)</span>
      nil
    t<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">bh/clock-in-to-next</span> <span style="color: #B48EAD;">(</span>kw<span style="color: #B48EAD;">)</span>
  <span style="color: #78808f;">"Switch a task from TODO to NEXT when clocking in.</span>
<span style="color: #78808f;">    Skips capture tasks, projects, and subprojects.</span>
<span style="color: #78808f;">    Switch projects and subprojects from NEXT back to TODO"</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">when</span> <span style="color: #A3BE8C;">(</span>not <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">and</span> <span style="color: #8FBCBB;">(</span>boundp 'org-capture-mode<span style="color: #8FBCBB;">)</span> org-capture-mode<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">cond</span>
     <span style="color: #5D80AE;">(</span><span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">and</span> <span style="color: #81A1C1;">(</span>member <span style="color: #B48EAD;">(</span>org-get-todo-state<span style="color: #B48EAD;">)</span> <span style="color: #B48EAD;">(</span>list <span style="color: #A3BE8C;">"TODO"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
       <span style="color: #81A1C1;">(</span>bh/is-task-p<span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
  <span style="color: #A3BE8C;">"NEXT"</span><span style="color: #5D80AE;">)</span>
     <span style="color: #5D80AE;">(</span><span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">and</span> <span style="color: #81A1C1;">(</span>member <span style="color: #B48EAD;">(</span>org-get-todo-state<span style="color: #B48EAD;">)</span> <span style="color: #B48EAD;">(</span>list <span style="color: #A3BE8C;">"NEXT"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
       <span style="color: #81A1C1;">(</span>bh/is-project-p<span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
  <span style="color: #A3BE8C;">"TODO"</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">bh/punch-in</span> <span style="color: #B48EAD;">(</span>arg<span style="color: #B48EAD;">)</span>
  <span style="color: #78808f;">"Start continuous clocking and set the default task to the</span>
<span style="color: #78808f;">  selected task.  If no task is selected set the Organization task</span>
<span style="color: #78808f;">  as the default task."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span> <span style="color: #A3BE8C;">"p"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">setq</span> bh/keep-clock-running t<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">if</span> <span style="color: #A3BE8C;">(</span>equal major-mode 'org-agenda-mode<span style="color: #A3BE8C;">)</span>
  <span style="color: #6f7787;">;;</span>
  <span style="color: #6f7787;">;; </span><span style="color: #6f7787;">We're in the agenda</span>
  <span style="color: #6f7787;">;;</span>
  <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">let*</span> <span style="color: #5D80AE;">(</span><span style="color: #8FBCBB;">(</span>marker <span style="color: #81A1C1;">(</span>org-get-at-bol 'org-hd-marker<span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
         <span style="color: #8FBCBB;">(</span>tags <span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">org-with-point-at</span> marker <span style="color: #B48EAD;">(</span>org-get-tags<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
    <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">if</span> <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">and</span> <span style="color: #81A1C1;">(</span>eq arg 4<span style="color: #81A1C1;">)</span> tags<span style="color: #8FBCBB;">)</span>
        <span style="color: #8FBCBB;">(</span>org-agenda-clock-in '<span style="color: #81A1C1;">(</span>16<span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
      <span style="color: #8FBCBB;">(</span>bh/clock-in-default-task-as-default<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
    <span style="color: #6f7787;">;;</span>
    <span style="color: #6f7787;">;; </span><span style="color: #6f7787;">We are not in the agenda</span>
    <span style="color: #6f7787;">;;</span>
    <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">save-restriction</span>
  <span style="color: #5D80AE;">(</span>widen<span style="color: #5D80AE;">)</span>
                    <span style="color: #6f7787;">; </span><span style="color: #6f7787;">Find the tags on the current task</span>
  <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">if</span> <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">and</span> <span style="color: #81A1C1;">(</span>equal major-mode 'org-mode<span style="color: #81A1C1;">)</span> <span style="color: #81A1C1;">(</span>not <span style="color: #B48EAD;">(</span>org-before-first-heading-p<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span> <span style="color: #81A1C1;">(</span>eq arg 4<span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
      <span style="color: #8FBCBB;">(</span>org-clock-in '<span style="color: #81A1C1;">(</span>16<span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
    <span style="color: #8FBCBB;">(</span>bh/clock-in-default-task-as-default<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">bh/punch-out</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">setq</span> bh/keep-clock-running nil<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">when</span> <span style="color: #A3BE8C;">(</span>org-clock-is-active<span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span>org-clock-out<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>org-agenda-remove-restriction-lock<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">bh/clock-in-default-task</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">save-excursion</span>
    <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">org-with-point-at</span> org-clock-default-task
  <span style="color: #5D80AE;">(</span>org-clock-in<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">bh/clock-in-parent-task</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #78808f;">"Move point to the parent (project) task if any and clock in"</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">let</span> <span style="color: #A3BE8C;">(</span><span style="color: #5D80AE;">(</span>parent-task<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">save-excursion</span>
  <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">save-restriction</span>
    <span style="color: #8FBCBB;">(</span>widen<span style="color: #8FBCBB;">)</span>
    <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">while</span> <span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">and</span> <span style="color: #B48EAD;">(</span>not parent-task<span style="color: #B48EAD;">)</span> <span style="color: #B48EAD;">(</span>org-up-heading-safe<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
      <span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">when</span> <span style="color: #B48EAD;">(</span>member <span style="color: #A3BE8C;">(</span>nth 2 <span style="color: #5D80AE;">(</span>org-heading-components<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span> org-todo-keywords-1<span style="color: #B48EAD;">)</span>
        <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">setq</span> parent-task <span style="color: #A3BE8C;">(</span>point<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
    <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">if</span> parent-task
        <span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">org-with-point-at</span> parent-task
      <span style="color: #B48EAD;">(</span>org-clock-in<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
      <span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">when</span> bh/keep-clock-running
        <span style="color: #B48EAD;">(</span>bh/clock-in-default-task<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defvar</span> <span style="color: #D8DEE9;">bh/default-task-id</span> <span style="color: #A3BE8C;">"20220524T114723.420565"</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">bh/clock-in-default-task-as-default</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">org-with-point-at</span> <span style="color: #A3BE8C;">(</span>org-id-find bh/default-task-id 'marker<span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span>org-clock-in '<span style="color: #5D80AE;">(</span>16<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">bh/clock-out-maybe</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">when</span> <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">and</span> bh/keep-clock-running
         <span style="color: #5D80AE;">(</span>not org-clock-clocking-in<span style="color: #5D80AE;">)</span>
         <span style="color: #5D80AE;">(</span>marker-buffer org-clock-default-task<span style="color: #5D80AE;">)</span>
         <span style="color: #5D80AE;">(</span>not org-clock-resolving-clocks-due-to-idleness<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span>bh/clock-in-parent-task<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'org-clock-out-hook 'bh/clock-out-maybe 'append<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">bh/clock-in-last-task</span> <span style="color: #B48EAD;">(</span>arg<span style="color: #B48EAD;">)</span>
  <span style="color: #78808f;">"Clock in the interrupted task if there is one</span>
<span style="color: #78808f;">  Skip the default task and get the next one.</span>
<span style="color: #78808f;">  A prefix arg forces clock in of the default task."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span> <span style="color: #A3BE8C;">"p"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">let</span> <span style="color: #A3BE8C;">(</span><span style="color: #5D80AE;">(</span>clock-in-to-task
     <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">cond</span>
      <span style="color: #81A1C1;">(</span><span style="color: #B48EAD;">(</span>eq arg 4<span style="color: #B48EAD;">)</span> org-clock-default-task<span style="color: #81A1C1;">)</span>
      <span style="color: #81A1C1;">(</span><span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">and</span> <span style="color: #A3BE8C;">(</span>org-clock-is-active<span style="color: #A3BE8C;">)</span>
        <span style="color: #A3BE8C;">(</span>equal org-clock-default-task <span style="color: #5D80AE;">(</span>cadr org-clock-history<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
       <span style="color: #B48EAD;">(</span>caddr org-clock-history<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
      <span style="color: #81A1C1;">(</span><span style="color: #B48EAD;">(</span>org-clock-is-active<span style="color: #B48EAD;">)</span> <span style="color: #B48EAD;">(</span>cadr org-clock-history<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
      <span style="color: #81A1C1;">(</span><span style="color: #B48EAD;">(</span>equal org-clock-default-task <span style="color: #A3BE8C;">(</span>car org-clock-history<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span> <span style="color: #B48EAD;">(</span>cadr org-clock-history<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
      <span style="color: #81A1C1;">(</span>t <span style="color: #B48EAD;">(</span>car org-clock-history<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span>widen<span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">org-with-point-at</span> clock-in-to-task
  <span style="color: #5D80AE;">(</span>org-clock-in nil<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"&lt;f12&gt;"</span><span style="color: #B48EAD;">)</span> 'bh/punch-in<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"s-&lt;f12&gt;"</span><span style="color: #B48EAD;">)</span> 'bh/punch-out<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgecf2339" class="outline-3">
<h3 id="orgecf2339"><span class="section-number-3">10.10.</span> Quick dired to folder</h3>
<div class="outline-text-3" id="text-10-10">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">my/dired-blog</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #78808f;">"Dired to Blog folder."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>dired <span style="color: #A3BE8C;">"~/blog/"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">my/dired-downloads</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #78808f;">"Dired to Downloads folder."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>dired <span style="color: #A3BE8C;">"~/Downloads/"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">my/dired-documents</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #78808f;">"Dired to Documents folder."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>dired <span style="color: #A3BE8C;">"~/Documents/"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">my/dired-Nextcloud</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #78808f;">"Dired to Nextcloud folder."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>dired <span style="color: #A3BE8C;">"~/Nextcloud/"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">my/dired-journals</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #78808f;">"Dired to Journals folder."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>dired <span style="color: #A3BE8C;">(</span>expand-file-name <span style="color: #A3BE8C;">"journals"</span> my-galaxy<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">my/dired-emacs-directory</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #78808f;">"Dired to Emacs directory."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>dired <span style="color: #A3BE8C;">"~/.emacs.d/"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">my/dired-emacs-lisp</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #78808f;">"Dired to Emacs configuration folder."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>dired <span style="color: #A3BE8C;">"~/.emacs.d/lisp"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">let</span> <span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">(</span>map global-map<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>define-key map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"C-c d b"</span><span style="color: #A3BE8C;">)</span> #'my/dired-blog<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>define-key map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"C-c d d"</span><span style="color: #A3BE8C;">)</span> #'my/dired-downloads<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>define-key map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"C-c d D"</span><span style="color: #A3BE8C;">)</span> #'my/dired-documents<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>define-key map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"C-c d n"</span><span style="color: #A3BE8C;">)</span> #'my/dired-Nextcloud<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>define-key map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"C-c d e"</span><span style="color: #A3BE8C;">)</span> #'my/dired-emacs-directory<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>define-key map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"C-c d l"</span><span style="color: #A3BE8C;">)</span> #'my/dired-emacs-lisp<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>define-key map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"C-c d j"</span><span style="color: #A3BE8C;">)</span> #'my/dired-journals<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
  <span style="color: #A3BE8C;">"d"</span> '<span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">:ignore</span> t <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Dired"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"dd"</span> '<span style="color: #B48EAD;">(</span>my/dired-downloads <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Downloads"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"dD"</span> '<span style="color: #B48EAD;">(</span>my/dired-documents <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Documents"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"dn"</span> '<span style="color: #B48EAD;">(</span>my/dired-Nextcloud <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Nextcloud"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"de"</span> '<span style="color: #B48EAD;">(</span>my/dired-emacs-directory <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Emacs directory"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgbceb80a" class="outline-3">
<h3 id="orgbceb80a"><span class="section-number-3">10.11.</span> Show files by date in SOME Emacs dired buffer</h3>
<div class="outline-text-3" id="text-10-11">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defvar</span> <span style="color: #D8DEE9;">my-dired-new-file-first-dirs</span>
  '<span style="color: #B48EAD;">(</span>
    <span style="color: #A3BE8C;">"documents?/$"</span>
    <span style="color: #A3BE8C;">"downloads?/$"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #78808f;">"Dired directory patterns where newest files are on the top."</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">my-dired-mode-hook-setup</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #78808f;">"Set up Dired."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">when</span> <span style="color: #A3BE8C;">(</span>cl-find-if <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">lambda</span> <span style="color: #8FBCBB;">(</span>regexp<span style="color: #8FBCBB;">)</span>
                      <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">let</span> <span style="color: #81A1C1;">(</span><span style="color: #B48EAD;">(</span>case-fold-search t<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
                        <span style="color: #81A1C1;">(</span>string-match regexp default-directory<span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
                my-dired-new-file-first-dirs<span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">setq</span> dired-actual-switches <span style="color: #A3BE8C;">"-lat"</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'dired-mode-hook 'my-dired-mode-hook-setup<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgd05996d" class="outline-3">
<h3 id="orgd05996d"><span class="section-number-3">10.12.</span> Finance file</h3>
<div class="outline-text-3" id="text-10-12">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">my/finance-file</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>find-file <span style="color: #A3BE8C;">(</span>expand-file-name <span style="color: #A3BE8C;">"finance/finance.ledger"</span> my-galaxy<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
  <span style="color: #A3BE8C;">"ol"</span> '<span style="color: #B48EAD;">(</span>my/finance-file <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Ledger file"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org70bab8b" class="outline-3">
<h3 id="org70bab8b"><span class="section-number-3">10.13.</span> Org toggle last clock</h3>
<div class="outline-text-3" id="text-10-13">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #6f7787;">;; </span><span style="color: #6f7787;">https://github.com/doomemacs/doomemacs/blob/d156e58577eca632cf31153958fab6ea57bd52fc/modules/lang/org/autoload/org.el</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">+org/toggle-last-clock</span> <span style="color: #B48EAD;">(</span>arg<span style="color: #B48EAD;">)</span>
  <span style="color: #78808f;">"Toggles last clocked item.</span>
<span style="color: #78808f;">Clock out if an active clock is running (or cancel it if prefix ARG is non-nil).</span>
<span style="color: #78808f;">If no clock is active, then clock into the last item. See `</span><span style="color: #81A1C1;">org-clock-in-last</span><span style="color: #78808f;">' to</span>
<span style="color: #78808f;">see how ARG affects this command."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span> <span style="color: #A3BE8C;">"P"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">require</span> '<span style="color: #81A1C1;">org-clock</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">cond</span> <span style="color: #A3BE8C;">(</span><span style="color: #5D80AE;">(</span>org-clocking-p<span style="color: #5D80AE;">)</span>
         <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">if</span> arg
             <span style="color: #8FBCBB;">(</span>org-clock-cancel<span style="color: #8FBCBB;">)</span>
           <span style="color: #8FBCBB;">(</span>org-clock-out<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
        <span style="color: #A3BE8C;">(</span><span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">and</span> <span style="color: #8FBCBB;">(</span>null org-clock-history<span style="color: #8FBCBB;">)</span>
              <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">or</span> <span style="color: #81A1C1;">(</span>org-on-heading-p<span style="color: #81A1C1;">)</span>
                  <span style="color: #81A1C1;">(</span>org-at-item-p<span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
              <span style="color: #8FBCBB;">(</span>y-or-n-p <span style="color: #A3BE8C;">"No active clock. Clock in on current item?"</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
         <span style="color: #5D80AE;">(</span>org-clock-in<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
        <span style="color: #A3BE8C;">(</span><span style="color: #5D80AE;">(</span>org-clock-in-last arg<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org969bde6" class="outline-2">
<h2 id="org969bde6"><span class="section-number-2">11.</span> EMACS CAN DO MORE, APPLICATIONS</h2>
<div class="outline-text-2" id="text-11">
</div>
<div id="outline-container-orgb96fc37" class="outline-3">
<h3 id="orgb96fc37"><span class="section-number-3">11.1.</span> PDF Reader</h3>
<div class="outline-text-3" id="text-11-1">
</div>
<div id="outline-container-orgc5e5302" class="outline-4">
<h4 id="orgc5e5302"><span class="section-number-4">11.1.1.</span> pdf tools</h4>
<div class="outline-text-4" id="text-11-1-1">
<p>
如果不想高亮文件后打开标注，可以将 <code>pdf-annot-activate-created-annotations</code> 设置为 <code>nil</code> 。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'after-init-hook 'pdf-tools-install<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'pdf-tools-enabled-hook #'<span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">lambda</span> <span style="color: #A3BE8C;">()</span>
                                      <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">if</span> <span style="color: #5D80AE;">(</span>string-equal <span style="color: #A3BE8C;">"dark"</span> <span style="color: #8FBCBB;">(</span>frame-parameter nil 'background-mode<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
                                          <span style="color: #5D80AE;">(</span>pdf-view-themed-minor-mode 1<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orge0e0c6d" class="outline-4">
<h4 id="orge0e0c6d"><span class="section-number-4">11.1.2.</span> pdf-view</h4>
<div class="outline-text-4" id="text-11-1-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> pdf-view-use-unicode-ligther nil<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> pdf-view-use-scaling t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> pdf-view-use-imagemagick nil<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> pdf-annot-activate-created-annotations nil<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">my/get-file-name</span> <span style="color: #B48EAD;">()</span>
    <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
    <span style="color: #B48EAD;">(</span>kill-new <span style="color: #A3BE8C;">(</span>file-name-base <span style="color: #5D80AE;">(</span>buffer-file-name<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
    <span style="color: #B48EAD;">(</span>message <span style="color: #A3BE8C;">"Copied %s"</span> <span style="color: #A3BE8C;">(</span>file-name-base <span style="color: #5D80AE;">(</span>buffer-file-name<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'pdf-view
    <span style="color: #B48EAD;">(</span>define-key pdf-view-mode-map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"w"</span><span style="color: #A3BE8C;">)</span> 'my/get-file-name<span style="color: #B48EAD;">)</span>
    <span style="color: #B48EAD;">(</span>define-key pdf-view-mode-map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"h"</span><span style="color: #A3BE8C;">)</span> 'pdf-annot-add-highlight-markup-annotation<span style="color: #B48EAD;">)</span>
    <span style="color: #B48EAD;">(</span>define-key pdf-view-mode-map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"t"</span><span style="color: #A3BE8C;">)</span> 'pdf-annot-add-text-annotation<span style="color: #B48EAD;">)</span>
    <span style="color: #B48EAD;">(</span>define-key pdf-view-mode-map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"d"</span><span style="color: #A3BE8C;">)</span> 'pdf-annot-delete<span style="color: #B48EAD;">)</span>
    <span style="color: #B48EAD;">(</span>define-key pdf-view-mode-map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"q"</span><span style="color: #A3BE8C;">)</span> 'kill-this-buffer<span style="color: #B48EAD;">)</span>
    <span style="color: #B48EAD;">(</span>define-key pdf-view-mode-map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"y"</span><span style="color: #A3BE8C;">)</span> 'pdf-view-kill-ring-save<span style="color: #B48EAD;">)</span>
    <span style="color: #B48EAD;">(</span>define-key pdf-view-mode-map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"G"</span><span style="color: #A3BE8C;">)</span> 'pdf-view-goto-page<span style="color: #B48EAD;">)</span>
    <span style="color: #B48EAD;">(</span>define-key pdf-view-mode-map <span style="color: #A3BE8C;">[</span>remap pdf-misc-print-document<span style="color: #A3BE8C;">]</span> 'mrb/pdf-misc-print-pages<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org127c410" class="outline-4">
<h4 id="org127c410"><span class="section-number-4">11.1.3.</span> pdf-outline</h4>
<div class="outline-text-4" id="text-11-1-3">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'pdf-outline
  <span style="color: #B48EAD;">(</span>define-key pdf-outline-buffer-mode-map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"&lt;RET&gt;"</span><span style="color: #A3BE8C;">)</span> 'pdf-outline-follow-link-and-quit<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org348a4aa" class="outline-4">
<h4 id="org348a4aa"><span class="section-number-4">11.1.4.</span> pdf-annot</h4>
<div class="outline-text-4" id="text-11-1-4">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'pdf-annot
  <span style="color: #B48EAD;">(</span>define-key pdf-annot-edit-contents-minor-mode-map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"&lt;return&gt;"</span><span style="color: #A3BE8C;">)</span> 'pdf-annot-edit-contents-commit<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>define-key pdf-annot-edit-contents-minor-mode-map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"&lt;S-return&gt;"</span><span style="color: #A3BE8C;">)</span> 'newline<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<p>
Create pdf annotations file. 基于 consult-bibtex 这个包实现的。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">my/edit-notes</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #78808f;">"Edit reference note base pdf name."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">if</span> <span style="color: #A3BE8C;">(</span>equal <span style="color: #5D80AE;">(</span>file-name-extension <span style="color: #8FBCBB;">(</span>buffer-name<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span> <span style="color: #A3BE8C;">"pdf"</span><span style="color: #A3BE8C;">)</span>
      <span style="color: #A3BE8C;">(</span>consult-bibtex-edit-notes <span style="color: #5D80AE;">(</span>file-name-sans-extension <span style="color: #8FBCBB;">(</span>buffer-name<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span>consult-bibtex-edit-notes <span style="color: #5D80AE;">(</span>consult-bibtex--read-entry<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c b n"</span><span style="color: #B48EAD;">)</span> 'my/edit-notes<span style="color: #81A1C1;">)</span>
</pre>
</div>
<p>
Extract pdf annotations with <a href="https://github.com/0xabu/pdfannots">pdfannots</a>. 这边的实现还有些问题，回头重新优化下。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">my/org-delete-heading-content</span> <span style="color: #B48EAD;">(</span>heading<span style="color: #B48EAD;">)</span>
  <span style="color: #78808f;">"Delete content of specific HEADING"</span>
  <span style="color: #B48EAD;">(</span>org-map-entries
   <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">lambda</span> <span style="color: #5D80AE;">()</span>
     <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">let</span> <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">(</span>name <span style="color: #B48EAD;">(</span>nth 4 <span style="color: #A3BE8C;">(</span>org-heading-components<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
   <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">if</span> <span style="color: #81A1C1;">(</span>string= name heading<span style="color: #81A1C1;">)</span>
       <span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">save-restriction</span>
         <span style="color: #B48EAD;">(</span>org-mark-subtree<span style="color: #B48EAD;">)</span>
         <span style="color: #B48EAD;">(</span>forward-line<span style="color: #B48EAD;">)</span>
         <span style="color: #B48EAD;">(</span>delete-region <span style="color: #A3BE8C;">(</span>region-beginning<span style="color: #A3BE8C;">)</span> <span style="color: #A3BE8C;">(</span>region-end<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">my/extract-pdf-annots-to-ref-note</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">let</span> <span style="color: #A3BE8C;">(</span>annots<span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">setf</span> annots <span style="color: #5D80AE;">(</span>shell-command-to-string <span style="color: #8FBCBB;">(</span>format <span style="color: #A3BE8C;">"pdfannots.py %s"</span> <span style="color: #81A1C1;">(</span>find-file <span style="color: #B48EAD;">(</span>buffer-name<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span>consult-bibtex-edit-notes <span style="color: #5D80AE;">(</span>file-name-sans-extension <span style="color: #8FBCBB;">(</span>buffer-name<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span>my/org-delete-heading-content <span style="color: #A3BE8C;">"Research Contribution"</span><span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span>goto-char <span style="color: #5D80AE;">(</span>org-find-exact-headline-in-buffer <span style="color: #A3BE8C;">"Research Contribution"</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span>forward-line<span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">dolist</span> <span style="color: #5D80AE;">(</span>item <span style="color: #8FBCBB;">(</span>split-string annots <span style="color: #A3BE8C;">"\n"</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
  <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">if</span> <span style="color: #8FBCBB;">(</span>string-prefix-p <span style="color: #A3BE8C;">"   &gt;"</span> item<span style="color: #8FBCBB;">)</span>
      <span style="color: #8FBCBB;">(</span>princ <span style="color: #81A1C1;">(</span>concat <span style="color: #B48EAD;">(</span>replace-regexp-in-string <span style="color: #A3BE8C;">"   &gt;"</span> <span style="color: #A3BE8C;">"+"</span> item<span style="color: #B48EAD;">)</span> <span style="color: #A3BE8C;">"\n"</span><span style="color: #81A1C1;">)</span>
         <span style="color: #81A1C1;">(</span>current-buffer<span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c b x"</span><span style="color: #B48EAD;">)</span> 'my/extract-pdf-annots-to-ref-note<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgab35731" class="outline-4">
<h4 id="orgab35731"><span class="section-number-4">11.1.5.</span> pdf-cache</h4>
<div class="outline-text-4" id="text-11-1-5">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'pdf-cache
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">define-pdf-cache-function</span> pagelabels<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org28a988d" class="outline-4">
<h4 id="org28a988d"><span class="section-number-4">11.1.6.</span> pdf print</h4>
<div class="outline-text-4" id="text-11-1-6">
<p>
可以通过命令行使用打印机，不再需要用外部软件打开再去打印文件，而且可以选择打印的页数。来自 <a href="https://qua.name/mrb/an-org-babel-based-emacs-configuration#orgbf8348e">Marcel van der Boom</a> 的配置文件。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> pdf-misc-print-program-executable <span style="color: #A3BE8C;">"/usr/bin/lp"</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">mrb/pdf-misc-print-pages</span><span style="color: #B48EAD;">(</span>filename pages <span style="color: #8FBCBB;">&amp;optional</span> interactive-p<span style="color: #B48EAD;">)</span>
    <span style="color: #78808f;">"Wrapper for `pdf-misc-print-document` to add page selection support"</span>
    <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span> <span style="color: #A3BE8C;">(</span>list <span style="color: #5D80AE;">(</span>pdf-view-buffer-file-name<span style="color: #5D80AE;">)</span>
           <span style="color: #5D80AE;">(</span>read-string <span style="color: #A3BE8C;">"Page range (empty for all pages): "</span>
                    <span style="color: #8FBCBB;">(</span>number-to-string <span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">pdf-view-current-page</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
           t<span style="color: #A3BE8C;">)</span> <span style="color: #EBCB8B;">pdf-view-mode</span><span style="color: #B48EAD;">)</span>
    <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">let</span> <span style="color: #A3BE8C;">(</span><span style="color: #5D80AE;">(</span>pdf-misc-print-program-args
       <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">if</span> <span style="color: #81A1C1;">(</span>not <span style="color: #B48EAD;">(</span>string-blank-p pages<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
       <span style="color: #81A1C1;">(</span>cons <span style="color: #B48EAD;">(</span>concat <span style="color: #A3BE8C;">"-P "</span> pages<span style="color: #B48EAD;">)</span> pdf-misc-print-program-args<span style="color: #81A1C1;">)</span>
         pdf-misc-print-program-args<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
  <span style="color: #A3BE8C;">(</span>pdf-misc-print-document filename<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb41c2a9" class="outline-4">
<h4 id="orgb41c2a9"><span class="section-number-4">11.1.7.</span> pdf password</h4>
<div class="outline-text-4" id="text-11-1-7">
<p>
需要安装 qpdf ，如果使用 Homebrew，可以使用 <code>brew install qpdf</code> &#x2013; <a href="https://xenodium.com/emacs-password-protect-current-pdf/">Emacs: Password-protect current pdf</a>
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">pdf-password-protect</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #78808f;">"Password protect current pdf in buffer or `</span><span style="color: #81A1C1;">dired</span><span style="color: #78808f;">' file."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">unless</span> <span style="color: #A3BE8C;">(</span>executable-find <span style="color: #A3BE8C;">"qpdf"</span><span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span><span style="color: #EBCB8B;">user-error</span> <span style="color: #A3BE8C;">"qpdf not installed"</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">unless</span> <span style="color: #A3BE8C;">(</span>equal <span style="color: #A3BE8C;">"pdf"</span>
         <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">or</span> <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">when</span> <span style="color: #81A1C1;">(</span>buffer-file-name<span style="color: #81A1C1;">)</span>
           <span style="color: #81A1C1;">(</span>downcase <span style="color: #B48EAD;">(</span>file-name-extension <span style="color: #A3BE8C;">(</span>buffer-file-name<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
             <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">when</span> <span style="color: #81A1C1;">(</span>dired-get-filename nil t<span style="color: #81A1C1;">)</span>
           <span style="color: #81A1C1;">(</span>downcase <span style="color: #B48EAD;">(</span>file-name-extension <span style="color: #A3BE8C;">(</span>dired-get-filename nil t<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span><span style="color: #EBCB8B;">user-error</span> <span style="color: #A3BE8C;">"no pdf to act on"</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">let*</span> <span style="color: #A3BE8C;">(</span><span style="color: #5D80AE;">(</span>user-password <span style="color: #8FBCBB;">(</span>read-passwd <span style="color: #A3BE8C;">"user-password: "</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
     <span style="color: #5D80AE;">(</span>owner-password <span style="color: #8FBCBB;">(</span>read-passwd <span style="color: #A3BE8C;">"owner-password: "</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
     <span style="color: #5D80AE;">(</span>input <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">or</span> <span style="color: #81A1C1;">(</span>buffer-file-name<span style="color: #81A1C1;">)</span>
            <span style="color: #81A1C1;">(</span>dired-get-filename nil t<span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
     <span style="color: #5D80AE;">(</span>output <span style="color: #8FBCBB;">(</span>concat <span style="color: #81A1C1;">(</span>file-name-sans-extension input<span style="color: #81A1C1;">)</span>
             <span style="color: #A3BE8C;">"_enc.pdf"</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span>message
     <span style="color: #5D80AE;">(</span>string-trim
  <span style="color: #8FBCBB;">(</span>shell-command-to-string
   <span style="color: #81A1C1;">(</span>format <span style="color: #A3BE8C;">"qpdf --verbose --encrypt %s %s 256 -- %s %s"</span>
       user-password owner-password input output<span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgd76d5dd" class="outline-3">
<h3 id="orgd76d5dd"><span class="section-number-3">11.2.</span> DIRED</h3>
<div class="outline-text-3" id="text-11-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> auto-save-file-name-transforms `<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">".*"</span> ,<span style="color: #5D80AE;">(</span>no-littering-expand-var-file-name <span style="color: #A3BE8C;">"auto-save/"</span><span style="color: #5D80AE;">)</span> t<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> confirm-kill-processes nil<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-to-list 'revert-without-query <span style="color: #A3BE8C;">".+\\.org"</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-to-list 'revert-without-query <span style="color: #A3BE8C;">".+\\.tex"</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-to-list 'revert-without-query <span style="color: #A3BE8C;">".+\\.pdf"</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> dired-recursive-deletes 'always<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> dired-recursive-copies 'always<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> global-auto-revert-non-file-buffers t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> auto-revert-verbose nil<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> dired-dwim-target t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> delete-by-moving-to-trash t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> load-prefer-newer t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> auto-revert-use-notify nil<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> auto-revert-interval 3<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> insert-directory-program <span style="color: #A3BE8C;">"gls"</span> dired-use-ls-dired t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> dired-listing-switches <span style="color: #A3BE8C;">"-al --group-directories-first"</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>put 'dired-find-alternate-file 'disabled nil<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
<div id="outline-container-org5689dee" class="outline-4">
<h4 id="org5689dee"><span class="section-number-4">11.2.1.</span> peep-dired</h4>
<div class="outline-text-4" id="text-11-2-1">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> peep-dired-ignored-extensions '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"mkv"</span> <span style="color: #A3BE8C;">"iso"</span> <span style="color: #A3BE8C;">"mp4"</span> <span style="color: #A3BE8C;">"pdf"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>define-key dired-mode-map <span style="color: #B48EAD;">[</span>remap dired-do-print<span style="color: #B48EAD;">]</span> #'peep-dired<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org71bfd57" class="outline-4">
<h4 id="org71bfd57"><span class="section-number-4">11.2.2.</span> Diredfl</h4>
<div class="outline-text-4" id="text-11-2-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'dired-mode-hook 'diredfl-global-mode<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org895a71d" class="outline-4">
<h4 id="org895a71d"><span class="section-number-4">11.2.3.</span> dired-hide-dotfiles</h4>
<div class="outline-text-4" id="text-11-2-3">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'dired
  <span style="color: #B48EAD;">(</span>define-key dired-mode-map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"s-."</span><span style="color: #A3BE8C;">)</span> #'dired-hide-dotfiles-mode<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'dired-mode-hook 'dired-hide-dotfiles-mode<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org32c7ca1" class="outline-4">
<h4 id="org32c7ca1"><span class="section-number-4">11.2.4.</span> Dired hacks</h4>
<div class="outline-text-4" id="text-11-2-4">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">require</span> '<span style="color: #81A1C1;">dired-rainbow</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">dired-rainbow-define-chmod</span> directory <span style="color: #A3BE8C;">"</span><span style="color: #000000; background-color: #6cb2eb;">#6cb2eb</span><span style="color: #A3BE8C;">"</span> <span style="color: #A3BE8C;">"d.*"</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">dired-rainbow-define</span> html <span style="color: #A3BE8C;">"</span><span style="color: #ffffff; background-color: #eb5286;">#eb5286</span><span style="color: #A3BE8C;">"</span> <span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"css"</span> <span style="color: #A3BE8C;">"less"</span> <span style="color: #A3BE8C;">"sass"</span> <span style="color: #A3BE8C;">"scss"</span> <span style="color: #A3BE8C;">"htm"</span> <span style="color: #A3BE8C;">"html"</span> <span style="color: #A3BE8C;">"jhtm"</span> <span style="color: #A3BE8C;">"mht"</span> <span style="color: #A3BE8C;">"eml"</span> <span style="color: #A3BE8C;">"mustache"</span> <span style="color: #A3BE8C;">"xhtml"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">dired-rainbow-define</span> xml <span style="color: #A3BE8C;">"</span><span style="color: #000000; background-color: #f2d024;">#f2d024</span><span style="color: #A3BE8C;">"</span> <span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"xml"</span> <span style="color: #A3BE8C;">"xsd"</span> <span style="color: #A3BE8C;">"xsl"</span> <span style="color: #A3BE8C;">"xslt"</span> <span style="color: #A3BE8C;">"wsdl"</span> <span style="color: #A3BE8C;">"bib"</span> <span style="color: #A3BE8C;">"json"</span> <span style="color: #A3BE8C;">"msg"</span> <span style="color: #A3BE8C;">"pgn"</span> <span style="color: #A3BE8C;">"rss"</span> <span style="color: #A3BE8C;">"yaml"</span> <span style="color: #A3BE8C;">"yml"</span> <span style="color: #A3BE8C;">"rdata"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">dired-rainbow-define</span> document <span style="color: #A3BE8C;">"</span><span style="color: #ffffff; background-color: #9561e2;">#9561e2</span><span style="color: #A3BE8C;">"</span> <span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"docm"</span> <span style="color: #A3BE8C;">"doc"</span> <span style="color: #A3BE8C;">"docx"</span> <span style="color: #A3BE8C;">"odb"</span> <span style="color: #A3BE8C;">"odt"</span> <span style="color: #A3BE8C;">"pdb"</span> <span style="color: #A3BE8C;">"pdf"</span> <span style="color: #A3BE8C;">"ps"</span> <span style="color: #A3BE8C;">"rtf"</span> <span style="color: #A3BE8C;">"djvu"</span> <span style="color: #A3BE8C;">"epub"</span> <span style="color: #A3BE8C;">"odp"</span> <span style="color: #A3BE8C;">"ppt"</span> <span style="color: #A3BE8C;">"pptx"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">dired-rainbow-define</span> markdown <span style="color: #A3BE8C;">"</span><span style="color: #ffffff; background-color: #ff2d4d;">#ff2d4d</span><span style="color: #A3BE8C;">"</span> <span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"org"</span> <span style="color: #A3BE8C;">"etx"</span> <span style="color: #A3BE8C;">"info"</span> <span style="color: #A3BE8C;">"markdown"</span> <span style="color: #A3BE8C;">"md"</span> <span style="color: #A3BE8C;">"mkd"</span> <span style="color: #A3BE8C;">"nfo"</span> <span style="color: #A3BE8C;">"pod"</span> <span style="color: #A3BE8C;">"rst"</span> <span style="color: #A3BE8C;">"tex"</span> <span style="color: #A3BE8C;">"textfile"</span> <span style="color: #A3BE8C;">"txt"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">dired-rainbow-define</span> database <span style="color: #A3BE8C;">"</span><span style="color: #ffffff; background-color: #6574cd;">#6574cd</span><span style="color: #A3BE8C;">"</span> <span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"xlsx"</span> <span style="color: #A3BE8C;">"xls"</span> <span style="color: #A3BE8C;">"csv"</span> <span style="color: #A3BE8C;">"accdb"</span> <span style="color: #A3BE8C;">"db"</span> <span style="color: #A3BE8C;">"mdb"</span> <span style="color: #A3BE8C;">"sqlite"</span> <span style="color: #A3BE8C;">"nc"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">dired-rainbow-define</span> media <span style="color: #A3BE8C;">"</span><span style="color: #000000; background-color: #de751f;">#de751f</span><span style="color: #A3BE8C;">"</span> <span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"mp3"</span> <span style="color: #A3BE8C;">"mp4"</span> <span style="color: #A3BE8C;">"MP3"</span> <span style="color: #A3BE8C;">"MP4"</span> <span style="color: #A3BE8C;">"avi"</span> <span style="color: #A3BE8C;">"mpeg"</span> <span style="color: #A3BE8C;">"mpg"</span> <span style="color: #A3BE8C;">"flv"</span> <span style="color: #A3BE8C;">"ogg"</span> <span style="color: #A3BE8C;">"mov"</span> <span style="color: #A3BE8C;">"mid"</span> <span style="color: #A3BE8C;">"midi"</span> <span style="color: #A3BE8C;">"wav"</span> <span style="color: #A3BE8C;">"aiff"</span> <span style="color: #A3BE8C;">"flac"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">dired-rainbow-define</span> image <span style="color: #A3BE8C;">"</span><span style="color: #000000; background-color: #f66d9b;">#f66d9b</span><span style="color: #A3BE8C;">"</span> <span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"tiff"</span> <span style="color: #A3BE8C;">"tif"</span> <span style="color: #A3BE8C;">"cdr"</span> <span style="color: #A3BE8C;">"gif"</span> <span style="color: #A3BE8C;">"ico"</span> <span style="color: #A3BE8C;">"jpeg"</span> <span style="color: #A3BE8C;">"jpg"</span> <span style="color: #A3BE8C;">"png"</span> <span style="color: #A3BE8C;">"psd"</span> <span style="color: #A3BE8C;">"eps"</span> <span style="color: #A3BE8C;">"svg"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">dired-rainbow-define</span> log <span style="color: #A3BE8C;">"</span><span style="color: #000000; background-color: #c17d11;">#c17d11</span><span style="color: #A3BE8C;">"</span> <span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"log"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">dired-rainbow-define</span> shell <span style="color: #A3BE8C;">"</span><span style="color: #000000; background-color: #f6993f;">#f6993f</span><span style="color: #A3BE8C;">"</span> <span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"awk"</span> <span style="color: #A3BE8C;">"bash"</span> <span style="color: #A3BE8C;">"bat"</span> <span style="color: #A3BE8C;">"sed"</span> <span style="color: #A3BE8C;">"sh"</span> <span style="color: #A3BE8C;">"zsh"</span> <span style="color: #A3BE8C;">"vim"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">dired-rainbow-define</span> interpreted <span style="color: #A3BE8C;">"</span><span style="color: #000000; background-color: #38c172;">#38c172</span><span style="color: #A3BE8C;">"</span> <span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"py"</span> <span style="color: #A3BE8C;">"ipynb"</span> <span style="color: #A3BE8C;">"rb"</span> <span style="color: #A3BE8C;">"pl"</span> <span style="color: #A3BE8C;">"t"</span> <span style="color: #A3BE8C;">"msql"</span> <span style="color: #A3BE8C;">"mysql"</span> <span style="color: #A3BE8C;">"pgsql"</span> <span style="color: #A3BE8C;">"sql"</span> <span style="color: #A3BE8C;">"r"</span> <span style="color: #A3BE8C;">"clj"</span> <span style="color: #A3BE8C;">"cljs"</span> <span style="color: #A3BE8C;">"scala"</span> <span style="color: #A3BE8C;">"js"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">dired-rainbow-define</span> compiled <span style="color: #A3BE8C;">"</span><span style="color: #000000; background-color: #4dc0b5;">#4dc0b5</span><span style="color: #A3BE8C;">"</span> <span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"asm"</span> <span style="color: #A3BE8C;">"cl"</span> <span style="color: #A3BE8C;">"lisp"</span> <span style="color: #A3BE8C;">"el"</span> <span style="color: #A3BE8C;">"c"</span> <span style="color: #A3BE8C;">"h"</span> <span style="color: #A3BE8C;">"c++"</span> <span style="color: #A3BE8C;">"h++"</span> <span style="color: #A3BE8C;">"hpp"</span> <span style="color: #A3BE8C;">"hxx"</span> <span style="color: #A3BE8C;">"m"</span> <span style="color: #A3BE8C;">"cc"</span> <span style="color: #A3BE8C;">"cs"</span> <span style="color: #A3BE8C;">"cp"</span> <span style="color: #A3BE8C;">"cpp"</span> <span style="color: #A3BE8C;">"go"</span> <span style="color: #A3BE8C;">"f"</span> <span style="color: #A3BE8C;">"for"</span> <span style="color: #A3BE8C;">"ftn"</span> <span style="color: #A3BE8C;">"f90"</span> <span style="color: #A3BE8C;">"f95"</span> <span style="color: #A3BE8C;">"f03"</span> <span style="color: #A3BE8C;">"f08"</span> <span style="color: #A3BE8C;">"s"</span> <span style="color: #A3BE8C;">"rs"</span> <span style="color: #A3BE8C;">"hi"</span> <span style="color: #A3BE8C;">"hs"</span> <span style="color: #A3BE8C;">"pyc"</span> <span style="color: #A3BE8C;">".java"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">dired-rainbow-define</span> executable <span style="color: #A3BE8C;">"</span><span style="color: #000000; background-color: #8cc4ff;">#8cc4ff</span><span style="color: #A3BE8C;">"</span> <span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"exe"</span> <span style="color: #A3BE8C;">"msi"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">dired-rainbow-define</span> compressed <span style="color: #A3BE8C;">"</span><span style="color: #000000; background-color: #51d88a;">#51d88a</span><span style="color: #A3BE8C;">"</span> <span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"7z"</span> <span style="color: #A3BE8C;">"zip"</span> <span style="color: #A3BE8C;">"bz2"</span> <span style="color: #A3BE8C;">"tgz"</span> <span style="color: #A3BE8C;">"txz"</span> <span style="color: #A3BE8C;">"gz"</span> <span style="color: #A3BE8C;">"xz"</span> <span style="color: #A3BE8C;">"z"</span> <span style="color: #A3BE8C;">"Z"</span> <span style="color: #A3BE8C;">"jar"</span> <span style="color: #A3BE8C;">"war"</span> <span style="color: #A3BE8C;">"ear"</span> <span style="color: #A3BE8C;">"rar"</span> <span style="color: #A3BE8C;">"sar"</span> <span style="color: #A3BE8C;">"xpi"</span> <span style="color: #A3BE8C;">"apk"</span> <span style="color: #A3BE8C;">"xz"</span> <span style="color: #A3BE8C;">"tar"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">dired-rainbow-define</span> packaged <span style="color: #A3BE8C;">"</span><span style="color: #000000; background-color: #faad63;">#faad63</span><span style="color: #A3BE8C;">"</span> <span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"deb"</span> <span style="color: #A3BE8C;">"rpm"</span> <span style="color: #A3BE8C;">"apk"</span> <span style="color: #A3BE8C;">"jad"</span> <span style="color: #A3BE8C;">"jar"</span> <span style="color: #A3BE8C;">"cab"</span> <span style="color: #A3BE8C;">"pak"</span> <span style="color: #A3BE8C;">"pk3"</span> <span style="color: #A3BE8C;">"vdf"</span> <span style="color: #A3BE8C;">"vpk"</span> <span style="color: #A3BE8C;">"bsp"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">dired-rainbow-define</span> encrypted <span style="color: #A3BE8C;">"</span><span style="color: #000000; background-color: #ffed4a;">#ffed4a</span><span style="color: #A3BE8C;">"</span> <span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"gpg"</span> <span style="color: #A3BE8C;">"pgp"</span> <span style="color: #A3BE8C;">"asc"</span> <span style="color: #A3BE8C;">"bfe"</span> <span style="color: #A3BE8C;">"enc"</span> <span style="color: #A3BE8C;">"signature"</span> <span style="color: #A3BE8C;">"sig"</span> <span style="color: #A3BE8C;">"p12"</span> <span style="color: #A3BE8C;">"pem"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">dired-rainbow-define</span> fonts <span style="color: #A3BE8C;">"</span><span style="color: #000000; background-color: #6cb2eb;">#6cb2eb</span><span style="color: #A3BE8C;">"</span> <span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"afm"</span> <span style="color: #A3BE8C;">"fon"</span> <span style="color: #A3BE8C;">"fnt"</span> <span style="color: #A3BE8C;">"pfb"</span> <span style="color: #A3BE8C;">"pfm"</span> <span style="color: #A3BE8C;">"ttf"</span> <span style="color: #A3BE8C;">"otf"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">dired-rainbow-define</span> partition <span style="color: #A3BE8C;">"</span><span style="color: #ffffff; background-color: #e3342f;">#e3342f</span><span style="color: #A3BE8C;">"</span> <span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"dmg"</span> <span style="color: #A3BE8C;">"iso"</span> <span style="color: #A3BE8C;">"bin"</span> <span style="color: #A3BE8C;">"nrg"</span> <span style="color: #A3BE8C;">"qcow"</span> <span style="color: #A3BE8C;">"toast"</span> <span style="color: #A3BE8C;">"vcd"</span> <span style="color: #A3BE8C;">"vmdk"</span> <span style="color: #A3BE8C;">"bak"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">dired-rainbow-define</span> vc <span style="color: #A3BE8C;">"</span><span style="color: #ffffff; background-color: #0074d9;">#0074d9</span><span style="color: #A3BE8C;">"</span> <span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"git"</span> <span style="color: #A3BE8C;">"gitignore"</span> <span style="color: #A3BE8C;">"gitattributes"</span> <span style="color: #A3BE8C;">"gitmodules"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">dired-rainbow-define-chmod</span> executable-unix <span style="color: #A3BE8C;">"</span><span style="color: #000000; background-color: #38c172;">#38c172</span><span style="color: #A3BE8C;">"</span> <span style="color: #A3BE8C;">"-.*x.*"</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org642db6e" class="outline-3">
<h3 id="org642db6e"><span class="section-number-3">11.3.</span> EPUB Reader</h3>
<div class="outline-text-3" id="text-11-3">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> nov-unzip-program <span style="color: #B48EAD;">(</span>executable-find <span style="color: #A3BE8C;">"bsdtar"</span><span style="color: #B48EAD;">)</span>
      nov-unzip-args '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"-xC"</span> directory <span style="color: #A3BE8C;">"-f"</span> filename<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-to-list 'auto-mode-alist '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"\\.epub\\'"</span> . nov-mode<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgfd15b50" class="outline-3">
<h3 id="orgfd15b50"><span class="section-number-3">11.4.</span> Calibredb</h3>
<div class="outline-text-3" id="text-11-4">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> calibredb-root-dir <span style="color: #A3BE8C;">"~/Nextcloud/L.Calibre/"</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> calibredb-db-dir <span style="color: #B48EAD;">(</span>expand-file-name <span style="color: #A3BE8C;">"metadata.db"</span> calibredb-root-dir<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> calibredb-size-show t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> calibredb-format-character-icons t<span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> calibredb-ref-default-bibliography <span style="color: #B48EAD;">(</span>expand-file-name <span style="color: #A3BE8C;">"calibre.bib"</span> calibredb-root-dir<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'evil
  <span style="color: #B48EAD;">(</span>evil-set-initial-state 'calibredb-search-mode 'emacs<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"&lt;f1&gt;"</span><span style="color: #B48EAD;">)</span> #'calibredb<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
  <span style="color: #A3BE8C;">"L"</span> '<span style="color: #B48EAD;">(</span>calibredb <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Library"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orga531f9f" class="outline-3">
<h3 id="orga531f9f"><span class="section-number-3">11.5.</span> Vterm</h3>
<div class="outline-text-3" id="text-11-5">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> vterm-kill-buffer-on-exit t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> vterm-max-scrollback 5000<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
  <span style="color: #A3BE8C;">"tv"</span> '<span style="color: #B48EAD;">(</span>vterm <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Vterm"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgeb170bd" class="outline-3">
<h3 id="orgeb170bd"><span class="section-number-3">11.6.</span> Versioning</h3>
<div class="outline-text-3" id="text-11-6">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
  <span style="color: #A3BE8C;">"v"</span> '<span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">:ignore</span> t <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Version"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"v/"</span> '<span style="color: #B48EAD;">(</span>magit-dispatch <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Magit dispatch"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"v."</span> '<span style="color: #B48EAD;">(</span>magit-file-dispatch <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Magit file dispatch"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"vg"</span> '<span style="color: #B48EAD;">(</span>magit-status <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Magit status"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"vG"</span> '<span style="color: #B48EAD;">(</span>magit-status-here <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Magit status here"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org18c4c19" class="outline-3">
<h3 id="org18c4c19"><span class="section-number-3">11.7.</span> Note taking</h3>
<div class="outline-text-3" id="text-11-7">
</div>
<div id="outline-container-orge7d0d7d" class="outline-4">
<h4 id="orge7d0d7d"><span class="section-number-4">11.7.1.</span> Roam</h4>
<div class="outline-text-4" id="text-11-7-1">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'org-roam
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">cl-defmethod</span> <span style="color: #88C0D0;">org-roam-node-type</span> <span style="color: #A3BE8C;">(</span><span style="color: #5D80AE;">(</span>node org-roam-node<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
    <span style="color: #78808f;">"Return the TYPE of NODE."</span>
    <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">condition-case</span> nil
        <span style="color: #5D80AE;">(</span>file-name-nondirectory
         <span style="color: #8FBCBB;">(</span>directory-file-name
          <span style="color: #81A1C1;">(</span>file-name-directory
           <span style="color: #B48EAD;">(</span>file-relative-name <span style="color: #A3BE8C;">(</span>org-roam-node-file node<span style="color: #A3BE8C;">)</span> org-roam-directory<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
      <span style="color: #5D80AE;">(</span><span style="color: #EBCB8B;">error</span> <span style="color: #A3BE8C;">""</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>

  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">cl-defmethod</span> <span style="color: #88C0D0;">org-roam-node-directories</span> <span style="color: #A3BE8C;">(</span><span style="color: #5D80AE;">(</span>node org-roam-node<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">if-let</span> <span style="color: #5D80AE;">(</span><span style="color: #8FBCBB;">(</span>dirs <span style="color: #81A1C1;">(</span>file-name-directory <span style="color: #B48EAD;">(</span>file-relative-name <span style="color: #A3BE8C;">(</span>org-roam-node-file node<span style="color: #A3BE8C;">)</span> org-roam-directory<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
        <span style="color: #5D80AE;">(</span>format <span style="color: #A3BE8C;">"(%s)"</span> <span style="color: #8FBCBB;">(</span>car <span style="color: #81A1C1;">(</span>split-string dirs <span style="color: #A3BE8C;">"/"</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
      <span style="color: #A3BE8C;">""</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>

  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">cl-defmethod</span> <span style="color: #88C0D0;">org-roam-node-backlinkscount</span> <span style="color: #A3BE8C;">(</span><span style="color: #5D80AE;">(</span>node org-roam-node<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">let*</span> <span style="color: #5D80AE;">(</span><span style="color: #8FBCBB;">(</span>count <span style="color: #81A1C1;">(</span>caar <span style="color: #B48EAD;">(</span>org-roam-db-query
                         <span style="color: #A3BE8C;">[</span><span style="color: #81A1C1;">:select</span> <span style="color: #5D80AE;">(</span>funcall count source<span style="color: #5D80AE;">)</span>
                                  <span style="color: #81A1C1;">:from</span> links
                                  <span style="color: #81A1C1;">:where</span> <span style="color: #5D80AE;">(</span>= dest $s1<span style="color: #5D80AE;">)</span>
                                  <span style="color: #81A1C1;">:and</span> <span style="color: #5D80AE;">(</span>= type <span style="color: #A3BE8C;">"id"</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">]</span>
                         <span style="color: #A3BE8C;">(</span>org-roam-node-id node<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
      <span style="color: #5D80AE;">(</span>format <span style="color: #A3BE8C;">"[%d]"</span> count<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>

  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">cl-defmethod</span> <span style="color: #88C0D0;">org-roam-node-doom-filetitle</span> <span style="color: #A3BE8C;">(</span><span style="color: #5D80AE;">(</span>node org-roam-node<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
     <span style="color: #78808f;">"Return the value of \"#+title:\" (if any) from file that NODE resides in.</span>
<span style="color: #78808f;"> If there's no file-level title in the file, return empty string."</span>
     <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">or</span> <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">if</span> <span style="color: #8FBCBB;">(</span>= <span style="color: #81A1C1;">(</span>org-roam-node-level node<span style="color: #81A1C1;">)</span> 0<span style="color: #8FBCBB;">)</span>
          <span style="color: #8FBCBB;">(</span>org-roam-node-title node<span style="color: #8FBCBB;">)</span>
        <span style="color: #8FBCBB;">(</span>org-roam-get-keyword <span style="color: #A3BE8C;">"TITLE"</span> <span style="color: #81A1C1;">(</span>org-roam-node-file node<span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
         <span style="color: #A3BE8C;">""</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>

  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">cl-defmethod</span> <span style="color: #88C0D0;">org-roam-node-doom-hierarchy</span> <span style="color: #A3BE8C;">(</span><span style="color: #5D80AE;">(</span>node org-roam-node<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
    <span style="color: #78808f;">"Return hierarchy for NODE, constructed of its file title, OLP and direct title.</span>
<span style="color: #78808f;">   If some elements are missing, they will be stripped out."</span>
    <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">let</span> <span style="color: #5D80AE;">(</span><span style="color: #8FBCBB;">(</span>title     <span style="color: #81A1C1;">(</span>org-roam-node-title node<span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
          <span style="color: #8FBCBB;">(</span>olp       <span style="color: #81A1C1;">(</span>org-roam-node-olp   node<span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
          <span style="color: #8FBCBB;">(</span>level     <span style="color: #81A1C1;">(</span>org-roam-node-level node<span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
          <span style="color: #8FBCBB;">(</span>filetitle <span style="color: #81A1C1;">(</span>org-roam-node-doom-filetitle node<span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
          <span style="color: #8FBCBB;">(</span>separator <span style="color: #81A1C1;">(</span>propertize <span style="color: #A3BE8C;">" &gt; "</span> 'face 'shadow<span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
      <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">cl-case</span> level
        <span style="color: #6f7787;">;; </span><span style="color: #6f7787;">node is a top-level file</span>
        <span style="color: #8FBCBB;">(</span>0 filetitle<span style="color: #8FBCBB;">)</span>
        <span style="color: #6f7787;">;; </span><span style="color: #6f7787;">node is a level 1 heading</span>
        <span style="color: #8FBCBB;">(</span>1 <span style="color: #81A1C1;">(</span>concat <span style="color: #B48EAD;">(</span>propertize filetitle 'face '<span style="color: #A3BE8C;">(</span>shadow italic<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
                   separator title<span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
        <span style="color: #6f7787;">;; </span><span style="color: #6f7787;">node is a heading with an arbitrary outline path</span>
        <span style="color: #8FBCBB;">(</span>t <span style="color: #81A1C1;">(</span>concat <span style="color: #B48EAD;">(</span>propertize filetitle 'face '<span style="color: #A3BE8C;">(</span>shadow italic<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
                   separator <span style="color: #B48EAD;">(</span>propertize <span style="color: #A3BE8C;">(</span>string-join olp <span style="color: #A3BE8C;">" &gt; "</span><span style="color: #A3BE8C;">)</span> 'face '<span style="color: #A3BE8C;">(</span>shadow italic<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
                   separator title<span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-roam-capture-templates '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"a"</span> <span style="color: #A3BE8C;">"articles"</span> plain <span style="color: #A3BE8C;">"%?"</span>
                      <span style="color: #81A1C1;">:target</span> <span style="color: #5D80AE;">(</span>file+head <span style="color: #A3BE8C;">"articles/${slug}.org"</span>
                             <span style="color: #A3BE8C;">"#+TITLE: ${title}\n#+CREATED: %U\n#+MODIFIED: \n"</span><span style="color: #5D80AE;">)</span>
                      <span style="color: #81A1C1;">:unnarrowed</span> t<span style="color: #A3BE8C;">)</span>
                     <span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"b"</span> <span style="color: #A3BE8C;">"Books"</span> plain <span style="color: #5D80AE;">(</span>file <span style="color: #A3BE8C;">"~/.emacs.d/template/readinglog"</span><span style="color: #5D80AE;">)</span>
                      <span style="color: #81A1C1;">:target</span> <span style="color: #5D80AE;">(</span>file+head <span style="color: #A3BE8C;">"books/${slug}.org"</span>
                             <span style="color: #A3BE8C;">"#+TITLE: ${title}\n#+CREATED: %U\n#+MODIFIED: \n"</span><span style="color: #5D80AE;">)</span>
                      <span style="color: #81A1C1;">:unnarrowed</span> t<span style="color: #A3BE8C;">)</span>
                     <span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"d"</span> <span style="color: #A3BE8C;">"Diary"</span> plain <span style="color: #A3BE8C;">"%?"</span>
                      <span style="color: #81A1C1;">:target</span> <span style="color: #5D80AE;">(</span>file+datetree <span style="color: #A3BE8C;">"daily/&lt;%Y-%m&gt;.org"</span> day<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
                     <span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"m"</span> <span style="color: #A3BE8C;">"main"</span> plain <span style="color: #A3BE8C;">"%?"</span>
                      <span style="color: #81A1C1;">:target</span> <span style="color: #5D80AE;">(</span>file+head <span style="color: #A3BE8C;">"main/${slug}.org"</span>
                             <span style="color: #A3BE8C;">"#+TITLE: ${title}\n#+CREATED: %U\n#+MODIFIED: \n"</span><span style="color: #5D80AE;">)</span>
                      <span style="color: #81A1C1;">:unnarrowed</span> t<span style="color: #A3BE8C;">)</span>
                     <span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"p"</span> <span style="color: #A3BE8C;">"people"</span> plain <span style="color: #5D80AE;">(</span>file <span style="color: #A3BE8C;">"~/.emacs.d/template/crm"</span><span style="color: #5D80AE;">)</span>
                      <span style="color: #81A1C1;">:target</span> <span style="color: #5D80AE;">(</span>file+head <span style="color: #A3BE8C;">"crm/${slug}.org"</span>
                             <span style="color: #A3BE8C;">"#+TITLE: ${title}\n#+CREATED: %U\n#+MODIFIED: \n"</span><span style="color: #5D80AE;">)</span>
                      <span style="color: #81A1C1;">:unnarrowed</span> t<span style="color: #A3BE8C;">)</span>
                     <span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"r"</span> <span style="color: #A3BE8C;">"reference"</span> plain <span style="color: #5D80AE;">(</span>file <span style="color: #A3BE8C;">"~/.emacs.d/template/reference"</span><span style="color: #5D80AE;">)</span>
                      <span style="color: #81A1C1;">:target</span> <span style="color: #5D80AE;">(</span>file+head <span style="color: #A3BE8C;">"ref/${citekey}.org"</span>
                             <span style="color: #A3BE8C;">"#+TITLE: ${title}\n#+CREATED: %U\n#+MODIFIED: \n"</span><span style="color: #5D80AE;">)</span>
                      <span style="color: #81A1C1;">:unnarrowed</span> t<span style="color: #A3BE8C;">)</span>
                     <span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"w"</span> <span style="color: #A3BE8C;">"work"</span> plain <span style="color: #A3BE8C;">"%?"</span>
                      <span style="color: #81A1C1;">:target</span> <span style="color: #5D80AE;">(</span>file+head <span style="color: #A3BE8C;">"work/${slug}.org"</span>
                             <span style="color: #A3BE8C;">"#+TITLE: ${title}\n#+CREATED: %U\n#+MODIFIED: \n"</span><span style="color: #5D80AE;">)</span>
                      <span style="color: #81A1C1;">:unnarrowed</span> t<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-roam-db-gc-threshold most-positive-fixnum<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-roam-directory <span style="color: #B48EAD;">(</span>file-truename <span style="color: #A3BE8C;">(</span>expand-file-name <span style="color: #A3BE8C;">"roam"</span> my-galaxy<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-roam-node-display-template <span style="color: #B48EAD;">(</span>concat <span style="color: #A3BE8C;">"${type:8} ${backlinkscount:3} ${doom-hierarchy:*}"</span> <span style="color: #A3BE8C;">(</span>propertize <span style="color: #A3BE8C;">"${tags:20}"</span> 'face 'org-tag<span style="color: #A3BE8C;">)</span> <span style="color: #A3BE8C;">" "</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'org-roam-mode-hook 'turn-on-visual-line-mode<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'org-mode-hook <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">lambda</span> <span style="color: #A3BE8C;">()</span>
                           <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">setq-local</span> time-stamp-active t
                                       time-stamp-start <span style="color: #A3BE8C;">"#\\+MODIFIED:[ \t]*"</span>
                                       time-stamp-end <span style="color: #A3BE8C;">"$"</span>
                                       time-stamp-format <span style="color: #A3BE8C;">"</span><span style="color: #EBCB8B;">\</span><span style="color: #A3BE8C;">[%Y-%m-%d %3a %H:%M</span><span style="color: #EBCB8B;">\</span><span style="color: #A3BE8C;">]"</span><span style="color: #A3BE8C;">)</span>
                           <span style="color: #A3BE8C;">(</span>add-hook 'before-save-hook 'time-stamp nil 'local<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'after-init-hook 'org-roam-db-autosync-enable<span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">bms/org-roam-rg-search</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #78808f;">"Search org-roam directory using consult-ripgrep. With live-preview."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">let</span> <span style="color: #A3BE8C;">(</span><span style="color: #5D80AE;">(</span>consult-ripgrep-command
         <span style="color: #A3BE8C;">"rg --null --ignore-case --type org --line-buffered --color=always --max-columns=500 --no-heading --line-number . -e ARG OPTS"</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span>consult-ripgrep org-roam-directory<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span>add-to-list 'display-buffer-alist
             '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"\\*org-roam\\*"</span>
               <span style="color: #A3BE8C;">(</span>display-buffer-in-side-window<span style="color: #A3BE8C;">)</span>
               <span style="color: #A3BE8C;">(</span>side . right<span style="color: #A3BE8C;">)</span>
               <span style="color: #A3BE8C;">(</span>window-width . 0.25<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'org-roam
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">defvar</span> <span style="color: #D8DEE9;">my/org-roam-buffer-enabled</span> t<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">my/org-roam-buffer-turn-on-off</span> <span style="color: #A3BE8C;">()</span>
    <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">if</span> my/org-roam-buffer-enabled
        <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">progn</span>
          <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">setq</span> my/org-roam-buffer-enabled nil<span style="color: #8FBCBB;">)</span>
          <span style="color: #8FBCBB;">(</span>org-roam-buffer-toggle<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
      <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">progn</span>
        <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">setq</span> my/org-roam-buffer-enabled t<span style="color: #8FBCBB;">)</span>
        <span style="color: #8FBCBB;">(</span>org-roam-buffer-toggle<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">my/org-roam-backlinks-num</span> <span style="color: #A3BE8C;">()</span>
    <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">let*</span> <span style="color: #5D80AE;">(</span><span style="color: #8FBCBB;">(</span>count <span style="color: #81A1C1;">(</span>caar <span style="color: #B48EAD;">(</span>org-roam-db-query
                         <span style="color: #A3BE8C;">[</span><span style="color: #81A1C1;">:select</span> <span style="color: #5D80AE;">(</span>funcall count source<span style="color: #5D80AE;">)</span>
                                  <span style="color: #81A1C1;">:from</span> links
                                  <span style="color: #81A1C1;">:where</span> <span style="color: #5D80AE;">(</span>= dest $s1<span style="color: #5D80AE;">)</span>
                                  <span style="color: #81A1C1;">:and</span> <span style="color: #5D80AE;">(</span>= type <span style="color: #A3BE8C;">"id"</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">]</span>
                         <span style="color: #A3BE8C;">(</span>org-roam-node-id <span style="color: #5D80AE;">(</span>org-roam-node-at-point<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
      <span style="color: #5D80AE;">(</span>string-to-number <span style="color: #8FBCBB;">(</span>format <span style="color: #A3BE8C;">"%d"</span> count<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">my/org-roam-buffer-show</span> <span style="color: #A3BE8C;">(</span>_<span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">when</span> <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">and</span> my/org-roam-buffer-enabled
               <span style="color: #8FBCBB;">(</span>not <span style="color: #81A1C1;">(</span>minibufferp<span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
               <span style="color: #8FBCBB;">(</span>not org-roam-capture--node<span style="color: #8FBCBB;">)</span>
               <span style="color: #8FBCBB;">(</span>not <span style="color: #81A1C1;">(</span>derived-mode-p 'calendar-mode<span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
               <span style="color: #8FBCBB;">(</span>not org-capture-mode<span style="color: #8FBCBB;">)</span>
               <span style="color: #8FBCBB;">(</span>xor <span style="color: #81A1C1;">(</span>org-roam-buffer-p<span style="color: #81A1C1;">)</span> <span style="color: #81A1C1;">(</span>eq 'visible <span style="color: #B48EAD;">(</span>org-roam-buffer--visibility<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
      <span style="color: #5D80AE;">(</span>org-roam-buffer-toggle<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>add-hook 'window-buffer-change-functions #'my/org-roam-buffer-show<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>advice-add 'vundo <span style="color: #81A1C1;">:before</span> 'org-roam-buffer-toggle<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<p>
Quick open org roam ref link。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #6f7787;">;; </span><span style="color: #6f7787;">https://org-roam.discourse.group/t/opening-url-in-roam-refs-field/2564/4?u=jousimies</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">gpc/open-node-roam-ref-url</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #78808f;">"Open the URL in this node's ROAM_REFS property, if one exists"</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">when-let</span> <span style="color: #A3BE8C;">(</span><span style="color: #5D80AE;">(</span>ref-url <span style="color: #8FBCBB;">(</span>org-entry-get-with-inheritance <span style="color: #A3BE8C;">"ROAM_REFS"</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span>browse-url ref-url<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-roam-ui-sync-theme t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-roam-ui-follow t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-roam-ui-update-on-save t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-roam-ui-open-on-start t<span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'org-roam-ui
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">require</span> '<span style="color: #81A1C1;">websocket</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
  <span style="color: #A3BE8C;">"n"</span> '<span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">:ignore</span> t <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Notes"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"na"</span> '<span style="color: #B48EAD;">(</span>org-roam-node-random <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Random node"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"nf"</span> '<span style="color: #B48EAD;">(</span>org-roam-node-find <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Find node"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"nF"</span> '<span style="color: #B48EAD;">(</span>org-roam-ref-find <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Find ref"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"ni"</span> '<span style="color: #B48EAD;">(</span>org-roam-node-insert <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Insert node"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"nu"</span> '<span style="color: #B48EAD;">(</span>org-roam-ui-open <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Roam UI"</span><span style="color: #B48EAD;">)</span>

  <span style="color: #A3BE8C;">"nr"</span> '<span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">:ignore</span> t <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Roam"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"nra"</span> '<span style="color: #B48EAD;">(</span>org-roam-alias-add <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Add alias"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"nrA"</span> '<span style="color: #B48EAD;">(</span>org-roam-alias-remove <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Remove alias"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"nrt"</span> '<span style="color: #B48EAD;">(</span>org-roam-tag-add <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Add tag"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"nrT"</span> '<span style="color: #B48EAD;">(</span>org-roam-tag-remove <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Remove tag"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"nrd"</span> '<span style="color: #B48EAD;">(</span>org-roam-db-sync <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Sync DB"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"nrb"</span> '<span style="color: #B48EAD;">(</span>my/org-roam-buffer-turn-on-off <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Roam buffer"</span><span style="color: #B48EAD;">)</span>

  <span style="color: #A3BE8C;">"nd"</span> '<span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">:ignore</span> t <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"By date"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"ndb"</span> '<span style="color: #B48EAD;">(</span>org-roam-dailies-goto-previous-note <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Goto previour note"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"ndd"</span> '<span style="color: #B48EAD;">(</span>org-roam-dailies-goto-date <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Goto date"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"ndD"</span> '<span style="color: #B48EAD;">(</span>org-roam-dailies-capture-date <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Capture date"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"ndf"</span> '<span style="color: #B48EAD;">(</span>org-roam-dailies-goto-next-note <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Goto next note"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"ndm"</span> '<span style="color: #B48EAD;">(</span>org-roam-dailies-goto-tomorrow <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Goto tomorrow"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"ndM"</span> '<span style="color: #B48EAD;">(</span>org-roam-dailies-capture-tomorrow <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Capture tomorrow"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"ndn"</span> '<span style="color: #B48EAD;">(</span>org-roam-dailies-capture-today <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Capture today"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"ndt"</span> '<span style="color: #B48EAD;">(</span>org-roam-dailies-goto-today <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Goto today"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"ndT"</span> '<span style="color: #B48EAD;">(</span>org-roam-dailies-capture-today <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Capture today"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"ndy"</span> '<span style="color: #B48EAD;">(</span>org-roam-dailies-goto-yesterday <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Goto yesterday"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"ndY"</span> '<span style="color: #B48EAD;">(</span>org-roam-dailies-capture-yesterday <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Capture yesterday"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"nd-"</span> '<span style="color: #B48EAD;">(</span>org-roam-dailies-find-directory <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Find directory"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org9b7131b" class="outline-4">
<h4 id="org9b7131b"><span class="section-number-4">11.7.2.</span> Transclusion</h4>
<div class="outline-text-4" id="text-11-7-2">
<p>
默认的 fringe 颜色是默白的，和我默认的主题颜色一样，这样就导致会看不清 transclusion 的状态。使用 <code>face-sepc-set</code> 更改下颜色。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>face-spec-set 'org-transclusion-fringe
       '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">(</span><span style="color: #5D80AE;">(</span><span style="color: #8FBCBB;">(</span>background light<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
          <span style="color: #81A1C1;">:foreground</span> <span style="color: #A3BE8C;">"</span><span style="color: #ffffff; background-color: #000000;">black</span><span style="color: #A3BE8C;">"</span><span style="color: #A3BE8C;">)</span>
         <span style="color: #A3BE8C;">(</span>t
          <span style="color: #81A1C1;">:foreground</span> <span style="color: #A3BE8C;">"</span><span style="color: #000000; background-color: #ffffff;">white</span><span style="color: #A3BE8C;">"</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
       'face-override-spec<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>face-spec-set 'org-transclusion-source-fringe
       '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">(</span><span style="color: #5D80AE;">(</span><span style="color: #8FBCBB;">(</span>background light<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
          <span style="color: #81A1C1;">:foreground</span> <span style="color: #A3BE8C;">"</span><span style="color: #ffffff; background-color: #000000;">black</span><span style="color: #A3BE8C;">"</span><span style="color: #A3BE8C;">)</span>
         <span style="color: #A3BE8C;">(</span>t
          <span style="color: #81A1C1;">:foreground</span> <span style="color: #A3BE8C;">"</span><span style="color: #000000; background-color: #ffffff;">white</span><span style="color: #A3BE8C;">"</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
       'face-override-spec<span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">let</span> <span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">(</span>map global-map<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>define-key map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"C-c o t a"</span><span style="color: #A3BE8C;">)</span> 'org-transclusion-add<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>define-key map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"C-c o t A"</span><span style="color: #A3BE8C;">)</span> 'org-transclusion-add-all<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>define-key map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"C-c o t r"</span><span style="color: #A3BE8C;">)</span> 'org-transclusion-remove<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>define-key map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"C-c o t R"</span><span style="color: #A3BE8C;">)</span> 'org-transclusion-remove-all<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>define-key map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"C-c o t g"</span><span style="color: #A3BE8C;">)</span> 'org-transclusion-refresh<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>define-key map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"C-c o t m"</span><span style="color: #A3BE8C;">)</span> 'org-transclusion-make-from-link<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>define-key map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"C-c o t o"</span><span style="color: #A3BE8C;">)</span> 'org-transclusion-open-source<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>define-key map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"C-c o t e"</span><span style="color: #A3BE8C;">)</span> 'org-transclusion-live-sync-start<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/local-leader-def</span>
  <span style="color: #81A1C1;">:states</span> 'normal
  <span style="color: #81A1C1;">:keymaps</span> 'org-mode-map
  <span style="color: #A3BE8C;">"t"</span> '<span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">:ignore</span> t <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Transclusion"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"ta"</span> '<span style="color: #B48EAD;">(</span>org-transclusion-add <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Add"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"tA"</span> '<span style="color: #B48EAD;">(</span>org-transclusion-add-all <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Add all"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"tr"</span> '<span style="color: #B48EAD;">(</span>org-transclusion-remove <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Remove"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"tR"</span> '<span style="color: #B48EAD;">(</span>org-transclusion-remove-all <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Remove all"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"tg"</span> '<span style="color: #B48EAD;">(</span>org-transclusion-refresh <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Refresh"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"tm"</span> '<span style="color: #B48EAD;">(</span>org-transclusion-make-from-link <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Make link"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"to"</span> '<span style="color: #B48EAD;">(</span>org-transclusion-open-source <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Open source"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"te"</span> '<span style="color: #B48EAD;">(</span>org-transclusion-live-sync-start <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Edit live"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org6ececd7" class="outline-4">
<h4 id="org6ececd7"><span class="section-number-4">11.7.3.</span> Journal</h4>
<div class="outline-text-4" id="text-11-7-3">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-journal-dir <span style="color: #B48EAD;">(</span>expand-file-name <span style="color: #A3BE8C;">"journals"</span> my-galaxy<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-journal-date-format <span style="color: #A3BE8C;">"%Y-%m-%d"</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
  <span style="color: #A3BE8C;">"j"</span> '<span style="color: #B48EAD;">(</span>org-journal-new-entry <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Journal"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/local-leader-def</span>
  <span style="color: #81A1C1;">:states</span> 'normal
  <span style="color: #81A1C1;">:keymaps</span> 'org-journal-mode-map
  <span style="color: #A3BE8C;">"j"</span> '<span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">:ignore</span> t <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Journal"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"jc"</span> '<span style="color: #B48EAD;">(</span>org-journal-new-entry <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"New entry"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"jd"</span> '<span style="color: #B48EAD;">(</span>org-journal-new-date-entry <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"New date entry"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"jn"</span> '<span style="color: #B48EAD;">(</span>org-journal-next-entry <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Next entry"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"jp"</span> '<span style="color: #B48EAD;">(</span>org-journal-previous-entry <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Previous entry"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"js"</span> '<span style="color: #B48EAD;">(</span>org-journal-search <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Search"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"jf"</span> '<span style="color: #B48EAD;">(</span>org-journal-search-forever <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Search forever"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"jF"</span> '<span style="color: #B48EAD;">(</span>org-journal-search-future <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Search future"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"jw"</span> '<span style="color: #B48EAD;">(</span>org-journal-search-calendar-week <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Search calendar week"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"jm"</span> '<span style="color: #B48EAD;">(</span>org-journal-search-calendar-month <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Search calendar month"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"jy"</span> '<span style="color: #B48EAD;">(</span>org-journal-search-calendar-year <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Search calendar year"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org01d615d" class="outline-3">
<h3 id="org01d615d"><span class="section-number-3">11.8.</span> Bibtex manage</h3>
<div class="outline-text-3" id="text-11-8">
</div>
<div id="outline-container-orgae3d383" class="outline-4">
<h4 id="orgae3d383"><span class="section-number-4">11.8.1.</span> bibtex</h4>
<div class="outline-text-4" id="text-11-8-1">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> bibtex-autokey-year-length 4<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> bibtex-autokey-name-year-separator <span style="color: #A3BE8C;">"-"</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> bibtex-autokey-year-title-separator <span style="color: #A3BE8C;">"-"</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> bibtex-autokey-titleword-separator <span style="color: #A3BE8C;">"-"</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> bibtex-autokey-titlewords 2<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> bibtex-autokey-titlewords-stretch 1<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> bibtex-autokey-titleword-length 5<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> bibtex-autokey-edit-before-use nil<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org695815a" class="outline-4">
<h4 id="org695815a"><span class="section-number-4">11.8.2.</span> bibtex-completion</h4>
<div class="outline-text-4" id="text-11-8-2">
<p>
这里可以设置 pdf 和 note 的图标，但是我这里会出现图标对不齐的问题。
</p>
<pre class="example" id="org03e63d6">
(setq bibtex-completion-pdf-symbol (all-the-icons-octicon "file-pdf"
							  :height 1
							  :v-adjust -0.05
							  :face 'font-lock-doc-face))
(setq bibtex-completion-notes-symbol (all-the-icons-octicon "file-text"
							    :height 1
							    :v-adjust -0.05
							    :face 'font-lock-doc-face))
</pre>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> bibtex-completion-library-path <span style="color: #B48EAD;">(</span>expand-file-name <span style="color: #A3BE8C;">"ref-pdfs"</span> my-galaxy<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> bibtex-completion-bibliography `<span style="color: #B48EAD;">(</span>,<span style="color: #A3BE8C;">(</span>concat org-roam-directory <span style="color: #A3BE8C;">"/bibtex/References.bib"</span><span style="color: #A3BE8C;">)</span>
                                       ,<span style="color: #A3BE8C;">(</span>expand-file-name <span style="color: #A3BE8C;">"L.Calibre/calibre.bib"</span> my-cloud<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> bibtex-completion-notes-path <span style="color: #B48EAD;">(</span>expand-file-name <span style="color: #A3BE8C;">"ref"</span> org-roam-directory<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> bibtex-completion-additional-search-fields '<span style="color: #B48EAD;">(</span>keywords journal booktitle<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> bibtex-completion-pdf-symbol <span style="color: #A3BE8C;">"P"</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> bibtex-completion-notes-symbol <span style="color: #A3BE8C;">"N"</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> bibtex-completion-display-formats '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">(</span>article . <span style="color: #A3BE8C;">"${=has-pdf=:1} ${=has-note=:1} ${year:4} ${author:36} ${title:*} ${journal:40}"</span><span style="color: #A3BE8C;">)</span>
                                          <span style="color: #A3BE8C;">(</span>inbook . <span style="color: #A3BE8C;">"${=has-pdf=:1} ${=has-note=:1} ${year:4} ${author:36} ${title:*} Chapter ${chapter:32}"</span><span style="color: #A3BE8C;">)</span>
                                          <span style="color: #A3BE8C;">(</span>incollection . <span style="color: #A3BE8C;">"${=has-pdf=:1} ${=has-note=:1} ${year:4} ${author:36} ${title:*} ${booktitle:40}"</span><span style="color: #A3BE8C;">)</span>
                                          <span style="color: #A3BE8C;">(</span>inproceedings . <span style="color: #A3BE8C;">"${=has-pdf=:1} ${=has-note=:1} ${year:4} ${author:36} ${title:*} ${booktitle:40}"</span><span style="color: #A3BE8C;">)</span>
                                          <span style="color: #A3BE8C;">(</span>t . <span style="color: #A3BE8C;">"${=has-pdf=:1} ${=has-note=:1} ${year:4} ${author:36} ${title:*}"</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org4ec3114" class="outline-4">
<h4 id="org4ec3114"><span class="section-number-4">11.8.3.</span> bibtex download</h4>
<div class="outline-text-4" id="text-11-8-3">
<p>
中文不能使用，在于我不知道怎么让 <code>url-insert-file-contents</code> 处理中文。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">get-bibtex-from-url</span> <span style="color: #B48EAD;">(</span>url<span style="color: #B48EAD;">)</span>
  <span style="color: #78808f;">"Get a BibTeX entry from URL and store it in my `</span><span style="color: #81A1C1;">references.bib</span><span style="color: #78808f;">'."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span> <span style="color: #A3BE8C;">"MBibTeX URL: "</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">if</span> <span style="color: #A3BE8C;">(</span>not url-proxy-services<span style="color: #A3BE8C;">)</span>
      <span style="color: #A3BE8C;">(</span>toggle-proxy<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>write-bibtex-entry <span style="color: #A3BE8C;">(</span>get-bibtex-url-contents url<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">get-bibtex-from-doi</span> <span style="color: #B48EAD;">(</span>doi<span style="color: #B48EAD;">)</span>
  <span style="color: #78808f;">"Get a BibTeX entry from the DOI and store it in my `</span><span style="color: #81A1C1;">references.bib</span><span style="color: #78808f;">'."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span> <span style="color: #A3BE8C;">"MDOI: "</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">let*</span> <span style="color: #A3BE8C;">(</span><span style="color: #5D80AE;">(</span>url-mime-accept-string <span style="color: #A3BE8C;">"text/bibliography;style=bibtex"</span><span style="color: #5D80AE;">)</span>
         <span style="color: #5D80AE;">(</span>base-url
          <span style="color: #A3BE8C;">"https://api.crossref.org/works/%s/transform/application/x-bibtex"</span><span style="color: #5D80AE;">)</span>
         <span style="color: #5D80AE;">(</span>doi-resource <span style="color: #8FBCBB;">(</span>s-replace <span style="color: #A3BE8C;">"https://doi.org/"</span> <span style="color: #A3BE8C;">""</span> doi<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
         <span style="color: #5D80AE;">(</span>url <span style="color: #8FBCBB;">(</span>format base-url doi-resource<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
         <span style="color: #5D80AE;">(</span>response-body <span style="color: #8FBCBB;">(</span>get-bibtex-url-contents url<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
         <span style="color: #5D80AE;">(</span>bibtex-entry <span style="color: #8FBCBB;">(</span>s-replace <span style="color: #A3BE8C;">"%2F"</span> <span style="color: #A3BE8C;">"/"</span> response-body<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span>write-bibtex-entry bibtex-entry<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">get-bibtex-url-contents</span> <span style="color: #B48EAD;">(</span>url<span style="color: #B48EAD;">)</span>
  <span style="color: #78808f;">"Fetch the contents of URL and return the result as a string."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">with-temp-buffer</span>
    <span style="color: #A3BE8C;">(</span>url-insert-file-contents url<span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">setq</span> result <span style="color: #5D80AE;">(</span>buffer-string<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
  result<span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">write-bibtex-entry</span> <span style="color: #B48EAD;">(</span>bibtex-entry<span style="color: #B48EAD;">)</span>
  <span style="color: #78808f;">"Write BIBTEX-ENTRY (a string) to my `</span><span style="color: #81A1C1;">references.bib</span><span style="color: #78808f;">' file."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">let</span> <span style="color: #A3BE8C;">(</span><span style="color: #5D80AE;">(</span>reference-filepath <span style="color: #8FBCBB;">(</span>car bibtex-completion-bibliography<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">with-temp-buffer</span>
      <span style="color: #5D80AE;">(</span>insert-file-contents reference-filepath<span style="color: #5D80AE;">)</span>
      <span style="color: #5D80AE;">(</span>goto-char <span style="color: #8FBCBB;">(</span>point-max<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
      <span style="color: #5D80AE;">(</span>insert <span style="color: #A3BE8C;">"\n"</span> <span style="color: #8FBCBB;">(</span>s-trim bibtex-entry<span style="color: #8FBCBB;">)</span> <span style="color: #A3BE8C;">"\n"</span><span style="color: #5D80AE;">)</span>
      <span style="color: #5D80AE;">(</span>search-backward <span style="color: #A3BE8C;">"@"</span><span style="color: #5D80AE;">)</span>
      <span style="color: #5D80AE;">(</span>bibtex-fill-entry<span style="color: #5D80AE;">)</span>
      <span style="color: #5D80AE;">(</span>search-forward <span style="color: #A3BE8C;">"{"</span><span style="color: #5D80AE;">)</span>
      <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">setq</span> pos <span style="color: #8FBCBB;">(</span>point<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
      <span style="color: #5D80AE;">(</span>search-forward <span style="color: #A3BE8C;">","</span><span style="color: #5D80AE;">)</span>
      <span style="color: #5D80AE;">(</span>delete-region pos <span style="color: #8FBCBB;">(</span>- <span style="color: #81A1C1;">(</span>point<span style="color: #81A1C1;">)</span> 1<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
      <span style="color: #5D80AE;">(</span>bibtex-clean-entry<span style="color: #5D80AE;">)</span>
      <span style="color: #5D80AE;">(</span>write-region <span style="color: #8FBCBB;">(</span>point-min<span style="color: #8FBCBB;">)</span> <span style="color: #8FBCBB;">(</span>point-max<span style="color: #8FBCBB;">)</span> reference-filepath<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c b u"</span><span style="color: #B48EAD;">)</span> 'get-bibtex-from-url<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c b d"</span><span style="color: #B48EAD;">)</span> 'get-bibtex-from-doi<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org91b7ad6" class="outline-4">
<h4 id="org91b7ad6"><span class="section-number-4">11.8.4.</span> ebib</h4>
<div class="outline-text-4" id="text-11-8-4">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> ebib-index-mode-line nil<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> ebib-entry-mode-line nil<span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> ebib-preload-bib-files bibtex-completion-bibliography<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> ebib-file-search-dirs `<span style="color: #B48EAD;">(</span>,bibtex-completion-library-path<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> ebib-keywords <span style="color: #B48EAD;">(</span>concat org-roam-directory <span style="color: #A3BE8C;">"/bibtex/keywords.txt"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> ebib-notes-directory <span style="color: #B48EAD;">(</span>concat org-roam-directory <span style="color: #A3BE8C;">"/ref"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> ebib-filters-default-file <span style="color: #B48EAD;">(</span>concat org-roam-directory <span style="color: #A3BE8C;">"/bibtex/ebib-filters"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> ebib-reading-list-file <span style="color: #B48EAD;">(</span>concat org-roam-directory <span style="color: #A3BE8C;">"/bibtex/reading_list.org"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> ebib-keywords-field-keep-sorted t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> ebib-keywords-file-save-on-exit 'always<span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> ebib-index-columns '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"Entry Key"</span> 30 t<span style="color: #A3BE8C;">)</span> <span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"Note"</span> 1 nil<span style="color: #A3BE8C;">)</span> <span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"Year"</span> 6 t<span style="color: #A3BE8C;">)</span> <span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"Title"</span> 50 t<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> ebib-file-associations '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"ps"</span> . <span style="color: #A3BE8C;">"gv"</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"&lt;f2&gt;"</span><span style="color: #B48EAD;">)</span> 'ebib<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
  <span style="color: #A3BE8C;">"E"</span> '<span style="color: #B48EAD;">(</span>ebib <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Ebib"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org5b9e3db" class="outline-4">
<h4 id="org5b9e3db"><span class="section-number-4">11.8.5.</span> oc-csl</h4>
<div class="outline-text-4" id="text-11-8-5">
<p>
<a href="https://blog.tecosaur.com/tmio/2021-07-31-citations.html">https://blog.tecosaur.com/tmio/2021-07-31-citations.html</a>
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'org-mode-hook #'<span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">lambda</span> <span style="color: #A3BE8C;">()</span> <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">require</span> '<span style="color: #81A1C1;">oc-csl</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-cite-global-bibliography bibtex-completion-bibliography<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-cite-insert-processor 'citar
      org-cite-follow-processor 'citar
      org-cite-activate-processor 'citar<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org87b84b4" class="outline-4">
<h4 id="org87b84b4"><span class="section-number-4">11.8.6.</span> citar</h4>
<div class="outline-text-4" id="text-11-8-6">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> citar-bibliography <span style="color: #B48EAD;">(</span>car bibtex-completion-bibliography<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> citar-bibliography bibtex-completion-bibliography<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> citar-notes-paths `<span style="color: #B48EAD;">(</span>,bibtex-completion-notes-path<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> citar-library-paths `<span style="color: #B48EAD;">(</span>,bibtex-completion-library-path<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> citar-templates '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">(</span>main . <span style="color: #A3BE8C;">"${author editor:30} ${date year issued:4} ${title:48}"</span><span style="color: #A3BE8C;">)</span>
                        <span style="color: #A3BE8C;">(</span>suffix . <span style="color: #A3BE8C;">"${=key= id:15} ${=type=:12} ${tags keywords:*}"</span><span style="color: #A3BE8C;">)</span>
                        <span style="color: #A3BE8C;">(</span>preview . <span style="color: #A3BE8C;">"${author editor} (${year issued date}) ${title}, ${journal journaltitle publisher container-title collection-title}.\n"</span><span style="color: #A3BE8C;">)</span>
                        <span style="color: #A3BE8C;">(</span>note . <span style="color: #A3BE8C;">"${title}"</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> citar-at-point-function 'embark-act<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> citar-open-note-function 'orb-citar-edit-note<span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> citar-symbol-separator <span style="color: #A3BE8C;">" "</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'citar-org
  <span style="color: #B48EAD;">(</span>define-key citar-org-citation-map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"&lt;return&gt;"</span><span style="color: #A3BE8C;">)</span> 'org-open-at-point<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>define-key org-mode-map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"C-c C-x @"</span><span style="color: #A3BE8C;">)</span> 'citar-insert-citation<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'org-mode-hook 'citar-embark-mode<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'citar-embark
  <span style="color: #B48EAD;">(</span>diminish 'citar-embark-mode<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgace627b" class="outline-4">
<h4 id="orgace627b"><span class="section-number-4">11.8.7.</span> consult-bibtex</h4>
<div class="outline-text-4" id="text-11-8-7">
<p>
<a href="https://github.com/mohkale/consult-bibtex/tree/master">mohkale/consult-bibtex: Emacs bibtex-completion through consulting-read</a>
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'after-init-hook <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">lambda</span> <span style="color: #A3BE8C;">()</span>
                                 <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">require</span> '<span style="color: #81A1C1;">consult-bibtex</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c n b o"</span><span style="color: #B48EAD;">)</span> 'consult-bibtex-open-any<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c n b e"</span><span style="color: #B48EAD;">)</span> 'consult-bibtex-show-entry<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
  <span style="color: #A3BE8C;">"nb"</span> '<span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">:ignore</span> t <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Bibtex"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"nbo"</span> '<span style="color: #B48EAD;">(</span>consult-bibtex-open-any <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Open bibtex"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"nbe"</span> '<span style="color: #B48EAD;">(</span>consult-bibtex-show-entry <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Show entry"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org787cd52" class="outline-4">
<h4 id="org787cd52"><span class="section-number-4">11.8.8.</span> org-roam-bibtex</h4>
<div class="outline-text-4" id="text-11-8-8">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> orb-note-actions-interface 'default
      orb-roam-ref-format 'org-cite<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'org-mode-hook 'org-roam-bibtex-mode<span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c n b a"</span><span style="color: #B48EAD;">)</span> #'orb-note-actions<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
  <span style="color: #A3BE8C;">"nba"</span> '<span style="color: #B48EAD;">(</span>orb-note-actions <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"ORB actions"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org9a24de5" class="outline-3">
<h3 id="org9a24de5"><span class="section-number-3">11.9.</span> RSS management</h3>
<div class="outline-text-3" id="text-11-9">
</div>
<div id="outline-container-org50ac71b" class="outline-4">
<h4 id="org50ac71b"><span class="section-number-4">11.9.1.</span> elfeed</h4>
<div class="outline-text-4" id="text-11-9-1">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> elfeed-show-entry-switch #'elfeed-display-buffer<span style="color: #81A1C1;">)</span>
</pre>
</div>
<p>
elfeed buffer display. 代码借鉴自 <a href="https://github.com/karthink/.emacs.d/blob/master/lisp/setup-elfeed.el">karthink</a> 的配置。这样可以去掉 elfeed-goodies 这个包了。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">elfeed-display-buffer</span> <span style="color: #B48EAD;">(</span>buf <span style="color: #8FBCBB;">&amp;optional</span> act<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>pop-to-buffer buf '<span style="color: #A3BE8C;">(</span><span style="color: #5D80AE;">(</span>display-buffer-reuse-window display-buffer-in-side-window<span style="color: #5D80AE;">)</span>
                       <span style="color: #5D80AE;">(</span>side . bottom<span style="color: #5D80AE;">)</span>
                       <span style="color: #5D80AE;">(</span>window-height . 0.8<span style="color: #5D80AE;">)</span>
                       <span style="color: #5D80AE;">(</span>reusable-frames . visible<span style="color: #5D80AE;">)</span>
                       <span style="color: #5D80AE;">(</span>window-parameters
                        <span style="color: #8FBCBB;">(</span>select . t<span style="color: #8FBCBB;">)</span>
                        <span style="color: #8FBCBB;">(</span>quit . t<span style="color: #8FBCBB;">)</span>
                        <span style="color: #8FBCBB;">(</span>popup . t<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'evil
  <span style="color: #B48EAD;">(</span>evil-set-initial-state 'elfeed-search-mode 'emacs<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>evil-set-initial-state 'elfeed-show-mode 'emacs<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orgeddc190" class="outline-4">
<h4 id="orgeddc190"><span class="section-number-4">11.9.2.</span> elfeed-org</h4>
<div class="outline-text-4" id="text-11-9-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> rmh-elfeed-org-files `<span style="color: #B48EAD;">(</span>,<span style="color: #A3BE8C;">(</span>concat my-galaxy <span style="color: #A3BE8C;">"/rss/elfeed.org"</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'elfeed
  <span style="color: #B48EAD;">(</span>elfeed-org<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">my/rss-source</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>find-file <span style="color: #A3BE8C;">(</span>car rmh-elfeed-org-files<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c f o e"</span><span style="color: #B48EAD;">)</span> #'my/rss-source<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-orga80fdee" class="outline-4">
<h4 id="orga80fdee"><span class="section-number-4">11.9.3.</span> elfeed-summary</h4>
<div class="outline-text-4" id="text-11-9-3">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> elfeed-summary-other-window t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> elfeed-summary-settings
      '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">(</span>group <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">:title</span> . <span style="color: #A3BE8C;">"&#31185;&#25216;"</span><span style="color: #5D80AE;">)</span>
               <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">:elements</span> <span style="color: #8FBCBB;">(</span>query . <span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">and</span> tec <span style="color: #B48EAD;">(</span>not emacs<span style="color: #B48EAD;">)</span> <span style="color: #B48EAD;">(</span>not blogs<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
                          <span style="color: #8FBCBB;">(</span>group <span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">:title</span> . <span style="color: #A3BE8C;">"Emacs"</span><span style="color: #81A1C1;">)</span>
                                 <span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">:elements</span> <span style="color: #B48EAD;">(</span>query . emacs<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
                                 <span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">:face</span> . org-level-1<span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
                          <span style="color: #8FBCBB;">(</span>group <span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">:title</span> . <span style="color: #A3BE8C;">"Blogs"</span><span style="color: #81A1C1;">)</span>
                                 <span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">:elements</span> <span style="color: #B48EAD;">(</span>query . blogs<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
        <span style="color: #A3BE8C;">(</span>group <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">:title</span> . <span style="color: #A3BE8C;">"News"</span><span style="color: #5D80AE;">)</span>
               <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">:elements</span> <span style="color: #8FBCBB;">(</span>query . news<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
        <span style="color: #A3BE8C;">(</span>group <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">:title</span> . <span style="color: #A3BE8C;">"Books"</span><span style="color: #5D80AE;">)</span>
               <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">:elements</span> <span style="color: #8FBCBB;">(</span>query . book<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
        <span style="color: #A3BE8C;">(</span>group <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">:title</span> . <span style="color: #A3BE8C;">"Finance"</span><span style="color: #5D80AE;">)</span>
               <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">:elements</span> <span style="color: #8FBCBB;">(</span>query . finance<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>advice-add 'elfeed-summary <span style="color: #81A1C1;">:after</span> 'elfeed-summary-update<span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'evil
  <span style="color: #B48EAD;">(</span>evil-set-initial-state 'elfeed-entry 'emacs<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>evil-set-initial-state 'elfeed-show-mode 'emacs<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c R"</span><span style="color: #B48EAD;">)</span> 'elfeed-summary<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
  <span style="color: #A3BE8C;">"R"</span> '<span style="color: #B48EAD;">(</span>elfeed-summary <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"RSS"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgd2b03fc" class="outline-3">
<h3 id="orgd2b03fc"><span class="section-number-3">11.10.</span> Finance</h3>
<div class="outline-text-3" id="text-11-10">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> ledger-schedule-file <span style="color: #B48EAD;">(</span>expand-file-name <span style="color: #A3BE8C;">"finance/schedule.ledger"</span> my-galaxy<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'ledger-mode-hook 'corfu-mode<span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> ledger-reports
      '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"bal"</span>            <span style="color: #A3BE8C;">"%(binary) -f %(ledger-file) bal"</span><span style="color: #A3BE8C;">)</span>
        <span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"bal this month"</span> <span style="color: #A3BE8C;">"%(binary) -f %(ledger-file) bal -p %(month) -S amount"</span><span style="color: #A3BE8C;">)</span>
        <span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"bal this year"</span>  <span style="color: #A3BE8C;">"%(binary) -f %(ledger-file) bal -p 'this year'"</span><span style="color: #A3BE8C;">)</span>
        <span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"net worth"</span>      <span style="color: #A3BE8C;">"%(binary) -f %(ledger-file) bal Assets Liabilities"</span><span style="color: #A3BE8C;">)</span>
        <span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"account"</span>        <span style="color: #A3BE8C;">"%(binary) -f %(ledger-file) reg %(account)"</span><span style="color: #A3BE8C;">)</span>
        <span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"reg"</span> <span style="color: #A3BE8C;">"%(binary) -f %(ledger-file) reg"</span><span style="color: #A3BE8C;">)</span>
        <span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"payee"</span> <span style="color: #A3BE8C;">"%(binary) -f %(ledger-file) reg @%(payee)"</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/local-leader-def</span>
  <span style="color: #81A1C1;">:states</span> 'normal
  <span style="color: #81A1C1;">:keymaps</span> 'ledger-mode-map
  <span style="color: #A3BE8C;">"a"</span> '<span style="color: #B48EAD;">(</span>ledger-add-transaction <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Add Transaction"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"r"</span> '<span style="color: #B48EAD;">(</span>ledger-report <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Report"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"s"</span> '<span style="color: #B48EAD;">(</span>ledger-sort-buffer <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Sort buffer"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"d"</span> '<span style="color: #B48EAD;">(</span>ledger-delete-current-transaction <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Delete current transaction"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org8b3c339" class="outline-3">
<h3 id="org8b3c339"><span class="section-number-3">11.11.</span> Tasks</h3>
<div class="outline-text-3" id="text-11-11">
<p>
GTD 就是Getting Things Done的缩写，意思是“把需要做的事情处理好”，是一个管理时间的方法。Org-mode 用于实践 GTD 是一个非常很好用的任务管理系统。目前我将笔记系统和任务管理系统结合在一起使用。
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #6f7787;">;; </span><span style="color: #6f7787;">@https://medium.com/@jakeb0x/straightforward-emacs-show-all-unchecked-org-mode-checkboxes-199f22e8524a</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">jakebox/org-occur-unchecked-boxes</span> <span style="color: #B48EAD;">()</span>
    <span style="color: #78808f;">"Show unchecked Org Mode checkboxes."</span>
    <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
    <span style="color: #B48EAD;">(</span>occur <span style="color: #A3BE8C;">"\\[ \\]"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'org
  <span style="color: #B48EAD;">(</span>define-key org-mode-map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"C-c o ["</span><span style="color: #A3BE8C;">)</span> 'jakebox/org-occur-unchecked-boxes<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
<div id="outline-container-org07462ab" class="outline-4">
<h4 id="org07462ab"><span class="section-number-4">11.11.1.</span> Agenda</h4>
<div class="outline-text-4" id="text-11-11-1">
<p>
<a href="https://orgmode.org/worg/agenda-optimization.html">https://orgmode.org/worg/agenda-optimization.html</a>
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-agenda-files <span style="color: #B48EAD;">(</span>directory-files-recursively <span style="color: #A3BE8C;">(</span>expand-file-name <span style="color: #A3BE8C;">"todos"</span> my-galaxy<span style="color: #A3BE8C;">)</span> <span style="color: #A3BE8C;">"org$</span><span style="color: #81A1C1; font-weight: bold;">\\</span><span style="color: #81A1C1; font-weight: bold;">|</span><span style="color: #A3BE8C;">archive$"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">my/gtd-file</span> <span style="color: #B48EAD;">()</span>
    <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
    <span style="color: #B48EAD;">(</span>find-file <span style="color: #A3BE8C;">(</span>expand-file-name <span style="color: #A3BE8C;">"todos/gtd.org"</span> my-galaxy<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span>add-hook 'org-agenda-finalize-hook #'org-agenda-find-same-or-today-or-agenda 90<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-agenda-dim-blocked-tasks t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-agenda-compact-blocks t<span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'org
  <span style="color: #B48EAD;">(</span>define-key org-mode-map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"C-,"</span><span style="color: #A3BE8C;">)</span> nil<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>define-key org-mode-map <span style="color: #A3BE8C;">(</span>kbd <span style="color: #A3BE8C;">"C-'"</span><span style="color: #A3BE8C;">)</span> nil<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">my/org-agenda</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>org-agenda <span style="color: #A3BE8C;">""</span> <span style="color: #A3BE8C;">" "</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c f o g"</span><span style="color: #B48EAD;">)</span> #'my/gtd-file<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c a"</span><span style="color: #B48EAD;">)</span> 'org-agenda<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"&lt;f10&gt;"</span><span style="color: #B48EAD;">)</span> 'my/org-agenda<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
  <span style="color: #A3BE8C;">"oa"</span> '<span style="color: #B48EAD;">(</span>org-agenda <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Agenda"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org36caa51" class="outline-4">
<h4 id="org36caa51"><span class="section-number-4">11.11.2.</span> Combine org-agenda and org-roam</h4>
<div class="outline-text-4" id="text-11-11-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #6f7787;">;; </span><span style="color: #6f7787;">https://github.com/daviwil/dotfiles/blob/master/Emacs.org</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">vulpea-buffer-tags-get</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #78808f;">"Return filetags value in current buffer."</span>
  <span style="color: #B48EAD;">(</span>vulpea-buffer-prop-get-list <span style="color: #A3BE8C;">"filetags"</span> <span style="color: #A3BE8C;">"[ :]"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">vulpea-buffer-tags-set</span> <span style="color: #B48EAD;">(</span><span style="color: #8FBCBB;">&amp;rest</span> tags<span style="color: #B48EAD;">)</span>
  <span style="color: #78808f;">"Set TAGS in current buffer.</span>
<span style="color: #78808f;">If filetags value is already set, replace it."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">if</span> tags
  <span style="color: #A3BE8C;">(</span>vulpea-buffer-prop-set
   <span style="color: #A3BE8C;">"filetags"</span> <span style="color: #5D80AE;">(</span>concat <span style="color: #A3BE8C;">":"</span> <span style="color: #8FBCBB;">(</span>string-join tags <span style="color: #A3BE8C;">":"</span><span style="color: #8FBCBB;">)</span> <span style="color: #A3BE8C;">":"</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span>vulpea-buffer-prop-remove <span style="color: #A3BE8C;">"filetags"</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">vulpea-buffer-tags-add</span> <span style="color: #B48EAD;">(</span>tag<span style="color: #B48EAD;">)</span>
  <span style="color: #78808f;">"Add a TAG to filetags in current buffer."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">let*</span> <span style="color: #A3BE8C;">(</span><span style="color: #5D80AE;">(</span>tags <span style="color: #8FBCBB;">(</span>vulpea-buffer-tags-get<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
     <span style="color: #5D80AE;">(</span>tags <span style="color: #8FBCBB;">(</span>append tags <span style="color: #81A1C1;">(</span>list tag<span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span>apply #'vulpea-buffer-tags-set tags<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">vulpea-buffer-tags-remove</span> <span style="color: #B48EAD;">(</span>tag<span style="color: #B48EAD;">)</span>
  <span style="color: #78808f;">"Remove a TAG from filetags in current buffer."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">let*</span> <span style="color: #A3BE8C;">(</span><span style="color: #5D80AE;">(</span>tags <span style="color: #8FBCBB;">(</span>vulpea-buffer-tags-get<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
     <span style="color: #5D80AE;">(</span>tags <span style="color: #8FBCBB;">(</span>delete tag tags<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span>apply #'vulpea-buffer-tags-set tags<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">vulpea-buffer-prop-set</span> <span style="color: #B48EAD;">(</span>name value<span style="color: #B48EAD;">)</span>
  <span style="color: #78808f;">"Set a file property called NAME to VALUE in buffer file.</span>
<span style="color: #78808f;">If the property is already set, replace its value."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">setq</span> name <span style="color: #A3BE8C;">(</span>downcase name<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">org-with-point-at</span> 1
    <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">let</span> <span style="color: #5D80AE;">(</span><span style="color: #8FBCBB;">(</span>case-fold-search t<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
  <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">if</span> <span style="color: #8FBCBB;">(</span>re-search-forward <span style="color: #81A1C1;">(</span>concat <span style="color: #A3BE8C;">"^#\\+"</span> name <span style="color: #A3BE8C;">":</span><span style="color: #81A1C1; font-weight: bold;">\\</span><span style="color: #81A1C1; font-weight: bold;">(</span><span style="color: #A3BE8C;">.*</span><span style="color: #81A1C1; font-weight: bold;">\\</span><span style="color: #81A1C1; font-weight: bold;">)</span><span style="color: #A3BE8C;">"</span><span style="color: #81A1C1;">)</span>
                 <span style="color: #81A1C1;">(</span>point-max<span style="color: #81A1C1;">)</span> t<span style="color: #8FBCBB;">)</span>
      <span style="color: #8FBCBB;">(</span>replace-match <span style="color: #81A1C1;">(</span>concat <span style="color: #A3BE8C;">"#+"</span> name <span style="color: #A3BE8C;">": "</span> value<span style="color: #81A1C1;">)</span> 'fixedcase<span style="color: #8FBCBB;">)</span>
    <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">while</span> <span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">and</span> <span style="color: #B48EAD;">(</span>not <span style="color: #A3BE8C;">(</span>eobp<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
            <span style="color: #B48EAD;">(</span>looking-at <span style="color: #A3BE8C;">"^[#:]"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
      <span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">if</span> <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">save-excursion</span> <span style="color: #A3BE8C;">(</span>end-of-line<span style="color: #A3BE8C;">)</span> <span style="color: #A3BE8C;">(</span>eobp<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
      <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">progn</span>
        <span style="color: #A3BE8C;">(</span>end-of-line<span style="color: #A3BE8C;">)</span>
        <span style="color: #A3BE8C;">(</span>insert <span style="color: #A3BE8C;">"\n"</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
        <span style="color: #B48EAD;">(</span>forward-line<span style="color: #B48EAD;">)</span>
        <span style="color: #B48EAD;">(</span>beginning-of-line<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
    <span style="color: #8FBCBB;">(</span>insert <span style="color: #A3BE8C;">"#+"</span> name <span style="color: #A3BE8C;">": "</span> value <span style="color: #A3BE8C;">"\n"</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">vulpea-buffer-prop-set-list</span> <span style="color: #B48EAD;">(</span>name values <span style="color: #8FBCBB;">&amp;optional</span> separators<span style="color: #B48EAD;">)</span>
  <span style="color: #78808f;">"Set a file property called NAME to VALUES in current buffer.</span>
<span style="color: #78808f;">VALUES are quoted and combined into single string using</span>
<span style="color: #78808f;">`</span><span style="color: #81A1C1;">combine-and-quote-strings</span><span style="color: #78808f;">'.</span>
<span style="color: #78808f;">If SEPARATORS is non-nil, it should be a regular expression</span>
<span style="color: #78808f;">matching text that separates, but is not part of, the substrings.</span>
<span style="color: #78808f;">If nil it defaults to `</span><span style="color: #81A1C1;">split-string-default-separators</span><span style="color: #78808f;">', normally</span>
<span style="color: #78808f;">\"[ \f\t\n\r\v]+\", and OMIT-NULLS is forced to t.</span>
<span style="color: #78808f;">If the property is already set, replace its value."</span>
  <span style="color: #B48EAD;">(</span>vulpea-buffer-prop-set
   name <span style="color: #A3BE8C;">(</span>combine-and-quote-strings values separators<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">vulpea-buffer-prop-get</span> <span style="color: #B48EAD;">(</span>name<span style="color: #B48EAD;">)</span>
  <span style="color: #78808f;">"Get a buffer property called NAME as a string."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">org-with-point-at</span> 1
    <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">when</span> <span style="color: #5D80AE;">(</span>re-search-forward <span style="color: #8FBCBB;">(</span>concat <span style="color: #A3BE8C;">"^#\\+"</span> name <span style="color: #A3BE8C;">": </span><span style="color: #81A1C1; font-weight: bold;">\\</span><span style="color: #81A1C1; font-weight: bold;">(</span><span style="color: #A3BE8C;">.*</span><span style="color: #81A1C1; font-weight: bold;">\\</span><span style="color: #81A1C1; font-weight: bold;">)</span><span style="color: #A3BE8C;">"</span><span style="color: #8FBCBB;">)</span>
                 <span style="color: #8FBCBB;">(</span>point-max<span style="color: #8FBCBB;">)</span> t<span style="color: #5D80AE;">)</span>
  <span style="color: #5D80AE;">(</span>buffer-substring-no-properties
   <span style="color: #8FBCBB;">(</span>match-beginning 1<span style="color: #8FBCBB;">)</span>
   <span style="color: #8FBCBB;">(</span>match-end 1<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">vulpea-buffer-prop-get-list</span> <span style="color: #B48EAD;">(</span>name <span style="color: #8FBCBB;">&amp;optional</span> separators<span style="color: #B48EAD;">)</span>
  <span style="color: #78808f;">"Get a buffer property NAME as a list using SEPARATORS.</span>
<span style="color: #78808f;">If SEPARATORS is non-nil, it should be a regular expression</span>
<span style="color: #78808f;">matching text that separates, but is not part of, the substrings.</span>
<span style="color: #78808f;">If nil it defaults to `</span><span style="color: #81A1C1;">split-string-default-separators</span><span style="color: #78808f;">', normally</span>
<span style="color: #78808f;">\"[ \f\t\n\r\v]+\", and OMIT-NULLS is forced to t."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">let</span> <span style="color: #A3BE8C;">(</span><span style="color: #5D80AE;">(</span>value <span style="color: #8FBCBB;">(</span>vulpea-buffer-prop-get name<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">when</span> <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">and</span> value <span style="color: #8FBCBB;">(</span>not <span style="color: #81A1C1;">(</span>string-empty-p value<span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
  <span style="color: #5D80AE;">(</span>split-string-and-unquote value separators<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">vulpea-buffer-prop-remove</span> <span style="color: #B48EAD;">(</span>name<span style="color: #B48EAD;">)</span>
  <span style="color: #78808f;">"Remove a buffer property called NAME."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">org-with-point-at</span> 1
    <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">when</span> <span style="color: #5D80AE;">(</span>re-search-forward <span style="color: #8FBCBB;">(</span>concat <span style="color: #A3BE8C;">"</span><span style="color: #81A1C1; font-weight: bold;">\\</span><span style="color: #81A1C1; font-weight: bold;">(</span><span style="color: #A3BE8C;">^#\\+"</span> name <span style="color: #A3BE8C;">":.*\n?</span><span style="color: #81A1C1; font-weight: bold;">\\</span><span style="color: #81A1C1; font-weight: bold;">)</span><span style="color: #A3BE8C;">"</span><span style="color: #8FBCBB;">)</span>
                 <span style="color: #8FBCBB;">(</span>point-max<span style="color: #8FBCBB;">)</span> t<span style="color: #5D80AE;">)</span>
  <span style="color: #5D80AE;">(</span>replace-match <span style="color: #A3BE8C;">""</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>

<p>
Dynamic agenda。如果需要给合使用 org-roam 和固定的 org 文件可以使用下面的配置，改写 <code>vulpea-agenda-files-update</code> 。
</p>
<pre class="example" id="org379e354">
(defun vulpea-agenda-files-update (&amp;rest _)
  "Update the value of `org-agenda-files'."
  (setq org-agenda-files (seq-uniq
                          (append
                           (vulpea-project-files)
                           '("/path/to/file1"
                             "/path/to/file2"
                             "...")))))
</pre>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">vulpea-project-p</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #78808f;">"Return non-nil if current buffer has any todo entry.</span>
<span style="color: #78808f;">TODO entries marked as done are ignored, meaning the this</span>
<span style="color: #78808f;">function returns nil if current buffer contains only completed</span>
<span style="color: #78808f;">tasks."</span>
  <span style="color: #B48EAD;">(</span>seq-find                                 <span style="color: #6f7787;">; </span><span style="color: #6f7787;">(3)</span>
   <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">lambda</span> <span style="color: #5D80AE;">(</span>type<span style="color: #5D80AE;">)</span>
     <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">or</span> <span style="color: #8FBCBB;">(</span>eq type 'todo<span style="color: #8FBCBB;">)</span>
     <span style="color: #8FBCBB;">(</span>eq type 'done<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
   <span style="color: #A3BE8C;">(</span>org-element-map                         <span style="color: #6f7787;">; </span><span style="color: #6f7787;">(2)</span>
   <span style="color: #5D80AE;">(</span>org-element-parse-buffer 'headline<span style="color: #5D80AE;">)</span> <span style="color: #6f7787;">; </span><span style="color: #6f7787;">(1)</span>
   'headline
     <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">lambda</span> <span style="color: #8FBCBB;">(</span>h<span style="color: #8FBCBB;">)</span>
   <span style="color: #8FBCBB;">(</span>org-element-property <span style="color: #81A1C1;">:todo-type</span> h<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">vulpea-project-update-tag</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #78808f;">"Update PROJECT tag in the current buffer."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">when</span> <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">and</span> <span style="color: #5D80AE;">(</span>not <span style="color: #8FBCBB;">(</span>active-minibuffer-window<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
         <span style="color: #5D80AE;">(</span>vulpea-buffer-p<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">save-excursion</span>
  <span style="color: #5D80AE;">(</span>goto-char <span style="color: #8FBCBB;">(</span>point-min<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
  <span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">let*</span> <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">(</span>tags <span style="color: #B48EAD;">(</span>vulpea-buffer-tags-get<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
         <span style="color: #81A1C1;">(</span>original-tags tags<span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
    <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">if</span> <span style="color: #81A1C1;">(</span>vulpea-project-p<span style="color: #81A1C1;">)</span>
        <span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> tags <span style="color: #B48EAD;">(</span>cons <span style="color: #A3BE8C;">"project"</span> tags<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
      <span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> tags <span style="color: #B48EAD;">(</span>remove <span style="color: #A3BE8C;">"project"</span> tags<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
    <span style="color: #6f7787;">;; </span><span style="color: #6f7787;">cleanup duplicates</span>
    <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">setq</span> tags <span style="color: #81A1C1;">(</span>seq-uniq tags<span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
    <span style="color: #6f7787;">;; </span><span style="color: #6f7787;">update tags if changed</span>
    <span style="color: #8FBCBB;">(</span><span style="color: #81A1C1;">when</span> <span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">or</span> <span style="color: #B48EAD;">(</span>seq-difference tags original-tags<span style="color: #B48EAD;">)</span>
          <span style="color: #B48EAD;">(</span>seq-difference original-tags tags<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
      <span style="color: #81A1C1;">(</span>apply #'vulpea-buffer-tags-set tags<span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">vulpea-buffer-p</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #78808f;">"Return non-nil if the currently visited buffer is a note."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">and</span> buffer-file-name
   <span style="color: #A3BE8C;">(</span>string-prefix-p
    <span style="color: #5D80AE;">(</span>expand-file-name <span style="color: #8FBCBB;">(</span>file-name-as-directory org-roam-directory<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span>
    <span style="color: #5D80AE;">(</span>file-name-directory buffer-file-name<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">vulpea-project-files</span> <span style="color: #B48EAD;">()</span>
    <span style="color: #78808f;">"Return a list of note files containing '</span><span style="color: #81A1C1;">project</span><span style="color: #78808f;">' tag."</span> <span style="color: #6f7787;">;</span>
    <span style="color: #B48EAD;">(</span>seq-uniq
     <span style="color: #A3BE8C;">(</span>seq-map
  #'car
  <span style="color: #5D80AE;">(</span>org-roam-db-query
   <span style="color: #8FBCBB;">[</span><span style="color: #81A1C1;">:select</span> <span style="color: #81A1C1;">[</span>nodes:file<span style="color: #81A1C1;">]</span>
    <span style="color: #81A1C1;">:from</span> tags
    <span style="color: #81A1C1;">:left-join</span> nodes
    <span style="color: #81A1C1;">:on</span> <span style="color: #81A1C1;">(</span>= tags:node-id nodes:id<span style="color: #81A1C1;">)</span>
    <span style="color: #81A1C1;">:where</span> <span style="color: #81A1C1;">(</span>like tag <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">quote</span> <span style="color: #A3BE8C;">"%\"project\"%"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">]</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">vulpea-agenda-files-update</span> <span style="color: #B48EAD;">(</span><span style="color: #8FBCBB;">&amp;rest</span> _<span style="color: #B48EAD;">)</span>
  <span style="color: #78808f;">"Update the value of `</span><span style="color: #81A1C1;">org-agenda-files</span><span style="color: #78808f;">'."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">setq</span> org-agenda-files <span style="color: #A3BE8C;">(</span>seq-uniq
                          <span style="color: #5D80AE;">(</span>append
                           <span style="color: #8FBCBB;">(</span>vulpea-project-files<span style="color: #8FBCBB;">)</span>
                           `<span style="color: #8FBCBB;">(</span>,<span style="color: #81A1C1;">(</span>expand-file-name <span style="color: #A3BE8C;">"todos/gtd.org"</span> my-galaxy<span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span>add-hook 'find-file-hook #'vulpea-project-update-tag<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'before-save-hook #'vulpea-project-update-tag<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'find-file-hook #'vulpea-agenda-files-update<span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span>advice-add 'org-agenda <span style="color: #81A1C1;">:before</span> #'vulpea-agenda-files-update<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>advice-add 'org-todo-list <span style="color: #81A1C1;">:before</span> #'vulpea-agenda-files-update<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org746c291" class="outline-4">
<h4 id="org746c291"><span class="section-number-4">11.11.3.</span> org-agenda-custom-commands</h4>
<div class="outline-text-4" id="text-11-11-3">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-agenda-custom-commands
      '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"A"</span> <span style="color: #A3BE8C;">"Archive"</span>
        <span style="color: #5D80AE;">(</span><span style="color: #8FBCBB;">(</span>todo <span style="color: #A3BE8C;">"DONE|CNCL"</span>
                <span style="color: #81A1C1;">(</span><span style="color: #B48EAD;">(</span>org-agenda-prefix-format <span style="color: #A3BE8C;">" %i"</span><span style="color: #B48EAD;">)</span>
                 <span style="color: #B48EAD;">(</span>org-agenda-hide-tags-regexp <span style="color: #A3BE8C;">"project"</span><span style="color: #B48EAD;">)</span>
                 <span style="color: #B48EAD;">(</span>org-agenda-overriding-header <span style="color: #A3BE8C;">"Archive"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span>
        <span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">" "</span> <span style="color: #A3BE8C;">"GTD Lists: Daily agenda and tasks"</span>
         <span style="color: #5D80AE;">(</span><span style="color: #8FBCBB;">(</span>agenda <span style="color: #A3BE8C;">""</span> <span style="color: #81A1C1;">(</span><span style="color: #B48EAD;">(</span>org-agenda-span 1<span style="color: #B48EAD;">)</span>
                      <span style="color: #B48EAD;">(</span>org-deadline-warning-days 0<span style="color: #B48EAD;">)</span>
                      <span style="color: #B48EAD;">(</span>org-agenda-block-separator nil<span style="color: #B48EAD;">)</span>
                      <span style="color: #B48EAD;">(</span>org-scheduled-past-days 365<span style="color: #B48EAD;">)</span>
                      <span style="color: #B48EAD;">(</span>org-agenda-hide-tags-regexp <span style="color: #A3BE8C;">"project"</span><span style="color: #B48EAD;">)</span>
                      <span style="color: #B48EAD;">(</span>org-agenda-day-face-function <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">lambda</span> <span style="color: #5D80AE;">(</span>date<span style="color: #5D80AE;">)</span> 'org-agenda-date<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
                      <span style="color: #B48EAD;">(</span>org-agenda-format-date <span style="color: #A3BE8C;">"%A %-e %B %Y"</span><span style="color: #B48EAD;">)</span>
                      <span style="color: #B48EAD;">(</span>org-agenda-prefix-format <span style="color: #A3BE8C;">" %i %?-12t% s"</span><span style="color: #B48EAD;">)</span>
                      <span style="color: #B48EAD;">(</span>org-agenda-overriding-header <span style="color: #A3BE8C;">"Today's agenda"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
          <span style="color: #8FBCBB;">(</span>agenda <span style="color: #A3BE8C;">""</span> <span style="color: #81A1C1;">(</span><span style="color: #B48EAD;">(</span>org-agenda-time-grid nil<span style="color: #B48EAD;">)</span>
                      <span style="color: #B48EAD;">(</span>org-agenda-start-on-weekday nil<span style="color: #B48EAD;">)</span>
                      <span style="color: #B48EAD;">(</span>org-agenda-span 14<span style="color: #B48EAD;">)</span>
                      <span style="color: #B48EAD;">(</span>org-agenda-show-all-dates nil<span style="color: #B48EAD;">)</span>
                      <span style="color: #B48EAD;">(</span>org-deadline-warning-days 0<span style="color: #B48EAD;">)</span>
                      <span style="color: #B48EAD;">(</span>org-agenda-prefix-format <span style="color: #A3BE8C;">" %i"</span><span style="color: #B48EAD;">)</span>
                      <span style="color: #B48EAD;">(</span>org-agenda-block-separator nil<span style="color: #B48EAD;">)</span>
                      <span style="color: #B48EAD;">(</span>org-agenda-hide-tags-regexp <span style="color: #A3BE8C;">"project"</span><span style="color: #B48EAD;">)</span>
                      <span style="color: #B48EAD;">(</span>org-agenda-entry-types '<span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">:deadline</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
                      <span style="color: #B48EAD;">(</span>org-agenda-skip-function '<span style="color: #A3BE8C;">(</span>org-agenda-skip-entry-if 'todo 'done<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
                      <span style="color: #B48EAD;">(</span>org-agenda-overriding-header <span style="color: #A3BE8C;">"Upcoming deadlines (+14d)"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
          <span style="color: #8FBCBB;">(</span>tags-todo <span style="color: #A3BE8C;">"*"</span>
                     <span style="color: #81A1C1;">(</span><span style="color: #B48EAD;">(</span>org-agenda-skip-function `<span style="color: #A3BE8C;">(</span>org-agenda-skip-entry-if 'deadline
                                                                           'schedule
                                                                           'timestamp
                                                                           'notregexp ,<span style="color: #5D80AE;">(</span>format <span style="color: #A3BE8C;">"\\[#%s\\]"</span> <span style="color: #81A1C1;">(</span>char-to-string org-priority-highest<span style="color: #81A1C1;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
                      <span style="color: #B48EAD;">(</span>org-agenda-hide-tags-regexp <span style="color: #A3BE8C;">"project"</span><span style="color: #B48EAD;">)</span>
                      <span style="color: #B48EAD;">(</span>org-agenda-prefix-format <span style="color: #A3BE8C;">" %i"</span><span style="color: #B48EAD;">)</span>
                      <span style="color: #B48EAD;">(</span>org-agenda-overriding-header <span style="color: #A3BE8C;">"Important tasks without a date"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
          <span style="color: #8FBCBB;">(</span>todo <span style="color: #A3BE8C;">"NEXT"</span>
                <span style="color: #81A1C1;">(</span><span style="color: #B48EAD;">(</span>org-agenda-skip-function '<span style="color: #A3BE8C;">(</span>org-agenda-skip-if nil '<span style="color: #5D80AE;">(</span>timestamp<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
                 <span style="color: #B48EAD;">(</span>org-agenda-prefix-format <span style="color: #A3BE8C;">" %i"</span><span style="color: #B48EAD;">)</span>
                 <span style="color: #B48EAD;">(</span>org-agenda-block-separator nil<span style="color: #B48EAD;">)</span>
                 <span style="color: #B48EAD;">(</span>org-agenda-hide-tags-regexp <span style="color: #A3BE8C;">"project"</span><span style="color: #B48EAD;">)</span>
                 <span style="color: #B48EAD;">(</span>org-agenda-overriding-header <span style="color: #A3BE8C;">"Next tasks list"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
          <span style="color: #8FBCBB;">(</span>todo <span style="color: #A3BE8C;">"INPROGRESS"</span>
                <span style="color: #81A1C1;">(</span><span style="color: #B48EAD;">(</span>org-agenda-block-separator nil<span style="color: #B48EAD;">)</span>
                 <span style="color: #B48EAD;">(</span>org-agenda-prefix-format <span style="color: #A3BE8C;">" %i"</span><span style="color: #B48EAD;">)</span>
                 <span style="color: #B48EAD;">(</span>org-agenda-hide-tags-regexp <span style="color: #A3BE8C;">"project"</span><span style="color: #B48EAD;">)</span>
                 <span style="color: #B48EAD;">(</span>org-agenda-overriding-header <span style="color: #A3BE8C;">"Inprogress tasks list"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
          <span style="color: #8FBCBB;">(</span>tags-todo <span style="color: #A3BE8C;">"-Computer-Emacs/TODO"</span>
                     <span style="color: #81A1C1;">(</span><span style="color: #B48EAD;">(</span>org-agenda-skip-function `<span style="color: #A3BE8C;">(</span>org-agenda-skip-entry-if 'deadline
                                                                           'schedule
                                                                           'timestamp
                                                                           'regexp ,<span style="color: #5D80AE;">(</span>format <span style="color: #A3BE8C;">"\\[#%s\\]"</span> <span style="color: #81A1C1;">(</span>char-to-string org-priority-highest<span style="color: #81A1C1;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
                      <span style="color: #B48EAD;">(</span>org-agenda-prefix-format <span style="color: #A3BE8C;">" %i"</span><span style="color: #B48EAD;">)</span>
                      <span style="color: #B48EAD;">(</span>org-agenda-hide-tags-regexp <span style="color: #A3BE8C;">"project"</span><span style="color: #B48EAD;">)</span>
                      <span style="color: #B48EAD;">(</span>org-agenda-block-separator nil<span style="color: #B48EAD;">)</span>
                      <span style="color: #B48EAD;">(</span>org-agenda-overriding-header <span style="color: #A3BE8C;">"Todo tasks list"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
          <span style="color: #8FBCBB;">(</span>tags-todo <span style="color: #A3BE8C;">"Emacs|Computer"</span>
                     <span style="color: #81A1C1;">(</span><span style="color: #B48EAD;">(</span>org-agenda-block-separator nil<span style="color: #B48EAD;">)</span>
                      <span style="color: #B48EAD;">(</span>org-agenda-skip-function '<span style="color: #A3BE8C;">(</span>org-agenda-skip-if nil '<span style="color: #5D80AE;">(</span>timestamp<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
                      <span style="color: #B48EAD;">(</span>org-agenda-prefix-format <span style="color: #A3BE8C;">" %i"</span><span style="color: #B48EAD;">)</span>
                      <span style="color: #B48EAD;">(</span>org-agenda-hide-tags-regexp <span style="color: #A3BE8C;">"project"</span><span style="color: #B48EAD;">)</span>
                      <span style="color: #B48EAD;">(</span>org-agenda-overriding-header <span style="color: #A3BE8C;">"Computer science"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
          <span style="color: #8FBCBB;">(</span>tags-todo <span style="color: #A3BE8C;">"Family"</span>
                <span style="color: #81A1C1;">(</span><span style="color: #B48EAD;">(</span>org-agenda-skip-function '<span style="color: #A3BE8C;">(</span>org-agenda-skip-if nil '<span style="color: #5D80AE;">(</span>timestamp<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
                 <span style="color: #B48EAD;">(</span>org-agenda-prefix-format <span style="color: #A3BE8C;">" %i"</span><span style="color: #B48EAD;">)</span>
                 <span style="color: #B48EAD;">(</span>org-agenda-hide-tags-regexp <span style="color: #A3BE8C;">"project"</span><span style="color: #B48EAD;">)</span>
                 <span style="color: #B48EAD;">(</span>org-agenda-block-separator nil<span style="color: #B48EAD;">)</span>
                 <span style="color: #B48EAD;">(</span>org-agenda-overriding-header <span style="color: #A3BE8C;">"Family"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span>
          <span style="color: #8FBCBB;">(</span>todo <span style="color: #A3BE8C;">"WAIT|SOMEDAY"</span>
                <span style="color: #81A1C1;">(</span><span style="color: #B48EAD;">(</span>org-agenda-block-separator nil<span style="color: #B48EAD;">)</span>
                 <span style="color: #B48EAD;">(</span>org-agenda-prefix-format <span style="color: #A3BE8C;">" %i"</span><span style="color: #B48EAD;">)</span>
                 <span style="color: #B48EAD;">(</span>org-agenda-hide-tags-regexp <span style="color: #A3BE8C;">"project"</span><span style="color: #B48EAD;">)</span>
                 <span style="color: #B48EAD;">(</span>org-agenda-overriding-header <span style="color: #A3BE8C;">"Tasks on hold"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span><span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org54e30d3" class="outline-3">
<h3 id="org54e30d3"><span class="section-number-3">11.12.</span> Blog</h3>
<div class="outline-text-3" id="text-11-12">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'ox
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">require</span> '<span style="color: #81A1C1;">ox-hugo</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org4b25685" class="outline-3">
<h3 id="org4b25685"><span class="section-number-3">11.13.</span> Latex</h3>
<div class="outline-text-3" id="text-11-13">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-to-list 'auto-mode-alist '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"\\.tex\\'"</span> . LaTeX-mode<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> TeX-auto-save t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> TeX-parse-self t<span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> TeX-save-query nil<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> TeX-electric-sub-and-superscript t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> TeX-auto-local <span style="color: #A3BE8C;">".auctex-auto"</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> TeX-style-local <span style="color: #A3BE8C;">".auctex-style"</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> TeX-source-correlate-mode t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> TeX-source-correlate-method 'synctex<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> TeX-source-correlate-start-server nil<span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq-default</span> TeX-master nil<span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> LaTeX-section-hook '<span style="color: #B48EAD;">(</span>LaTeX-section-heading
                           LaTeX-section-title
                           LaTeX-section-toc
                           LaTeX-section-section
                           LaTeX-section-label<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> LaTeX-fill-break-at-separators nil<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> LaTeX-item-indent 0<span style="color: #81A1C1;">)</span>
</pre>
</div>
<p>
为了在 <code>org-mode</code> 中快速的输入数学符号，开启 <code>org-cdlatex-mode</code> 。该包是 <code>org-mode</code> 自带的的。进一步的是什用 <code>cdlatex</code> 这个包，会自动成对的输入符号。进一步的是考虑使用 <code>tempel</code> 等这类包，自动展开 <code>snippet</code> 。
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-highlight-latex-and-related '<span style="color: #B48EAD;">(</span>latex script<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'ox-latex
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">setq</span> org-latex-classes nil
        org-latex-listings 'minted
        org-export-latex-listings 'minted
        org-latex-minted-options '<span style="color: #A3BE8C;">(</span><span style="color: #5D80AE;">(</span><span style="color: #A3BE8C;">"breaklines"</span> <span style="color: #A3BE8C;">"true"</span><span style="color: #5D80AE;">)</span>
                                   <span style="color: #5D80AE;">(</span><span style="color: #A3BE8C;">"breakanywhere"</span> <span style="color: #A3BE8C;">"true"</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>add-to-list 'org-latex-classes
               '<span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"book"</span>
                 <span style="color: #A3BE8C;">"\\documentclass[UTF8,twoside,a4paper,12pt,openright]{ctexrep}</span>
<span style="color: #A3BE8C;">        [NO-DEFAULT-PACKAGES]</span>
<span style="color: #A3BE8C;">        [NO-PACKAGES]</span>
<span style="color: #A3BE8C;">        [EXTRA]"</span>
                 <span style="color: #5D80AE;">(</span><span style="color: #A3BE8C;">"\\chapter{%s}"</span> . <span style="color: #A3BE8C;">"\\chapter*{%s}"</span><span style="color: #5D80AE;">)</span>
                 <span style="color: #5D80AE;">(</span><span style="color: #A3BE8C;">"\\section{%s}"</span> . <span style="color: #A3BE8C;">"\\section*{%s}"</span><span style="color: #5D80AE;">)</span>
                 <span style="color: #5D80AE;">(</span><span style="color: #A3BE8C;">"\\subsection{%s}"</span> . <span style="color: #A3BE8C;">"\\subsection*{%s}"</span><span style="color: #5D80AE;">)</span>
                 <span style="color: #5D80AE;">(</span><span style="color: #A3BE8C;">"\\subsubsection{%s}"</span> . <span style="color: #A3BE8C;">"\\subsubsection*{%s}"</span><span style="color: #5D80AE;">)</span>
                 <span style="color: #5D80AE;">(</span><span style="color: #A3BE8C;">"\\paragraph{%s}"</span> . <span style="color: #A3BE8C;">"\\paragraph*{%s}"</span><span style="color: #5D80AE;">)</span>
                 <span style="color: #5D80AE;">(</span><span style="color: #A3BE8C;">"\\subparagraph{%s}"</span> . <span style="color: #A3BE8C;">"\\subparagraph*{%s}"</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>add-to-list 'org-latex-classes '<span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"article-cn"</span> <span style="color: #A3BE8C;">"\\documentclass{ctexart}</span>
<span style="color: #A3BE8C;">        [NO-DEFAULT-PACKAGES]</span>
<span style="color: #A3BE8C;">        [NO-PACKAGES]</span>
<span style="color: #A3BE8C;">        [EXTRA]"</span>
                                    <span style="color: #5D80AE;">(</span><span style="color: #A3BE8C;">"\\section{%s}"</span> . <span style="color: #A3BE8C;">"\\section*{%s}"</span><span style="color: #5D80AE;">)</span>
                                    <span style="color: #5D80AE;">(</span><span style="color: #A3BE8C;">"\\subsection{%s}"</span> . <span style="color: #A3BE8C;">"\\subsection*{%s}"</span><span style="color: #5D80AE;">)</span>
                                    <span style="color: #5D80AE;">(</span><span style="color: #A3BE8C;">"\\subsubsection{%s}"</span> . <span style="color: #A3BE8C;">"\\subsubsection*{%s}"</span><span style="color: #5D80AE;">)</span>
                                    <span style="color: #5D80AE;">(</span><span style="color: #A3BE8C;">"\\paragraph{%s}"</span> . <span style="color: #A3BE8C;">"\\paragraph*{%s}"</span><span style="color: #5D80AE;">)</span>
                                    <span style="color: #5D80AE;">(</span><span style="color: #A3BE8C;">"\\subparagraph{%s}"</span> . <span style="color: #A3BE8C;">"\\subparagraph*{%s}"</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>add-to-list 'org-latex-classes '<span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"article"</span> <span style="color: #A3BE8C;">"\\documentclass[11pt]{article}</span>
<span style="color: #A3BE8C;">                    [NO-DEFAULT-PACKAGES]</span>
<span style="color: #A3BE8C;">                    [NO-PACKAGES]</span>
<span style="color: #A3BE8C;">                    [EXTRA]"</span>
                                    <span style="color: #5D80AE;">(</span><span style="color: #A3BE8C;">"\\section{%s}"</span> . <span style="color: #A3BE8C;">"\\section*{%s}"</span><span style="color: #5D80AE;">)</span>
                                    <span style="color: #5D80AE;">(</span><span style="color: #A3BE8C;">"\\subsection{%s}"</span> . <span style="color: #A3BE8C;">"\\subsection*{%s}"</span><span style="color: #5D80AE;">)</span>
                                    <span style="color: #5D80AE;">(</span><span style="color: #A3BE8C;">"\\subsubsection{%s}"</span> . <span style="color: #A3BE8C;">"\\subsubsection*{%s}"</span><span style="color: #5D80AE;">)</span>
                                    <span style="color: #5D80AE;">(</span><span style="color: #A3BE8C;">"\\paragraph{%s}"</span> . <span style="color: #A3BE8C;">"\\paragraph*{%s}"</span><span style="color: #5D80AE;">)</span>
                                    <span style="color: #5D80AE;">(</span><span style="color: #A3BE8C;">"\\subparagraph{%s}"</span> . <span style="color: #A3BE8C;">"\\subparagraph*{%s}"</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>add-to-list 'org-latex-classes '<span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"beamer"</span> <span style="color: #A3BE8C;">"\\documentclass[presentation]{beamer}</span>
<span style="color: #A3BE8C;">                                    [DEFAULT-PACKAGES]</span>
<span style="color: #A3BE8C;">                                    [PACKAGES]</span>
<span style="color: #A3BE8C;">                                    [EXTRA]"</span>
                                    <span style="color: #5D80AE;">(</span><span style="color: #A3BE8C;">"\\section{%s}"</span> . <span style="color: #A3BE8C;">"\\section*{%s}"</span><span style="color: #5D80AE;">)</span>
                                    <span style="color: #5D80AE;">(</span><span style="color: #A3BE8C;">"\\subsection{%s}"</span> . <span style="color: #A3BE8C;">"\\subsection*{%s}"</span><span style="color: #5D80AE;">)</span>
                                    <span style="color: #5D80AE;">(</span><span style="color: #A3BE8C;">"\\subsubsection{%s}"</span> . <span style="color: #A3BE8C;">"\\subsubsection*{%s}"</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> org-latex-pdf-process '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"xelatex -8bit --shell-escape  -interaction=nonstopmode -output-directory %o %f"</span>
                              <span style="color: #A3BE8C;">"bibtex -shell-escape %b"</span>
                              <span style="color: #A3BE8C;">"xelatex -8bit --shell-escape  -interaction=nonstopmode -output-directory %o %f"</span>
                              <span style="color: #A3BE8C;">"xelatex -8bit --shell-escape  -interaction=nonstopmode -output-directory %o %f"</span>
                              <span style="color: #A3BE8C;">"rm -fr %b.out %b.log %b.tex %b.brf %b.bbl"</span><span style="color: #B48EAD;">)</span>
      org-latex-logfiles-extensions '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"lof"</span> <span style="color: #A3BE8C;">"lot"</span> <span style="color: #A3BE8C;">"tex~"</span> <span style="color: #A3BE8C;">"aux"</span> <span style="color: #A3BE8C;">"idx"</span> <span style="color: #A3BE8C;">"log"</span> <span style="color: #A3BE8C;">"out"</span> <span style="color: #A3BE8C;">"toc"</span> <span style="color: #A3BE8C;">"nav"</span> <span style="color: #A3BE8C;">"snm"</span> <span style="color: #A3BE8C;">"vrb"</span> <span style="color: #A3BE8C;">"dvi"</span> <span style="color: #A3BE8C;">"fdb_latexmk"</span> <span style="color: #A3BE8C;">"blg"</span> <span style="color: #A3BE8C;">"brf"</span> <span style="color: #A3BE8C;">"fls"</span> <span style="color: #A3BE8C;">"entoc"</span> <span style="color: #A3BE8C;">"ps"</span> <span style="color: #A3BE8C;">"spl"</span> <span style="color: #A3BE8C;">"bbl"</span><span style="color: #B48EAD;">)</span>
      org-latex-prefer-user-labels t<span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
<div id="outline-container-org0cee246" class="outline-4">
<h4 id="org0cee246"><span class="section-number-4">11.13.1.</span> ox-beamer</h4>
<div class="outline-text-4" id="text-11-13-1">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'org-mode-hook #'<span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">lambda</span> <span style="color: #A3BE8C;">()</span>
                             <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">require</span> '<span style="color: #81A1C1;">ox-beamer</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org33a0fac" class="outline-4">
<h4 id="org33a0fac"><span class="section-number-4">11.13.2.</span> reftex</h4>
<div class="outline-text-4" id="text-11-13-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'LaTeX-mode-hook 'turn-on-reftex<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'latex-mode-hook 'turn-on-reftex<span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> reftex-toc-split-windows-horizontally t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> reftex-toc-split-windows-fraction 0.25<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'reftex-toc-mode-hook 'menu-bar--visual-line-mode-enable<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'reftex-toc-mode-hook #'<span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">lambda</span> <span style="color: #A3BE8C;">()</span> <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">setq-local</span> mode-line-format nil<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org19664e5" class="outline-4">
<h4 id="org19664e5"><span class="section-number-4">11.13.3.</span> cdlatex</h4>
<div class="outline-text-4" id="text-11-13-3">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>add-hook 'LaTeX-mode-hook 'turn-on-cdlatex<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'latex-mode-hook 'turn-on-cdlatex<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'org-mode-hook 'turn-on-org-cdlatex<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'org
  <span style="color: #B48EAD;">(</span>diminish 'org-cdlatex-mode<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgd5f5289" class="outline-3">
<h3 id="orgd5f5289"><span class="section-number-3">11.14.</span> Mail</h3>
<div class="outline-text-3" id="text-11-14">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> display-time-mail-icon `<span style="color: #B48EAD;">(</span>,<span style="color: #A3BE8C;">(</span>propertize <span style="color: #5D80AE;">(</span>all-the-icons-material <span style="color: #A3BE8C;">"mail"</span><span style="color: #5D80AE;">)</span>
                                            'face `<span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">:family</span> ,<span style="color: #8FBCBB;">(</span>all-the-icons-material-family<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> message-sendmail-envelope-from 'header<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> message-kill-buffer-query nil<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> message-sendmail-extra-arguments '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"-a"</span> <span style="color: #A3BE8C;">"outlook"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> message-send-mail-function 'sendmail-send-it<span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> send-mail-function 'sendmail-send-it<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> sendmail-program <span style="color: #B48EAD;">(</span>executable-find <span style="color: #A3BE8C;">"msmtp"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mail-specify-envelope-from t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mail-envelope-from 'header<span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mail-user-agent 'mu4e-user-agent<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">unless</span> <span style="color: #B48EAD;">(</span>fboundp 'mu4e<span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>autoload #'mu4e <span style="color: #A3BE8C;">"mu4e"</span> nil t<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-mu-binary <span style="color: #B48EAD;">(</span>executable-find <span style="color: #A3BE8C;">"mu"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-update-interval <span style="color: #B48EAD;">(</span>* 15 60<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-attachment-dir <span style="color: #A3BE8C;">"~/Downloads/"</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-get-mail-command <span style="color: #B48EAD;">(</span>concat <span style="color: #A3BE8C;">(</span>executable-find <span style="color: #A3BE8C;">"mbsync"</span><span style="color: #A3BE8C;">)</span> <span style="color: #A3BE8C;">" -a"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-index-update-in-background t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-index-update-error-warning t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-index-update-error-warning nil<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-index-cleanup t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-view-show-images t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-view-image-max-width 800<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-view-show-addresses t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-confirm-quit nil<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-context-policy 'pick-first<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'mu4e
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">setq</span> mu4e-sent-folder   <span style="color: #A3BE8C;">"/outlook/Sent"</span>
        mu4e-drafts-folder <span style="color: #A3BE8C;">"/outlook/Drafts"</span>
        mu4e-trash-folder  <span style="color: #A3BE8C;">"/outlook/Deleted"</span>
        mu4e-refile-folder  <span style="color: #A3BE8C;">"/outlook/Archive"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-view-prefer-html nil<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-html2text-command 'mu4e-shr2text<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-main-hide-personal-addresses t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-headers-precise-alignment t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-headers-include-related t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-headers-auto-update t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-headers-date-format <span style="color: #A3BE8C;">"%d/%m/%y"</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-headers-time-format <span style="color: #A3BE8C;">"%H:%M"</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-headers-fields '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">:flags</span> . 12<span style="color: #A3BE8C;">)</span>
                            <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">:human-date</span> . 9<span style="color: #A3BE8C;">)</span>
                            <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">:subject</span> . 90<span style="color: #A3BE8C;">)</span>
                            <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">:from-or-to</span> . 40<span style="color: #A3BE8C;">)</span>
                            <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">:tags</span> . 20<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-use-fancy-chars nil<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-bookmarks '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"flag:unread AND NOT flag:trashed"</span> <span style="color: #A3BE8C;">"Unread messages"</span> ?u<span style="color: #A3BE8C;">)</span>
                       <span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"date:today..now"</span> <span style="color: #A3BE8C;">"Today's messages"</span> ?t<span style="color: #A3BE8C;">)</span>
                       <span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"date:7d..now"</span> <span style="color: #A3BE8C;">"Last 7 days"</span> ?w<span style="color: #A3BE8C;">)</span>
                       <span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"date:1d..now AND NOT list:emacs-orgmode.gnu.org"</span> <span style="color: #A3BE8C;">"Last 1 days"</span> ?o<span style="color: #A3BE8C;">)</span>
                       <span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"date:1d..now AND list:emacs-orgmode.gnu.org"</span> <span style="color: #A3BE8C;">"Last 1 days (org mode)"</span> ?m<span style="color: #A3BE8C;">)</span>
                       <span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"maildir:/drafts"</span> <span style="color: #A3BE8C;">"drafts"</span> ?d<span style="color: #A3BE8C;">)</span>
                       <span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"flag:flagged AND NOT flag:trashed"</span> <span style="color: #A3BE8C;">"flagged"</span> ?f<span style="color: #A3BE8C;">)</span>
                       <span style="color: #A3BE8C;">(</span><span style="color: #A3BE8C;">"mime:image/*"</span> <span style="color: #A3BE8C;">"Messages with images"</span> ?p<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-compose-reply-ignore-address '<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"no-?reply"</span> <span style="color: #A3BE8C;">"duan_n@outlook.com"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-compose-format-flowed nil<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-compose-signature-auto-include nil<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-compose-dont-reply-to-self t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>run-with-idle-timer 10 nil #'<span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">lambda</span> <span style="color: #A3BE8C;">()</span> <span style="color: #A3BE8C;">(</span>mu4e 'background<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span>add-hook 'mu4e-index-updated-hook 'mu4e-alert-enable-notifications<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'mu4e
  <span style="color: #B48EAD;">(</span>mu4e-alert-enable-mode-line-display<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">with-eval-after-load</span> 'mu4e
  <span style="color: #B48EAD;">(</span>mu4e-column-faces-mode<span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c M"</span><span style="color: #B48EAD;">)</span> 'mu4e<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
  <span style="color: #A3BE8C;">"M"</span> '<span style="color: #B48EAD;">(</span>mu4e <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Mail"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
<div id="outline-container-orga3f66ff" class="outline-4">
<h4 id="orga3f66ff"><span class="section-number-4">11.14.1.</span> Mu4e headers icon</h4>
<div class="outline-text-4" id="text-11-14-1">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-use-fancy-chars t<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-headers-list-mark `<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"s"</span> . ,<span style="color: #A3BE8C;">(</span>propertize
                                       <span style="color: #5D80AE;">(</span>all-the-icons-material <span style="color: #A3BE8C;">"list"</span><span style="color: #5D80AE;">)</span>
                                       'face `<span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">:family</span> ,<span style="color: #8FBCBB;">(</span>all-the-icons-material-family<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-headers-seen-mark `<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"S"</span> . ,<span style="color: #A3BE8C;">(</span>propertize
                                       <span style="color: #5D80AE;">(</span>all-the-icons-material <span style="color: #A3BE8C;">"mail_outline"</span><span style="color: #5D80AE;">)</span>
                                       'face `<span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">:family</span> ,<span style="color: #8FBCBB;">(</span>all-the-icons-material-family<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-headers-new-mark `<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"N"</span> . ,<span style="color: #A3BE8C;">(</span>propertize
                                      <span style="color: #5D80AE;">(</span>all-the-icons-material <span style="color: #A3BE8C;">"markunread"</span><span style="color: #5D80AE;">)</span>
                                      'face `<span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">:family</span> ,<span style="color: #8FBCBB;">(</span>all-the-icons-material-family<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-headers-unread-mark `<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"u"</span> . ,<span style="color: #A3BE8C;">(</span>propertize
                                         <span style="color: #5D80AE;">(</span>all-the-icons-material <span style="color: #A3BE8C;">"notifications_none"</span><span style="color: #5D80AE;">)</span>
                                         'face `<span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">:family</span> ,<span style="color: #8FBCBB;">(</span>all-the-icons-material-family<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-headers-signed-mark `<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"s"</span> . ,<span style="color: #A3BE8C;">(</span>propertize
                                         <span style="color: #5D80AE;">(</span>all-the-icons-material <span style="color: #A3BE8C;">"check"</span><span style="color: #5D80AE;">)</span>
                                         'face `<span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">:family</span> ,<span style="color: #8FBCBB;">(</span>all-the-icons-material-family<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-headers-encrypted-mark `<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"x"</span> . ,<span style="color: #A3BE8C;">(</span>propertize
                                            <span style="color: #5D80AE;">(</span>all-the-icons-material <span style="color: #A3BE8C;">"enhanced_encryption"</span><span style="color: #5D80AE;">)</span>
                                            'face `<span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">:family</span> ,<span style="color: #8FBCBB;">(</span>all-the-icons-material-family<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-headers-draft-mark `<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"D"</span> . ,<span style="color: #A3BE8C;">(</span>propertize
                                        <span style="color: #5D80AE;">(</span>all-the-icons-material <span style="color: #A3BE8C;">"drafts"</span><span style="color: #5D80AE;">)</span>
                                        'face `<span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">:family</span> ,<span style="color: #8FBCBB;">(</span>all-the-icons-material-family<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-headers-attach-mark `<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"a"</span> . ,<span style="color: #A3BE8C;">(</span>propertize
                                         <span style="color: #5D80AE;">(</span>all-the-icons-material <span style="color: #A3BE8C;">"attachment"</span><span style="color: #5D80AE;">)</span>
                                         'face `<span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">:family</span> ,<span style="color: #8FBCBB;">(</span>all-the-icons-material-family<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-headers-passed-mark `<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"P"</span> . ,<span style="color: #A3BE8C;">(</span>propertize <span style="color: #6f7787;">; </span><span style="color: #6f7787;">&#10095; (I'm participated in thread)</span>
                                         <span style="color: #5D80AE;">(</span>all-the-icons-material <span style="color: #A3BE8C;">"center_focus_weak"</span><span style="color: #5D80AE;">)</span>
                                         'face `<span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">:family</span> ,<span style="color: #8FBCBB;">(</span>all-the-icons-material-family<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-headers-flagged-mark `<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"F"</span> . ,<span style="color: #A3BE8C;">(</span>propertize
                                          <span style="color: #5D80AE;">(</span>all-the-icons-material <span style="color: #A3BE8C;">"flag"</span><span style="color: #5D80AE;">)</span>
                                         'face `<span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">:family</span> ,<span style="color: #8FBCBB;">(</span>all-the-icons-material-family<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-headers-replied-mark `<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"R"</span> . ,<span style="color: #A3BE8C;">(</span>propertize
                                          <span style="color: #5D80AE;">(</span>all-the-icons-material <span style="color: #A3BE8C;">"reply_all"</span><span style="color: #5D80AE;">)</span>
                                         'face `<span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">:family</span> ,<span style="color: #8FBCBB;">(</span>all-the-icons-material-family<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-headers-trashed-mark `<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"T"</span> . ,<span style="color: #A3BE8C;">(</span>propertize
                                          <span style="color: #5D80AE;">(</span>all-the-icons-material <span style="color: #A3BE8C;">"cancel"</span><span style="color: #5D80AE;">)</span>
                                          'face `<span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">:family</span> ,<span style="color: #8FBCBB;">(</span>all-the-icons-material-family<span style="color: #8FBCBB;">)</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> mu4e-headers-personal-mark `<span style="color: #B48EAD;">(</span><span style="color: #A3BE8C;">"p"</span> . ,<span style="color: #A3BE8C;">(</span>propertize
                                           <span style="color: #5D80AE;">(</span>all-the-icons-material <span style="color: #A3BE8C;">"person"</span><span style="color: #5D80AE;">)</span>
                                           'face `<span style="color: #5D80AE;">(</span><span style="color: #81A1C1;">:family</span> ,<span style="color: #8FBCBB;">(</span>all-the-icons-material-family<span style="color: #8FBCBB;">)</span>
                                                           <span style="color: #81A1C1;">:foreground</span> 'mu4e-special-header-value-face<span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-org7fc0fb6" class="outline-4">
<h4 id="org7fc0fb6"><span class="section-number-4">11.14.2.</span> Who am I</h4>
<div class="outline-text-4" id="text-11-14-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> user-full-name <span style="color: #A3BE8C;">"Duan Ning"</span><span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">setq</span> user-mail-address <span style="color: #A3BE8C;">"duan_n@outlook.com"</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org7b4daeb" class="outline-3">
<h3 id="org7b4daeb"><span class="section-number-3">11.15.</span> Proxy</h3>
<div class="outline-text-3" id="text-11-15">
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">toggle-proxy</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #78808f;">"Toggle proxy for the url.el library."</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">if</span> url-proxy-services
      <span style="color: #A3BE8C;">(</span>proxy-disable<span style="color: #A3BE8C;">)</span>
    <span style="color: #A3BE8C;">(</span>proxy-enable<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">proxy-enable</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">setq</span> url-proxy-services
          '<span style="color: #A3BE8C;">(</span><span style="color: #5D80AE;">(</span><span style="color: #A3BE8C;">"http"</span> . <span style="color: #A3BE8C;">"127.0.0.1:7890"</span><span style="color: #5D80AE;">)</span>
            <span style="color: #5D80AE;">(</span><span style="color: #A3BE8C;">"https"</span> . <span style="color: #A3BE8C;">"127.0.0.1:7890"</span><span style="color: #5D80AE;">)</span>
            <span style="color: #5D80AE;">(</span><span style="color: #A3BE8C;">"no_proxy"</span> . <span style="color: #A3BE8C;">"0.0.0.0"</span><span style="color: #5D80AE;">)</span><span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>message <span style="color: #A3BE8C;">"Proxy enabled! %s"</span> <span style="color: #A3BE8C;">(</span>car url-proxy-services<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">defun</span> <span style="color: #88C0D0;">proxy-disable</span> <span style="color: #B48EAD;">()</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">interactive</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">if</span> url-proxy-services
      <span style="color: #A3BE8C;">(</span><span style="color: #81A1C1;">setq</span> url-proxy-services nil<span style="color: #A3BE8C;">)</span><span style="color: #B48EAD;">)</span>
  <span style="color: #B48EAD;">(</span>message <span style="color: #A3BE8C;">"Proxy disabled!"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>

<span style="color: #81A1C1;">(</span>add-hook 'after-init-hook #'proxy-enable<span style="color: #81A1C1;">)</span>
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #81A1C1;">(</span>global-set-key <span style="color: #B48EAD;">(</span>kbd <span style="color: #A3BE8C;">"C-c t p"</span><span style="color: #B48EAD;">)</span> 'toggle-proxy<span style="color: #81A1C1;">)</span>
<span style="color: #81A1C1;">(</span><span style="color: #81A1C1;">my/space-leader-keys</span>
  <span style="color: #A3BE8C;">"t"</span> '<span style="color: #B48EAD;">(</span><span style="color: #81A1C1;">:ignore</span> t <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Toggle"</span><span style="color: #B48EAD;">)</span>
  <span style="color: #A3BE8C;">"tp"</span> '<span style="color: #B48EAD;">(</span>toggle-proxy <span style="color: #81A1C1;">:wk</span> <span style="color: #A3BE8C;">"Proxy"</span><span style="color: #B48EAD;">)</span><span style="color: #81A1C1;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org3a05a1c" class="outline-2">
<h2 id="org3a05a1c"><span class="section-number-2">12.</span> EMACS UPDATE AND UPGRADE HISTORY</h2>
<div class="outline-text-2" id="text-12">
</div>
<div id="outline-container-orgd8f9783" class="outline-3">
<h3 id="orgd8f9783"><span class="section-number-3">12.1.</span> 2022-10-06</h3>
<div class="outline-text-3" id="text-12-1">
<p>
常规升级。
GNU Emacs 29.0.50 (build 1, aarch64-apple-darwin21.5.0, NS appkit-2113.50 Version 12.4 (Build 21F79)) of 2022-08-24。
以上的版本当 emacs 初启动的时候， tab-bar 会出现跨行的问题，打开新的 buffer 就会恢复正常。
</p>

<p>
更新后，也没有改变，是配置的问题吗？
</p>
</div>
</div>
<div id="outline-container-org4d44bb3" class="outline-3">
<h3 id="org4d44bb3"><span class="section-number-3">12.2.</span> 2022-10-12</h3>
<div class="outline-text-3" id="text-12-2">
<p>
受不了 mode-line tab-bar pdf-tools 的问题，还是把 emacs 从 28.2 升级到了 29.0.50。
</p>
</div>
</div>
<div id="outline-container-orga8666ac" class="outline-3">
<h3 id="orga8666ac"><span class="section-number-3">12.3.</span> 2022-10-16</h3>
<div class="outline-text-3" id="text-12-3">
<p>
重新回到 emacs 28.2 ，去除了 tab-bar ，替代使用 doom-modeline ，只要不排斥 modeline 结果还不错。So, 为什么一定要使用 tab-bar-mode 呢？！
</p>


<div id="orgdaab5e5" class="figure">
<p><img src="img/20221017210912Emacs interface.png" alt="20221017210912Emacs interface.png" width="600px" />
</p>
<p><span class="figure-number">Figure 1: </span>I like it!</p>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<hr><div class="generated">Created with <a href="https://www.gnu.org/software/emacs/">Emacs</a> 28.2 (<a href="https://orgmode.org">Org</a> mode 9.5.5) on MacOS</div>
</div>
</body>
</html>
